<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Modelo logístico | Notas de clase: Modelo lineal general II</title>
  <meta name="description" content="Capítulo 7 Modelo logístico | Notas de clase: Modelo lineal general II" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Modelo logístico | Notas de clase: Modelo lineal general II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Modelo logístico | Notas de clase: Modelo lineal general II" />
  
  
  

<meta name="author" content="Alvaro J. Flórez" />


<meta name="date" content="2023-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-lineal-generalizado.html"/>
<link rel="next" href="modelo-para-conteos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notas de clase MLGII</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html"><i class="fa fa-check"></i><b>1</b> Variables indicadoras (o dummies)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#ejemplos"><i class="fa fa-check"></i><b>1.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.1.1</b> Datos de atletas australianos</a></li>
<li class="chapter" data-level="1.1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-la-onu"><i class="fa fa-check"></i><b>1.1.2</b> Datos de la ONU</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#variables-indicadoras"><i class="fa fa-check"></i><b>1.2</b> Variables indicadoras</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelos-con-covariables-categóricas"><i class="fa fa-check"></i><b>1.2.1</b> Modelos con covariables categóricas</a></li>
<li class="chapter" data-level="1.2.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.2.2</b> Modelo para los datos de atletas australianos</a></li>
<li class="chapter" data-level="1.2.3" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-la-onu"><i class="fa fa-check"></i><b>1.2.3</b> Modelo para los datos de la ONU</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html"><i class="fa fa-check"></i><b>2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplos-1"><i class="fa fa-check"></i><b>2.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles"><i class="fa fa-check"></i><b>2.1.1</b> Pasteles</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston"><i class="fa fa-check"></i><b>2.1.2</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#modelos-polinomiales-1"><i class="fa fa-check"></i><b>2.2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>2.2.1</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles-1"><i class="fa fa-check"></i><b>2.2.2</b> Pasteles</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston-1"><i class="fa fa-check"></i><b>2.2.3</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#regresión-por-segmentos"><i class="fa fa-check"></i><b>2.3</b> Regresión por segmentos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplo"><i class="fa fa-check"></i><b>2.3.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multicolinealidad.html"><a href="multicolinealidad.html"><i class="fa fa-check"></i><b>3</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#ejemplos-2"><i class="fa fa-check"></i><b>3.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#cemento"><i class="fa fa-check"></i><b>3.1.1</b> Cemento</a></li>
<li class="chapter" data-level="3.1.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#grasa-corporal"><i class="fa fa-check"></i><b>3.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#multicolinealidad-1"><i class="fa fa-check"></i><b>3.2</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#causas-de-la-multicolinealidad"><i class="fa fa-check"></i><b>3.2.1</b> Causas de la multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#detección-de-multicolinealidad"><i class="fa fa-check"></i><b>3.3</b> Detección de multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#factores-de-inflación-de-varianza"><i class="fa fa-check"></i><b>3.3.1</b> Factores de inflación de varianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-propios-de-boldsymbol-zboldsymbol-z"><i class="fa fa-check"></i><b>3.3.2</b> Valores propios de <span class="math inline">\(\boldsymbol Z&#39;\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-singulares-de-boldsymbol-z"><i class="fa fa-check"></i><b>3.3.3</b> Valores singulares de <span class="math inline">\(\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#proporciones-de-descomposición-de-varianza"><i class="fa fa-check"></i><b>3.3.4</b> Proporciones de descomposición de varianza</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento"><i class="fa fa-check"></i><b>3.4</b> Datos de cemento</a></li>
<li class="chapter" data-level="3.5" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-grasa-corporal"><i class="fa fa-check"></i><b>3.5</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="3.6" data-path="multicolinealidad.html"><a href="multicolinealidad.html#solución-al-problema-de-multicolinealidad"><i class="fa fa-check"></i><b>3.6</b> Solución al problema de multicolinealidad</a></li>
<li class="chapter" data-level="3.7" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-de-ridge"><i class="fa fa-check"></i><b>3.7</b> Estimador de ridge</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-1"><i class="fa fa-check"></i><b>3.7.1</b> Datos de cemento</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-por-componentes-principales"><i class="fa fa-check"></i><b>3.8</b> Estimador por componentes principales</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-2"><i class="fa fa-check"></i><b>3.8.1</b> Datos de cemento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="selección-de-variables.html"><a href="selección-de-variables.html"><i class="fa fa-check"></i><b>4</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplos-3"><i class="fa fa-check"></i><b>4.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#unidad-quirúrgica"><i class="fa fa-check"></i><b>4.1.1</b> Unidad quirúrgica</a></li>
<li class="chapter" data-level="4.1.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#grasa-corporal-1"><i class="fa fa-check"></i><b>4.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#problema-de-selección-de-variables"><i class="fa fa-check"></i><b>4.2</b> Problema de selección de variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#qué-pasa-si-ignoramos-covariables-importantes"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué pasa si ignoramos covariables importantes?</a></li>
<li class="chapter" data-level="4.2.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#que-pasa-si-incluimos-covariables-irrelevantes"><i class="fa fa-check"></i><b>4.2.2</b> ¿Que pasa si incluimos covariables irrelevantes?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#métodos-para-la-selección-de-variables"><i class="fa fa-check"></i><b>4.3</b> Métodos para la selección de variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>4.3.1</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="4.3.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación-ajustado"><i class="fa fa-check"></i><b>4.3.2</b> Coeficiente de determinación ajustado</a></li>
<li class="chapter" data-level="4.3.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#c_p-de-mallows"><i class="fa fa-check"></i><b>4.3.3</b> C<span class="math inline">\(_p\)</span> de Mallows</a></li>
<li class="chapter" data-level="4.3.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#estadístico-press"><i class="fa fa-check"></i><b>4.3.4</b> Estadístico PRESS</a></li>
<li class="chapter" data-level="4.3.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#criterios-de-información"><i class="fa fa-check"></i><b>4.3.5</b> Criterios de información</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#comparación-de-los-modelos"><i class="fa fa-check"></i><b>4.4</b> Comparación de los modelos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#todos-los-posibles-modelos"><i class="fa fa-check"></i><b>4.4.1</b> Todos los posibles modelos</a></li>
<li class="chapter" data-level="4.4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#algorítmos-de-selección"><i class="fa fa-check"></i><b>4.4.2</b> Algorítmos de selección</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#regresión-de-lasso"><i class="fa fa-check"></i><b>4.5</b> Regresión de LASSO</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#datos-de-grasa-corporal-1"><i class="fa fa-check"></i><b>4.5.1</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="4.5.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#validación-cruzada"><i class="fa fa-check"></i><b>4.5.2</b> Validación cruzada</a></li>
<li class="chapter" data-level="4.5.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplo-grasa-corporal"><i class="fa fa-check"></i><b>4.5.3</b> Ejemplo grasa corporal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html"><i class="fa fa-check"></i><b>5</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#ejemplos-4"><i class="fa fa-check"></i><b>5.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#crecimiento-de-pavos"><i class="fa fa-check"></i><b>5.1.1</b> Crecimiento de pavos</a></li>
<li class="chapter" data-level="5.1.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#puromicina"><i class="fa fa-check"></i><b>5.1.2</b> Puromicina</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-1"><i class="fa fa-check"></i><b>5.2</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-linealizables"><i class="fa fa-check"></i><b>5.2.1</b> Modelos no-lineales linealizables</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#estimación-de-los-parámetros"><i class="fa fa-check"></i><b>5.2.2</b> Estimación de los parámetros</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#inferencia-sobre-los-parámetros"><i class="fa fa-check"></i><b>5.2.3</b> Inferencia sobre los parámetros</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#método-de-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Método de Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#bootstrap-en-regresión"><i class="fa fa-check"></i><b>5.3.1</b> Bootstrap en regresión</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#algunas-consideraciones"><i class="fa fa-check"></i><b>5.3.2</b> Algunas consideraciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html"><i class="fa fa-check"></i><b>6</b> Modelo lineal generalizado</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#casos-de-estudio"><i class="fa fa-check"></i><b>6.2</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#mortalidad-de-escarabajos"><i class="fa fa-check"></i><b>6.2.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="6.2.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ataques-de-epilepsia"><i class="fa fa-check"></i><b>6.2.2</b> ataques de epilepsia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#preambulo"><i class="fa fa-check"></i><b>6.3</b> Preambulo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#familia-exponencial"><i class="fa fa-check"></i><b>6.3.1</b> Familia exponencial</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#relación-media-varianza"><i class="fa fa-check"></i><b>6.3.2</b> Relación media-varianza:</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>6.3.3</b> Estimador de máxima verosimilitud</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#métodos-iterativos-de-maximización"><i class="fa fa-check"></i><b>6.3.4</b> Métodos iterativos de maximización</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado-glm"><i class="fa fa-check"></i><b>6.4</b> Modelo lineal generalizado (GLM)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#componente-aleatorio"><i class="fa fa-check"></i><b>6.4.1</b> Componente aleatorio</a></li>
<li class="chapter" data-level="6.4.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#predictor-lineal"><i class="fa fa-check"></i><b>6.4.2</b> Predictor lineal</a></li>
<li class="chapter" data-level="6.4.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#función-de-enlace"><i class="fa fa-check"></i><b>6.4.3</b> Función de enlace</a></li>
<li class="chapter" data-level="6.4.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ejemplos-de-glm"><i class="fa fa-check"></i><b>6.4.4</b> Ejemplos de GLM</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ajuste-de-un-glm"><i class="fa fa-check"></i><b>6.5</b> Ajuste de un GLM</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#especificación-del-modelo"><i class="fa fa-check"></i><b>6.5.1</b> Especificación del modelo</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-por-máxima-verosimilitud-para-boldsymbol-beta"><i class="fa fa-check"></i><b>6.5.2</b> Estimador por máxima verosimilitud para <span class="math inline">\(\boldsymbol \beta\)</span></a></li>
<li class="chapter" data-level="6.5.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#interpretación-de-parámetros---modelo-logístico"><i class="fa fa-check"></i><b>6.5.3</b> interpretación de parámetros - modelo logístico</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>6.6</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>6.6.1</b> Método de razón de verosimilitud</a></li>
<li class="chapter" data-level="6.6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-wald"><i class="fa fa-check"></i><b>6.6.2</b> Método de Wald</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>6.7</b> intervalos de confianza</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalo-de-confianza-para-la-media"><i class="fa fa-check"></i><b>6.7.1</b> Intervalo de confianza para la media</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#devianza"><i class="fa fa-check"></i><b>6.8</b> Devianza</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#el-estadístico-chi-cuadrado-de-pearson"><i class="fa fa-check"></i><b>6.8.1</b> El estadístico chi-cuadrado de Pearson</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#bondad-de-ajuste"><i class="fa fa-check"></i><b>6.9</b> Bondad de ajuste</a></li>
<li class="chapter" data-level="6.10" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#selección-de-variables-1"><i class="fa fa-check"></i><b>6.10</b> Selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-logístico.html"><a href="modelo-logístico.html"><i class="fa fa-check"></i><b>7</b> Modelo logístico</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#casos-de-estudio-1"><i class="fa fa-check"></i><b>7.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#mortalidad-de-escarabajos-1"><i class="fa fa-check"></i><b>7.1.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="7.1.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#bajo-peso-al-nacer"><i class="fa fa-check"></i><b>7.1.2</b> Bajo peso al nacer</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados-o-datos-no-agrupados"><i class="fa fa-check"></i><b>7.2</b> Datos agrupados o datos no agrupados</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados"><i class="fa fa-check"></i><b>7.2.1</b> Datos agrupados</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-no-agrupados"><i class="fa fa-check"></i><b>7.2.2</b> Datos no agrupados</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#funciones-de-enlace"><i class="fa fa-check"></i><b>7.3</b> Funciones de enlace</a></li>
<li class="chapter" data-level="7.4" data-path="modelo-logístico.html"><a href="modelo-logístico.html#curva-característica-operativa-del-receptorroc"><i class="fa fa-check"></i><b>7.4</b> Curva característica operativa del receptor(ROC)</a></li>
<li class="chapter" data-level="7.5" data-path="modelo-logístico.html"><a href="modelo-logístico.html#sobredispersión"><i class="fa fa-check"></i><b>7.5</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#evalaución-de-sobredispersión"><i class="fa fa-check"></i><b>7.5.1</b> Evalaución de sobredispersión</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modelo-logístico.html"><a href="modelo-logístico.html#distribución-beta-binomial"><i class="fa fa-check"></i><b>7.6</b> Distribución beta-binomial</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#modelo-beta-binomial"><i class="fa fa-check"></i><b>7.6.1</b> Modelo beta-binomial</a></li>
<li class="chapter" data-level="7.6.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología"><i class="fa fa-check"></i><b>7.6.2</b> Estudio de teratología</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html"><i class="fa fa-check"></i><b>8</b> Modelo para conteos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#casos-de-estudio-2"><i class="fa fa-check"></i><b>8.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#ataques-de-epilepsia-1"><i class="fa fa-check"></i><b>8.1.1</b> Ataques de epilepsia</a></li>
<li class="chapter" data-level="8.1.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido"><i class="fa fa-check"></i><b>8.1.2</b> Muertes por enfermedades cardiovasculares en doctores del Reino Unido</a></li>
<li class="chapter" data-level="8.1.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites"><i class="fa fa-check"></i><b>8.1.3</b> Número de cangrejos satélites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-poisson"><i class="fa fa-check"></i><b>8.2</b> Modelo Poisson</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-conteo-con-offset"><i class="fa fa-check"></i><b>8.2.1</b> Modelo de conteo con offset</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#sobredispersión-1"><i class="fa fa-check"></i><b>8.3</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>8.3.1</b> Distribución binomial negativa</a></li>
<li class="chapter" data-level="8.3.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-binomial-negativo-poisson-gamma"><i class="fa fa-check"></i><b>8.3.2</b> Modelo binomial negativo (Poisson-gamma)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#inflación-de-ceros"><i class="fa fa-check"></i><b>8.4</b> Inflación de ceros</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-inflación-de-ceros"><i class="fa fa-check"></i><b>8.4.1</b> Modelo de inflación de ceros</a></li>
<li class="chapter" data-level="8.4.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-hurdle"><i class="fa fa-check"></i><b>8.4.2</b> Modelo Hurdle</a></li>
<li class="chapter" data-level="8.4.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites-1"><i class="fa fa-check"></i><b>8.4.3</b> Número de cangrejos satélites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html"><i class="fa fa-check"></i><b>9</b> Modelo lineal mixto</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#casos-de-estudio-3"><i class="fa fa-check"></i><b>9.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#peso-al-nacer-de-ratas"><i class="fa fa-check"></i><b>9.1.1</b> Peso al nacer de ratas</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#capacidad-respiratoria"><i class="fa fa-check"></i><b>9.1.2</b> Capacidad respiratoria</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#datos-por-cluster-correlacionados"><i class="fa fa-check"></i><b>9.2</b> Datos por cluster (correlacionados)</a></li>
<li class="chapter" data-level="9.3" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#notación"><i class="fa fa-check"></i><b>9.3</b> Notación</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelos-con-intercepto-aleatorios"><i class="fa fa-check"></i><b>9.4</b> Modelos con intercepto aleatorios</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.4.1</b> Modelo con pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-lineal-mixto-1"><i class="fa fa-check"></i><b>9.5</b> Modelo lineal mixto</a></li>
<li class="chapter" data-level="9.6" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-de-los-parámetros-1"><i class="fa fa-check"></i><b>9.6</b> Estimación de los parámetros</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-intercepto-aleatorio"><i class="fa fa-check"></i><b>9.6.1</b> Estimación del modelo con intercepto aleatorio</a></li>
<li class="chapter" data-level="9.6.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.6.2</b> Estimación del modelo con pendiente aleatoria</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de clase: Modelo lineal general II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo-logístico" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Modelo logístico<a href="modelo-logístico.html#modelo-logístico" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="casos-de-estudio-1" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Casos de estudio<a href="modelo-logístico.html#casos-de-estudio-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mortalidad-de-escarabajos-1" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Mortalidad de escarabajos<a href="modelo-logístico.html#mortalidad-de-escarabajos-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a trabajar con los datos del estudio sobre los escarabajos:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="modelo-logístico.html#cb153-1" tabindex="-1"></a>logdose <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.6907</span>, <span class="fl">1.7242</span>, <span class="fl">1.7552</span>, <span class="fl">1.7842</span>, <span class="fl">1.8113</span>, <span class="fl">1.8369</span>, <span class="fl">1.8610</span>, <span class="fl">1.8839</span>)</span>
<span id="cb153-2"><a href="modelo-logístico.html#cb153-2" tabindex="-1"></a>dead <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">28</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">61</span>, <span class="dv">60</span>) </span>
<span id="cb153-3"><a href="modelo-logístico.html#cb153-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">56</span>, <span class="dv">63</span>, <span class="dv">59</span>, <span class="dv">62</span>, <span class="dv">60</span>) </span>
<span id="cb153-4"><a href="modelo-logístico.html#cb153-4" tabindex="-1"></a>Datos.esc<span class="ot">=</span><span class="fu">data.frame</span>(logdose,n,dead)</span></code></pre></div>
</div>
<div id="bajo-peso-al-nacer" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Bajo peso al nacer<a href="modelo-logístico.html#bajo-peso-al-nacer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con los datos de la librería , se quiere indentificar factores de riesgo asociados con el nacimiento de niños con bajo peso (es decir, un peso al nacer menor de <span class="math inline">\(2.5\)</span>kgs). Se tiene información de 189 recién nacidos y sus madres atendidos en una hospital (Baystate Medical Center, Springfield, Mass en 1986). Los posibles factores que pueden afectar el bajo al peso son:</p>
<ul>
<li><p><code>age</code>: edad de la madre (años).</p></li>
<li><p><code>lwt</code>: peso de la madre antes del embarazo (libras).</p></li>
<li><p><code>smoke</code>: estado de tabaquismo durante el embarazo (0 no, 1 si).</p></li>
<li><p><code>ptl</code>: historia de parto prematuro (número de casos).</p></li>
</ul>
<p>La variable de respuesta es <code>low</code> (1 si peso <span class="math inline">\(&lt;\)</span> 2.5 kgs, 0 si peso <span class="math inline">\(\geq\)</span> 2.5 kgs).</p>
<p>Para este caso, se puede ajustar modelo logístico. Sea <span class="math inline">\(y_i=1\)</span> si el <span class="math inline">\(i\)</span>-ésimo bebé nace con bajo peso, <span class="math inline">\(y_i=0\)</span> si lo contrario. Por lo que la densidad de <span class="math inline">\(y_i\)</span> está definida como:
<span class="math display">\[
f(y_i;\pi_i)=\pi_i^{y_i}(1-\pi_i)^{(1-y_i)},
\]</span>
donde <span class="math inline">\(\pi_i\)</span> es la probabilidad de que el <span class="math inline">\(i\)</span>-ésimo bebé nazca con bajo peso. La función de enlace es:
<span class="math display">\[
\log\begin{pmatrix} \frac{\pi_i}{1-\pi_i} \end{pmatrix}=\beta_0+\beta_1\text{age}_i+\beta_2\text{lwt}_i+\beta_3\text{smoke}_i+\beta_4\text{ptl}_i.
\]</span>
Sin embargo, se puede considerar alguna función de enlace diferente, como veremos adelante.
### Estudio de teratología
Los datos de la librería son de un estudio para investigar los efectos de unos régimenes alimenticio en el desarrollo fetal de ratas. En este experimento, 58 ratas hembras con dietas deficientes en hierro se dividieron en cuatro grupos. Tres grupos recibieron inyecciones semanales de suplementos de hierro, a diferentes dosis, para normalizar sus niveles de hierro. Mientras que, el grupo restante no recibieron ningún suplemento (placebo). Luego, las ratas se preñaron, se sacrificaron 3 semanas después, y se contó el número de fetos muertos en cada camada.</p>
<p>En la Figura <a href="modelo-logístico.html#fig:liratFig">7.1</a> se puede observar la relación entre el número de fetos muertos por tratamiento, y también, la relación con los niveles de hemoglobina de las ratas hembras.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="modelo-logístico.html#cb154-1" tabindex="-1"></a><span class="fu">data</span>(lirat,<span class="at">package =</span> <span class="st">&#39;VGAM&#39;</span>)</span>
<span id="cb154-2"><a href="modelo-logístico.html#cb154-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb154-3"><a href="modelo-logístico.html#cb154-3" tabindex="-1"></a><span class="co">#Proporcion de fetos muestos vs tratamiento</span></span>
<span id="cb154-4"><a href="modelo-logístico.html#cb154-4" tabindex="-1"></a><span class="fu">plot</span>(lirat<span class="sc">$</span>grp,lirat<span class="sc">$</span>R<span class="sc">/</span>lirat<span class="sc">$</span>N,<span class="at">xlab=</span><span class="st">&quot;Tratamiento&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Proporción de fetos muertos&quot;</span>)</span>
<span id="cb154-5"><a href="modelo-logístico.html#cb154-5" tabindex="-1"></a><span class="co">#Proporcion de fetos muestos vs Hemoglobina</span></span>
<span id="cb154-6"><a href="modelo-logístico.html#cb154-6" tabindex="-1"></a><span class="fu">plot</span>(lirat<span class="sc">$</span>hb,lirat<span class="sc">$</span>R<span class="sc">/</span>lirat<span class="sc">$</span>N,<span class="at">xlab=</span><span class="st">&quot;Hemoglobina&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Proporción de fetos muertos&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:liratFig"></span>
<img src="MLG2_files/figure-html/liratFig-1.png" alt="Datos teratoligía. Relación entre la proporción de fetos muertos por camada con los tratamientos (izquierda) y los niveles de hemoglobina de la madra (derecha) " width="576" />
<p class="caption">
Figure 7.1: Datos teratoligía. Relación entre la proporción de fetos muertos por camada con los tratamientos (izquierda) y los niveles de hemoglobina de la madra (derecha)
</p>
</div>
<p>Si consideramos:
<span class="math display">\[
y_{ij} = \begin{cases}
1 &amp; \mbox{ si el feto } j \mbox{ de la camada }i\mbox{ está muerto}, \\
0 &amp; \mbox{ si lo contrario}, \\
\end{cases}
\]</span>
la variable número de fetos muertos se puede asociar a una distribución binomial:
<span class="math display">\[
y_i = \sum_{j=1}^{n_i} y_{ij} \sim \mbox{binomial}(n_i, \pi_i),
\]</span>
donde <span class="math inline">\(n_i\)</span> es el tamaño de la camada y <span class="math inline">\(\pi_i\)</span> es la probabilidad de que el feto muera. Dado que <span class="math inline">\(\pi_i\)</span> depende del tratamiento y de los niveles de hemoglobina de la rata hembra, se propone que:
<span class="math display">\[
\log\begin{pmatrix} \frac{\pi_i}{1-\pi_i} \end{pmatrix}=\beta_0+\beta_1\text{grp1}_{i}+\beta_2\text{grp2}_{i}+\beta_3\text{grp3}_{i}+\beta_4\text{hb}_i,
\]</span>
donde: <span class="math inline">\(\text{grp1}_{i}=1\)</span> si la <span class="math inline">\(i\)</span>-ésima hembra pertenece al grupo 1, <span class="math inline">\(\text{grp1}_{i}=0\)</span> si lo contrario; <span class="math inline">\(\text{grp2}_{i}=1\)</span> si la <span class="math inline">\(i\)</span>-ésima hembra pertenece al grupo 2, <span class="math inline">\(\text{grp2}_{i}=0\)</span> si lo contrario; <span class="math inline">\(\text{grp3}_{i}=1\)</span> si la <span class="math inline">\(i\)</span>-ésima hembra pertenece al grupo 3, <span class="math inline">\(\text{grp3}_{i}=0\)</span> si lo contrario; y <code>hb_i</code> es el nivel de hemoglobina de la hembra <span class="math inline">\(i\)</span>.</p>
</div>
</div>
<div id="datos-agrupados-o-datos-no-agrupados" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Datos agrupados o datos no agrupados<a href="modelo-logístico.html#datos-agrupados-o-datos-no-agrupados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los datos binarios tienen dos tipos de formatos:</p>
<p><strong>Datos agrupados:</strong> Hay <span class="math inline">\(n_i\)</span> observaciones que tienen los mismos valores de las covariables <span class="math inline">\(x_i\)</span>. Aquí tenemos que para agrupación, <span class="math inline">\(y_i \sim\)</span>binomial<span class="math inline">\((n_i,\pi_i)\)</span>.</p>
<p><strong>Datos no agrupados:</strong> Hay <span class="math inline">\(n_i=1\)</span> (o muy pocas) observaciones por cada <span class="math inline">\(x_i\)</span>. Es decir que, cada <span class="math inline">\(y_i\)</span> sigue una distribución Bernoulli<span class="math inline">\((\pi_i)\)</span>.</p>
<p>Las propiedades asintóticas de las inferencias para los datos no agrupados aplican cuando <span class="math inline">\(N \to \infty\)</span>. Mientras que para datos agrupados, aplican cuando <span class="math inline">\(\sum_{i=1}^nn_i\to\infty\)</span>.</p>
<div id="datos-agrupados" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Datos agrupados<a href="modelo-logístico.html#datos-agrupados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para datos agrupados, <span class="math inline">\(D\)</span> y <span class="math inline">\(X^2\)</span> sirven para evaluar si el ajuste del modelo es bueno o no. Aquí podemos plantear las siguientes hipótesis: <span class="math inline">\(H_0\)</span> indica que el modelo se ajusta bien a los datos, <span class="math inline">\(H_1\)</span> lo contrario.</p>
<p>Si <span class="math inline">\(H_0\)</span> es cierta (y <span class="math inline">\(\sum_{i=1}^nn_i\to\infty\)</span>), entonces <span class="math inline">\(D\)</span> y <span class="math inline">\(X^2\)</span> siguen una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\((n-p)\)</span> grados de libertad.</p>
</div>
<div id="datos-no-agrupados" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Datos no agrupados<a href="modelo-logístico.html#datos-no-agrupados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las distribuciones límite para <span class="math inline">\(D\)</span> y <span class="math inline">\(X^2\)</span> no aplican para datos no agrupados. Tampoco para datos agrupados con <span class="math inline">\(N\)</span> grande y algunos <span class="math inline">\(n_i\)</span> muy pequeños. Se puede aproximar <span class="math inline">\(D\)</span> y <span class="math inline">\(X^2\)</span> agrupando <span class="math inline">\((\boldsymbol x_i,\hat{\boldsymbol y})\)</span> por particiones del espacio de covariables o por particiones de <span class="math inline">\(\hat{\pi}\)</span>. En estos casos, es preferible evaluar la falta de ajuste comparando el modelo propuesto contra modelos más generales.</p>
</div>
</div>
<div id="funciones-de-enlace" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Funciones de enlace<a href="modelo-logístico.html#funciones-de-enlace" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En los modelos anteriores hemos propuesto funciones de enlace logit: <span class="math inline">\(log\begin{pmatrix} \frac{\pi_i}{1-\pi_i} \end{pmatrix}=\boldsymbol x_i\boldsymbol \beta\)</span>.Lo que implica que:</p>
<p><span class="math display">\[
\pi_i=g^{-1}(\boldsymbol x_i,\boldsymbol \beta)=\frac{\exp(\boldsymbol x_i&#39;\boldsymbol \beta)}{1+\exp(\boldsymbol x_i&#39;\boldsymbol \beta)}=\frac{1}{1+\exp(-\boldsymbol x_i&#39;\boldsymbol \beta)}
\]</span>
Sin embargo, podemos utilizar otras funciones de enlace. Por ejemplo, la función <strong>Probit:</strong>
<span class="math display">\[
\Phi^{-1}(\pi_i)=\boldsymbol x&#39;_i\boldsymbol \beta\quad \pi_i=\Phi(\boldsymbol x&#39;_i\boldsymbol \beta),
\]</span>
donde <span class="math inline">\(\Phi(\cdot)\)</span> es función acumulativa de la distribución normal estándar. La función <strong>Log-log complementaria:</strong>
<span class="math display">\[
\pi_i=1-\exp[-\exp(\boldsymbol x&#39;_i\boldsymbol \beta)] \quad \log[-\log(1-\pi_i)]=\boldsymbol x&#39;_i\boldsymbol \beta.
\]</span>
En la Figura <a href="modelo-logístico.html#fig:linkEsc">7.2</a> podemos observar la estimación de la probabilidad de que el escarabajo muera utilizando diferentes funciones de enlace (logit, probit, log-log complementaria). Graficamente, la función log-log complementaria parece mostrar mejores estimaciones que la probit y la logit.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:linkEsc"></span>
<img src="MLG2_files/figure-html/linkEsc-1.png" alt="Datos de mortalidad de escarabajos. Estimaciones de la probabilidad de que el escarabajo muera en función de la dosis utilizando diferentes funciones de enlace: logit(negro), probit(rojo) y cloglog(verde)." width="576" />
<p class="caption">
Figure 7.2: Datos de mortalidad de escarabajos. Estimaciones de la probabilidad de que el escarabajo muera en función de la dosis utilizando diferentes funciones de enlace: logit(negro), probit(rojo) y cloglog(verde).
</p>
</div>
<p>Este resultado se puede comprobar utilizando criterios de información:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="modelo-logístico.html#cb155-1" tabindex="-1"></a><span class="fu">AIC</span>(modEsc.logit)</span></code></pre></div>
<pre><code>## [1] 41.43027</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="modelo-logístico.html#cb157-1" tabindex="-1"></a><span class="fu">AIC</span>(modEsc.probit)</span></code></pre></div>
<pre><code>## [1] 40.3178</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="modelo-logístico.html#cb159-1" tabindex="-1"></a><span class="fu">AIC</span>(modEsc.cloglog)</span></code></pre></div>
<pre><code>## [1] 33.64448</code></pre>
</div>
<div id="curva-característica-operativa-del-receptorroc" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Curva característica operativa del receptor(ROC)<a href="modelo-logístico.html#curva-característica-operativa-del-receptorroc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para evaluar el poder predictivo del modelo se puede construir una tabla de contingencia (ver Tabla <a href="#tab:tabcont"><strong>??</strong></a>) comparando <span class="math inline">\(y_i\)</span> con la predicción <span class="math inline">\(\widehat{y}_i\)</span> a través del modelo. Para datos no agrupados, la predicción <span class="math inline">\(\widehat{y}_i\)</span> se define como:
<span class="math display">\[
\widehat{y}_i = \begin{cases}
1 &amp; \mbox{si } \widehat{\pi}_i &gt; \pi_0, \\
0 &amp; \mbox{si } \widehat{\pi}_i \leq \pi_0, \\
\end{cases}
\]</span>
para un punto de corte <span class="math inline">\(\pi_0\)</span> definido por el investigador, por ejemplo <span class="math inline">\(\pi_0 = 0.5\)</span>.</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=0\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=1\)</span>
</div>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=0\)</span>
</td>
<td style="text-align:left;">
a
</td>
<td style="text-align:left;">
c
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=1\)</span>
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
d
</td>
</tr>
</tbody>
</table>
<p>El recuento de casillas en estas tablas permite estimar la sensibilidad,
<span class="math display">\[
P(\widehat{y}=1|y=1) = \frac{d}{b+d},
\]</span>
y la especificidad, <span class="math inline">\(P(\widehat{y}=0|y=0)\)</span>.
<span class="math display">\[
P(\widehat{y}=0|y=0) = \frac{a}{a+c}.
\]</span>
Sin embargo, estos valores dependen de <span class="math inline">\(\pi_0\)</span>.</p>
<p>Ahora consideremos los datos de peso al nacer. Se propone el siguiente modelo:
<span class="math display">\[
\mbox{logit } \pi_i = \beta_0+  \mbox{age}_i\beta_1+  \mbox{lwt}_i\beta_2 +  \mbox{smoke}_i\beta_3 + \mbox{ptl}_i\beta_4,
\]</span>
donde <span class="math inline">\(\pi_i\)</span> es la probabilidad de que el recién nacido nazca con bajo peso. El ajuste del modelo es:</p>
<pre><code>## 
## Call:
## glm(formula = low ~ age + lwt + smoke + ptl, family = binomial, 
##     data = birthwt)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9339  -0.8646  -0.6816   1.2182   1.9904  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  1.275961   1.031063   1.238   0.2159  
## age         -0.048859   0.033796  -1.446   0.1483  
## lwt         -0.010412   0.006219  -1.674   0.0941 .
## smoke        0.550111   0.334455   1.645   0.1000  
## ptl          0.695720   0.336895   2.065   0.0389 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 234.67  on 188  degrees of freedom
## Residual deviance: 218.36  on 184  degrees of freedom
## AIC: 228.36
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Estos resultados muestran que el estado de tabaquismo y el historial de partos prematuros son factores de riesgo para el bajo peso al nacer. Sin embargo, el primero no tiene un aporte significativo dentro del modelo.</p>
<p>Ahora vamos a evaluar el poder predictivo del modelo. Si definimos <span class="math inline">\(\pi_0=0.5\)</span>, tenemos:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=0\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=1\)</span>
</div>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=0\)</span>
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=1\)</span>
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<p>Por lo tanto, la sensibilidad es <span class="math inline">\(10/59 = 0,169\)</span> y la especificidad es <span class="math inline">\(123/130 = 0.946\)</span>. Con este punto de corte, el modelo tiene una predictividad alta para los recién nacidos con peso adecuado (alta especificidad). Sin embargo, la probabilidad de falsos positivos es alta (baja sensibilidad). Ahora, si <span class="math inline">\(\pi_0= 0,3\)</span>:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=0\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
<span class="math inline">\(\hat{y}=1\)</span>
</div>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=0\)</span>
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(y=1\)</span>
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
40
</td>
</tr>
</tbody>
</table>
<p>En este caso la sensibilidad aumentó <span class="math inline">\((40/59 = 0,678)\)</span>, pero la especificidad disminuye <span class="math inline">\((79/130 = 0,607)\)</span>.</p>
<p>Dado que la sensibilidad y especificidad tiene una alta dependencia del punto de corte, lo preferible es calcular estas cantidades para muchos valores de <span class="math inline">\(\pi_0\)</span>. En la Figura <a href="modelo-logístico.html#fig:sensespc">7.3</a> podemos observar que a medida que aumenta <span class="math inline">\(\pi_0\)</span> la sensibilidad disminuye y la especificidad aumenta.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sensespc"></span>
<img src="MLG2_files/figure-html/sensespc-1.png" alt="Datos de bajo peso al nacer. Sensibilidad (linea negra) y especificidad (linea roja) para diferentes puntos de corte." width="576" />
<p class="caption">
Figure 7.3: Datos de bajo peso al nacer. Sensibilidad (linea negra) y especificidad (linea roja) para diferentes puntos de corte.
</p>
</div>
<p>La sensibilidad es la tasa de verdaderos positivos (tvp), mientras que, el complemento de la especificidad <span class="math inline">\((P(\widehat{y}= 1 | y=0))\)</span> es la tasa de falsos positivos (tfp). El gráfico de la tasa de verdaderos positivos en función de la tasa de falsos positivos para diferentes valores de <span class="math inline">\(\pi_0\)</span>, entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>, lleva el nombre de curva característica operativa del receptor (ROC). Cuando <span class="math inline">\(\pi_0\)</span> es muy cercano a <span class="math inline">\(1\)</span>, casi todas las predicciones son <span class="math inline">\(\widehat{y}=0\)</span>; entonces tenemos (tvp,tfp)<span class="math inline">\(\approx(0,0)\)</span>. Mientras que, cuando <span class="math inline">\(\pi_0\)</span> es muy cercano a <span class="math inline">\(0\)</span>, casi todas las predicciones son <span class="math inline">\(\widehat{y}=1\)</span>; entonces tenemos (tvp,tfp)<span class="math inline">\(\approx(1,1)\)</span>. esto lo podemos ver en la Figura <a href="modelo-logístico.html#fig:sensespc2">7.4</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sensespc2"></span>
<img src="MLG2_files/figure-html/sensespc2-1.png" alt="Datos de bajo peso al nacer. Sensibilidad (linea negra) y especificidad (linea roja) para diferentes puntos de corte." width="576" />
<p class="caption">
Figure 7.4: Datos de bajo peso al nacer. Sensibilidad (linea negra) y especificidad (linea roja) para diferentes puntos de corte.
</p>
</div>
<p>Si el modelo realiza buenas predicciones, para un valor de especificidad dado, se espera que la sensibilidad también sea alta. Por lo tanto, el poder predictivo del modelo se puede medir a través del área bajo la curva del gráfico ROC. Esta medida es llamada índice de concordancia.</p>
<p>En R, las curvas ROC se puede graficar con la función <code>roc</code> de la librería <code>pROC</code> de la siguiente forma:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="modelo-logístico.html#cb162-1" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb162-2"><a href="modelo-logístico.html#cb162-2" tabindex="-1"></a>modbw.logit <span class="ot">=</span> <span class="fu">glm</span>(low<span class="sc">~</span>age<span class="sc">+</span>lwt<span class="sc">+</span>ptl<span class="sc">+</span>smoke,<span class="at">family=</span><span class="fu">binomial</span>(logit),<span class="at">data=</span>birthwt)</span>
<span id="cb162-3"><a href="modelo-logístico.html#cb162-3" tabindex="-1"></a>modbw.probit <span class="ot">=</span> <span class="fu">glm</span>(low<span class="sc">~</span>age<span class="sc">+</span>lwt<span class="sc">+</span>smoke<span class="sc">+</span>ptl,<span class="at">family=</span><span class="fu">binomial</span>(probit),<span class="at">data=</span>birthwt)</span>
<span id="cb162-4"><a href="modelo-logístico.html#cb162-4" tabindex="-1"></a></span>
<span id="cb162-5"><a href="modelo-logístico.html#cb162-5" tabindex="-1"></a>ROCbw.logit <span class="ot">=</span> <span class="fu">roc</span>(birthwt<span class="sc">$</span>low<span class="sc">~</span>modbw.logit<span class="sc">$</span>fitted.values)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="modelo-logístico.html#cb165-1" tabindex="-1"></a>ROCbw.probit <span class="ot">=</span> <span class="fu">roc</span>(birthwt<span class="sc">$</span>low<span class="sc">~</span>modbw.probit<span class="sc">$</span>fitted.values)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1
## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="modelo-logístico.html#cb167-1" tabindex="-1"></a><span class="fu">plot</span>(ROCbw.logit)</span>
<span id="cb167-2"><a href="modelo-logístico.html#cb167-2" tabindex="-1"></a><span class="fu">lines</span>(ROCbw.probit,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ROClbwdata"></span>
<img src="MLG2_files/figure-html/ROClbwdata-1.png" alt="Datos de bajo peso al nacer. Curva ROC para el modelo logístico (negro) y probit (rojo)" width="576" />
<p class="caption">
Figure 7.5: Datos de bajo peso al nacer. Curva ROC para el modelo logístico (negro) y probit (rojo)
</p>
</div>
<p>En la Figura <a href="modelo-logístico.html#fig:ROClbwdata">7.5</a> se puede observar que ambas funciones de enlace proporcionan el mismo poder predictivo. El índice de concordancia es de <span class="math inline">\(AUC= 0,6884\)</span> para el modelo logístico y <span class="math inline">\(AUC= 0,6866\)</span> para el modelo probit.</p>
<p>Para datos agrupados, la base de datos se debe desagrupar para obtener la curva ROC. Por ejemplo para los datos de escarabajos:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="modelo-logístico.html#cb168-1" tabindex="-1"></a>obs.morir <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">apply</span>(Datos.esc,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(x[<span class="dv">3</span>],x[<span class="dv">2</span>]<span class="sc">-</span>x[<span class="dv">3</span>]))}))</span>
<span id="cb168-2"><a href="modelo-logístico.html#cb168-2" tabindex="-1"></a>prob.morir <span class="ot">=</span><span class="fu">rep</span>(modEsc.logit<span class="sc">$</span>fitted.values,Datos.esc<span class="sc">$</span>n)</span>
<span id="cb168-3"><a href="modelo-logístico.html#cb168-3" tabindex="-1"></a>ROCesc <span class="ot">=</span> <span class="fu">roc</span>(obs.morir<span class="sc">~</span>prob.morir)</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="modelo-logístico.html#cb171-1" tabindex="-1"></a><span class="fu">plot</span>(ROCesc,<span class="at">print.auc=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ROCescarabajos"></span>
<img src="MLG2_files/figure-html/ROCescarabajos-1.png" alt="Datos de mortalidad de escarabajos. Curva ROC para el modelo logístico" width="576" />
<p class="caption">
Figure 7.6: Datos de mortalidad de escarabajos. Curva ROC para el modelo logístico
</p>
</div>
<p>Datos.esc</p>
</div>
<div id="sobredispersión" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Sobredispersión<a href="modelo-logístico.html#sobredispersión" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En un experimento Bernoulli se asume que los <span class="math inline">\(n_i\)</span> ensayos para la observación <span class="math inline">\(i,\quad (y_{i1},...y_{in_i})\)</span>, son independientes. Por lo tanto, para <span class="math inline">\(y_i = \sum_{j=1}^{n_i}y_{ij}/n_i\)</span>,tenemos que:</p>
<p><span class="math display">\[
E(y_i)=\pi_i \quad \text{y} \quad V(y_i)=\pi_i(1-\pi_i)\frac{1}{n_i}.
\]</span></p>
<p>Pero, hay casos donde las observaciones <span class="math inline">\((y_{i1},...y_{in_i})\)</span> están correlacionadas, es decir <span class="math inline">\(cor(y_{is},y_{it}) \ne 0\)</span>. Esto hace que <span class="math inline">\(V(y_{i}) \neq V(y_i)=\pi_i(1-\pi_i)\frac{1}{n_i}\)</span>. Si asumimos que <span class="math inline">\(cor(y_{is},y_{it})=\phi\)</span>, para todo <span class="math inline">\(s\ne t\)</span> (exchangeability property). Entonces:</p>
<p><span class="math display">\[
V(y_{it})=\pi_i(1-\pi_i)\quad \text{y} \quad cor(y_{it},y_{is})=\phi\pi_i(1-\pi_i).
\]</span></p>
<p>En este caso, tenemos que:</p>
<p><span class="math display">\[
V(y_i)=V\begin{pmatrix} \sum_{j=1}^{n_i}\frac{y_{ij}}{n_i}\end{pmatrix}=\frac{1}{n_i^2} \left[ \sum_{j=1}^{n_i}V(y_{it})+2\sum\sum_{s&lt;t}cov(y_{is},y_{it}) \right]=[1+\phi(n_i-1)]\frac{\pi_i(1-\pi_i)}{n_i}.
\]</span>
Dependiendo del valor de <span class="math inline">\(\phi\)</span>, la varianza de <span class="math inline">\(y_i\)</span> puede ser mayor o menor a la esperada bajo una distribución binomial. Si <span class="math inline">\(\phi_i &gt; 0\)</span>, tenemos un problema de sobredispersión (los datos tienen una varianza superior a la que se asume bajo un modelo binomial). Mientras que, si <span class="math inline">\(-(n_i-1)^{-1}&lt;\phi&lt;0\)</span>, hay presencia de subdispersión. El segunda caso es menos frecuenta en datos reales.</p>
<div id="evalaución-de-sobredispersión" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Evalaución de sobredispersión<a href="modelo-logístico.html#evalaución-de-sobredispersión" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el caso del modelo binomial, el estadístico de <span class="math inline">\(\chi^2\)</span> de Pearson está definido como:</p>
<p><span class="math display">\[
X^2=\sum_{i=1}^n\frac{(y_i-\widehat{\pi}_i)^2}{\widehat{\pi}_i(1-\widehat{\pi}_1)/n_i}.
\]</span>
Si el modelo binomial proporciona buen ajuste, <span class="math inline">\(X^2\)</span> sigue (asintóticamente) una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(n-p\)</span> grados de libertad. Por lo tanto, un indicador de posible inflación de varianza es:
<span class="math display">\[
\widehat{\phi}=\frac{X^2}{n-p}.
\]</span>
Si hay problemas de sobredispersión, entonces <span class="math inline">\(\widehat{\phi} &gt; 1\)</span>.</p>
</div>
</div>
<div id="distribución-beta-binomial" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Distribución beta-binomial<a href="modelo-logístico.html#distribución-beta-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El modelo beta-binomial es una alternativa para modelar datos binomial con sobredispersión. Esta distribución parte de una mezcla de una distribución binomial con una distribución beta. Sea <span class="math inline">\(y^{*}\)</span> el número de éxitos de <span class="math inline">\(n\)</span> ensayos Bernoulli. Se puede suponer la siguiente distribución de <span class="math inline">\(y^{*}\)</span>:
<span class="math display">\[
y^{*}|\pi\sim \mbox{binomial}(n,\pi), \mbox{ donde } \pi\sim \mbox{beta}(\alpha_1,\alpha_2).
\]</span>
La función de densidad de <span class="math inline">\(\pi\)</span> es:
<span class="math display">\[
f(\pi;\alpha_1,\alpha_2)=\frac{\Gamma(\alpha_1+\alpha_2)}{\Gamma(\alpha_1)\Gamma(\alpha_2)}\pi^{\alpha_1-1}(1-\pi)^{\alpha_2-1},
\]</span>
con <span class="math inline">\(\alpha_1&gt;0\)</span> y <span class="math inline">\(\alpha_2&gt;0\)</span>. Asumiendo <span class="math inline">\(\mu=\frac{\alpha_1}{\alpha_1+\alpha_2}\)</span> y <span class="math inline">\(\theta=1/(\alpha_1+\alpha_2)\)</span>, tenemos:</p>
<p><span class="math display">\[
E(\pi)=\mu\quad\text{y}\quad V(\pi)=\mu(1-\mu)\frac{\theta}{1+\theta}.
\]</span></p>
<p>La distribución beta-binomial se obtiene al marginalizar <span class="math inline">\(y^{*}\)</span>. Esto es:</p>
<p><span class="math display">\[
f(y^{*};n,\mu,\theta)=\int f(y^{*}|\pi)f(\pi)d\pi.
\]</span>
Al resolver la integral anterior, encontramos la función de densidad de la distribución beta-binomial es:</p>
<p><span class="math display">\[
f(y^{*};n,\mu,\theta)=\begin{pmatrix} n \\ y^{*} \end{pmatrix}\frac{\begin{bmatrix} \Pi_{k=0}^{y^{*}-1}(\mu+k\theta)\end{bmatrix} \begin{bmatrix} \Pi_{k=0}^{n-y^{*}-1}(1-\mu+k\theta)\end{bmatrix}}{\begin{bmatrix} \Pi_{k=0}^{n-1}(1+k\theta) \end{bmatrix}},
\]</span></p>
<p>para <span class="math inline">\(y^{*}=0,1,...,n.\)</span> El valor esperado y varianza de <span class="math inline">\(y = \frac{y^{*}}{n}\)</span> son:</p>
<p><span class="math display">\[
E(y)=\mu\quad\text{y}\quad V(y)=\left[ 1+(n-1)\frac{\theta}{1+\theta} \right]\frac{\mu(1-\mu)}{n} = \left[ 1+(n-1)\phi \right]\frac{\mu(1-\mu)}{n}.
\]</span></p>
<p>Por lo cual, <span class="math inline">\(\phi &gt; 0\)</span> es la correlación entre ensayos Bernoulli. La distribución de probabilidad de la distribución beta-binomial se puede observar en la Figura <a href="modelo-logístico.html#fig:betabinomialdensidad">7.7</a>. Aquí vemos que la dispersión de la distribución beta-binomial aumenta con el parámetro <span class="math inline">\(\phi\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:betabinomialdensidad"></span>
<img src="MLG2_files/figure-html/betabinomialdensidad-1.png" alt="Distribución de probabilidad de Binomial(15,0.3) (negro), beta-binomial(15,0.3,0.1) (rojo), beta-binomial(15,0.3,0.4) (verde)" width="576" />
<p class="caption">
Figure 7.7: Distribución de probabilidad de Binomial(15,0.3) (negro), beta-binomial(15,0.3,0.1) (rojo), beta-binomial(15,0.3,0.4) (verde)
</p>
</div>
<div id="modelo-beta-binomial" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Modelo beta-binomial<a href="modelo-logístico.html#modelo-beta-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo beta-binomial para <span class="math inline">\(y_i^{*}\)</span> se define como:
<span class="math display">\[
y_i^{*}|\pi_i\sim \mbox{binomial}(n_i,\pi_i), \mbox{ donde } \pi_i\sim \mbox{beta}(\mu_i,\phi),
\]</span>
donde <span class="math inline">\(\mbox{logit } \mu_i = \boldsymbol x_{i}&#39;\boldsymbol \beta\)</span> (si usamos una función de enlace logit). Por lo cuál, para <span class="math inline">\(y_i = \frac{y_i^{*}}{n_i}\)</span> se tiene que:
<span class="math display">\[
E(y_i)=\mu_i\quad\text{y}\quad V(y_i)=[1+(n-1)\phi]\mu_i(1-\mu_i)/n_i,
\]</span>
La estimación de los parámetros <span class="math inline">\((\beta,\phi)\)</span> se hace por máxima verosimilitud. Dado que <span class="math inline">\(\phi&gt;0)\)</span>, el modelo beta-binomial no puede modelar datos con subdispersión.</p>
</div>
<div id="estudio-de-teratología" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Estudio de teratología<a href="modelo-logístico.html#estudio-de-teratología" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para los datos del estudio de teratología se puede proponer un modelo binomial en un principio:
<span class="math display">\[
n_i y_i \sim \mbox{binomial} (n_i, \pi_i),
\]</span>
donde <span class="math inline">\(n_i\)</span> y <span class="math inline">\(y_i\)</span> es el tamaño y la proporción de fetos muertos de la camada <span class="math inline">\(i\)</span>. Además, se tiene que:
<span class="math display">\[
\mbox{logit }\pi_i = \beta_0 + \mbox{hb}_i \beta_1 + \mbox{treat}_{2i} \beta_2 + \mbox{treat}_{3i}\beta_3 + \mbox{treat}_{4i} \beta_4.
\]</span>
El ajuste del modelo es:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="modelo-logístico.html#cb172-1" tabindex="-1"></a><span class="fu">data</span>(lirat,<span class="at">package =</span> <span class="st">&#39;VGAM&#39;</span>)</span>
<span id="cb172-2"><a href="modelo-logístico.html#cb172-2" tabindex="-1"></a>modlirat.binom <span class="ot">=</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(R,N<span class="sc">-</span>R)<span class="sc">~</span>hb<span class="sc">+</span><span class="fu">as.factor</span>(grp),<span class="at">family=</span>binomial,<span class="at">data=</span>lirat)</span>
<span id="cb172-3"><a href="modelo-logístico.html#cb172-3" tabindex="-1"></a><span class="fu">summary</span>(modlirat.binom)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(R, N - R) ~ hb + as.factor(grp), family = binomial, 
##     data = lirat)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.6331  -0.9684  -0.0471   1.3945   2.8256  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       2.1795     0.5056   4.311 1.63e-05 ***
## hb               -0.2190     0.1020  -2.148 0.031728 *  
## as.factor(grp)2  -2.4748     0.5045  -4.906 9.30e-07 ***
## as.factor(grp)3  -3.1527     0.9433  -3.342 0.000832 ***
## as.factor(grp)4  -2.0520     1.0629  -1.931 0.053525 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 509.43  on 57  degrees of freedom
## Residual deviance: 168.91  on 53  degrees of freedom
## AIC: 250.38
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>La evaluación de sobredispersión la podemos hacer usando la razón entre el estadístico <span class="math inline">\(\chi^2\)</span> de Pearson y los grados de libertad:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="modelo-logístico.html#cb174-1" tabindex="-1"></a>X2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modlirat.binom,<span class="at">type=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb174-2"><a href="modelo-logístico.html#cb174-2" tabindex="-1"></a>X2<span class="sc">/</span><span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 2.93993</code></pre>
<p>Dado que está razón es aproximadamente <span class="math inline">\(3\)</span>, los datos presentan sobredispersión. Por esta razón es mas conveniente proponer un modelo beta-binomial:
<span class="math display">\[
y_i^{*}|\pi_i\sim \mbox{binomial}(n_i,\pi_i), \mbox{ donde } \pi_i\sim \mbox{beta}(\mu_i,\phi),
\]</span>
con
<span class="math display">\[
\mbox{logit }\pi_i = \beta_0 + \mbox{hb}_i \beta_1 + \mbox{treat}_{2i} \beta_2 + \mbox{treat}_{3i}\beta_3 + \mbox{treat}_{4i} \beta_4.
\]</span>
En R el modelo beta-binomial se puede estimar utilizando la función <code>betabin</code> de la librería <code>aod</code>:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="modelo-logístico.html#cb176-1" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb176-2"><a href="modelo-logístico.html#cb176-2" tabindex="-1"></a>modlirat.betabinom <span class="ot">=</span><span class="fu">betabin</span>(<span class="fu">cbind</span>(R,N<span class="sc">-</span>R)<span class="sc">~</span>hb<span class="sc">+</span><span class="fu">as.factor</span>(grp),<span class="at">data=</span>lirat,<span class="at">random=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb176-3"><a href="modelo-logístico.html#cb176-3" tabindex="-1"></a>modlirat.betabinom</span></code></pre></div>
<pre><code>## Beta-binomial model
## -------------------
## betabin(formula = cbind(R, N - R) ~ hb + as.factor(grp), random = ~1, 
##     data = lirat)
## 
## Convergence was obtained after 433 iterations.
## 
## Fixed-effect coefficients:
##                   Estimate Std. Error    z value Pr(&gt; |z|)
## (Intercept)      2.130e+00  8.676e-01  2.455e+00 1.408e-02
## hb              -1.694e-01  1.772e-01 -9.557e-01 3.392e-01
## as.factor(grp)2 -2.441e+00  8.508e-01 -2.869e+00 4.113e-03
## as.factor(grp)3 -2.836e+00  1.329e+00 -2.134e+00 3.287e-02
## as.factor(grp)4 -2.285e+00  1.817e+00 -1.258e+00 2.085e-01
## 
## Overdispersion coefficients:
##                  Estimate Std. Error z value   Pr(&gt; z)
## phi.(Intercept) 2.356e-01  6.041e-02 3.9e+00 4.813e-05
## 
## Log-likelihood statistics
##    Log-lik      nbpar    df res.   Deviance        AIC       AICc 
## -9.302e+01          6         52  1.146e+02   1.98e+02  1.997e+02</code></pre>
<p>Las estimaciones de los coeficientes del modelo beta-binomial son similares a los del modelo binomial. Sin embargo, los errores estándar son mas grandes. Esto último es debido al efecto de la sobredispersión (<span class="math inline">\(\widehat{\phi}=0.236\)</span> indica una correlación positiva entre los fetos que pertenecen a la misma camada). Además, el efecto del tratamiento #4 no es significativamente diferente al placebo.</p>
<p>Podemos evaluar sobredispersión de nuevo:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="modelo-logístico.html#cb178-1" tabindex="-1"></a>X2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modlirat.betabinom,<span class="at">type=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning in model.matrix.default(mt, mfb, contrasts): non-list contrasts argument ignored</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="modelo-logístico.html#cb180-1" tabindex="-1"></a>X2<span class="sc">/</span><span class="dv">52</span></span></code></pre></div>
<pre><code>## [1] 0.9287516</code></pre>
<p>La razón está cercana a <span class="math inline">\(1\)</span> por lo que la varianza está mejor modelada por la distribución beta-binomial. La comparación de los ajustes se puede hacer a través de criterios de información:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="modelo-logístico.html#cb182-1" tabindex="-1"></a><span class="fu">AIC</span>(modlirat.binom)</span></code></pre></div>
<pre><code>## [1] 250.3777</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="modelo-logístico.html#cb184-1" tabindex="-1"></a><span class="fu">AIC</span>(modlirat.betabinom)</span></code></pre></div>
<pre><code>##                    df      AIC     AICc
## modlirat.betabinom  6 198.0319 199.6789</code></pre>
<p>Observando los valores del AIC podemos determinar que el modelo beta-binomial presenta mejor ajuste.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-lineal-generalizado.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo-para-conteos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AlvaroFlorez/MLG2/edit/master/07-ModeloLogistico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/AlvaroFlorez/MLG2/blob/master/07-ModeloLogistico.Rmd",
"text": null
},
"download": ["MLG2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
