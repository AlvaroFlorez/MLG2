<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Modelos polinomiales | Notas de clase: Modelo lineal general II</title>
  <meta name="description" content="Capítulo 2 Modelos polinomiales | Notas de clase: Modelo lineal general II" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Modelos polinomiales | Notas de clase: Modelo lineal general II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Modelos polinomiales | Notas de clase: Modelo lineal general II" />
  
  
  

<meta name="author" content="Alvaro J. Flórez" />


<meta name="date" content="2024-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="variables-indicadoras-o-dummies.html"/>
<link rel="next" href="multicolinealidad.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notas de clase MLGII</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html"><i class="fa fa-check"></i><b>1</b> Variables indicadoras (o dummies)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#ejemplos"><i class="fa fa-check"></i><b>1.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.1.1</b> Datos de atletas australianos</a></li>
<li class="chapter" data-level="1.1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-la-onu"><i class="fa fa-check"></i><b>1.1.2</b> Datos de la ONU</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#variables-indicadoras"><i class="fa fa-check"></i><b>1.2</b> Variables indicadoras</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelos-con-covariables-categóricas"><i class="fa fa-check"></i><b>1.2.1</b> Modelos con covariables categóricas</a></li>
<li class="chapter" data-level="1.2.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.2.2</b> Modelo para los datos de atletas australianos</a></li>
<li class="chapter" data-level="1.2.3" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-la-onu"><i class="fa fa-check"></i><b>1.2.3</b> Modelo para los datos de la ONU</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html"><i class="fa fa-check"></i><b>2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplos-1"><i class="fa fa-check"></i><b>2.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles"><i class="fa fa-check"></i><b>2.1.1</b> Pasteles</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston"><i class="fa fa-check"></i><b>2.1.2</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#modelos-polinomiales-1"><i class="fa fa-check"></i><b>2.2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>2.2.1</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles-1"><i class="fa fa-check"></i><b>2.2.2</b> Pasteles</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston-1"><i class="fa fa-check"></i><b>2.2.3</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#regresión-por-segmentos"><i class="fa fa-check"></i><b>2.3</b> Regresión por segmentos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplo"><i class="fa fa-check"></i><b>2.3.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multicolinealidad.html"><a href="multicolinealidad.html"><i class="fa fa-check"></i><b>3</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#ejemplos-2"><i class="fa fa-check"></i><b>3.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#cemento"><i class="fa fa-check"></i><b>3.1.1</b> Cemento</a></li>
<li class="chapter" data-level="3.1.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#grasa-corporal"><i class="fa fa-check"></i><b>3.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#multicolinealidad-1"><i class="fa fa-check"></i><b>3.2</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#causas-de-la-multicolinealidad"><i class="fa fa-check"></i><b>3.2.1</b> Causas de la multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#detección-de-multicolinealidad"><i class="fa fa-check"></i><b>3.3</b> Detección de multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#factores-de-inflación-de-varianza"><i class="fa fa-check"></i><b>3.3.1</b> Factores de inflación de varianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-propios-de-boldsymbol-zboldsymbol-z"><i class="fa fa-check"></i><b>3.3.2</b> Valores propios de <span class="math inline">\(\boldsymbol Z&#39;\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-singulares-de-boldsymbol-z"><i class="fa fa-check"></i><b>3.3.3</b> Valores singulares de <span class="math inline">\(\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#proporciones-de-descomposición-de-varianza"><i class="fa fa-check"></i><b>3.3.4</b> Proporciones de descomposición de varianza</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento"><i class="fa fa-check"></i><b>3.4</b> Datos de cemento</a></li>
<li class="chapter" data-level="3.5" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-grasa-corporal"><i class="fa fa-check"></i><b>3.5</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="3.6" data-path="multicolinealidad.html"><a href="multicolinealidad.html#solución-al-problema-de-multicolinealidad"><i class="fa fa-check"></i><b>3.6</b> Solución al problema de multicolinealidad</a></li>
<li class="chapter" data-level="3.7" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-de-ridge"><i class="fa fa-check"></i><b>3.7</b> Estimador de ridge</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-1"><i class="fa fa-check"></i><b>3.7.1</b> Datos de cemento</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-por-componentes-principales"><i class="fa fa-check"></i><b>3.8</b> Estimador por componentes principales</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-2"><i class="fa fa-check"></i><b>3.8.1</b> Datos de cemento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="selección-de-variables.html"><a href="selección-de-variables.html"><i class="fa fa-check"></i><b>4</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplos-3"><i class="fa fa-check"></i><b>4.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#unidad-quirúrgica"><i class="fa fa-check"></i><b>4.1.1</b> Unidad quirúrgica</a></li>
<li class="chapter" data-level="4.1.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#grasa-corporal-1"><i class="fa fa-check"></i><b>4.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#problema-de-selección-de-variables"><i class="fa fa-check"></i><b>4.2</b> Problema de selección de variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#qué-pasa-si-ignoramos-covariables-importantes"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué pasa si ignoramos covariables importantes?</a></li>
<li class="chapter" data-level="4.2.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#que-pasa-si-incluimos-covariables-irrelevantes"><i class="fa fa-check"></i><b>4.2.2</b> ¿Que pasa si incluimos covariables irrelevantes?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#métodos-para-la-selección-de-variables"><i class="fa fa-check"></i><b>4.3</b> Métodos para la selección de variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>4.3.1</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="4.3.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación-ajustado"><i class="fa fa-check"></i><b>4.3.2</b> Coeficiente de determinación ajustado</a></li>
<li class="chapter" data-level="4.3.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#c_p-de-mallows"><i class="fa fa-check"></i><b>4.3.3</b> C<span class="math inline">\(_p\)</span> de Mallows</a></li>
<li class="chapter" data-level="4.3.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#estadístico-press"><i class="fa fa-check"></i><b>4.3.4</b> Estadístico PRESS</a></li>
<li class="chapter" data-level="4.3.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#criterios-de-información"><i class="fa fa-check"></i><b>4.3.5</b> Criterios de información</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#comparación-de-los-modelos"><i class="fa fa-check"></i><b>4.4</b> Comparación de los modelos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#todos-los-posibles-modelos"><i class="fa fa-check"></i><b>4.4.1</b> Todos los posibles modelos</a></li>
<li class="chapter" data-level="4.4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#algorítmos-de-selección"><i class="fa fa-check"></i><b>4.4.2</b> Algorítmos de selección</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#regresión-de-lasso"><i class="fa fa-check"></i><b>4.5</b> Regresión de LASSO</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#datos-de-grasa-corporal-1"><i class="fa fa-check"></i><b>4.5.1</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="4.5.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#validación-cruzada"><i class="fa fa-check"></i><b>4.5.2</b> Validación cruzada</a></li>
<li class="chapter" data-level="4.5.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplo-grasa-corporal"><i class="fa fa-check"></i><b>4.5.3</b> Ejemplo grasa corporal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html"><i class="fa fa-check"></i><b>5</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#ejemplos-4"><i class="fa fa-check"></i><b>5.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#crecimiento-de-pavos"><i class="fa fa-check"></i><b>5.1.1</b> Crecimiento de pavos</a></li>
<li class="chapter" data-level="5.1.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#puromicina"><i class="fa fa-check"></i><b>5.1.2</b> Puromicina</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-1"><i class="fa fa-check"></i><b>5.2</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-linealizables"><i class="fa fa-check"></i><b>5.2.1</b> Modelos no-lineales linealizables</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#estimación-de-los-parámetros"><i class="fa fa-check"></i><b>5.2.2</b> Estimación de los parámetros</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#inferencia-sobre-los-parámetros"><i class="fa fa-check"></i><b>5.2.3</b> Inferencia sobre los parámetros</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#método-de-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Método de Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#bootstrap-en-regresión"><i class="fa fa-check"></i><b>5.3.1</b> Bootstrap en regresión</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#algunas-consideraciones"><i class="fa fa-check"></i><b>5.3.2</b> Algunas consideraciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html"><i class="fa fa-check"></i><b>6</b> Modelo lineal generalizado</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#casos-de-estudio"><i class="fa fa-check"></i><b>6.2</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#mortalidad-de-escarabajos"><i class="fa fa-check"></i><b>6.2.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="6.2.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ataques-de-epilepsia"><i class="fa fa-check"></i><b>6.2.2</b> ataques de epilepsia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#preambulo"><i class="fa fa-check"></i><b>6.3</b> Preambulo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#familia-exponencial"><i class="fa fa-check"></i><b>6.3.1</b> Familia exponencial</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#relación-media-varianza"><i class="fa fa-check"></i><b>6.3.2</b> Relación media-varianza:</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>6.3.3</b> Estimador de máxima verosimilitud</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#métodos-iterativos-de-maximización"><i class="fa fa-check"></i><b>6.3.4</b> Métodos iterativos de maximización</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado-glm"><i class="fa fa-check"></i><b>6.4</b> Modelo lineal generalizado (GLM)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#componente-aleatorio"><i class="fa fa-check"></i><b>6.4.1</b> Componente aleatorio</a></li>
<li class="chapter" data-level="6.4.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#predictor-lineal"><i class="fa fa-check"></i><b>6.4.2</b> Predictor lineal</a></li>
<li class="chapter" data-level="6.4.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#función-de-enlace"><i class="fa fa-check"></i><b>6.4.3</b> Función de enlace</a></li>
<li class="chapter" data-level="6.4.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ejemplos-de-glm"><i class="fa fa-check"></i><b>6.4.4</b> Ejemplos de GLM</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ajuste-de-un-glm"><i class="fa fa-check"></i><b>6.5</b> Ajuste de un GLM</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#especificación-del-modelo"><i class="fa fa-check"></i><b>6.5.1</b> Especificación del modelo</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-por-máxima-verosimilitud-para-boldsymbol-beta"><i class="fa fa-check"></i><b>6.5.2</b> Estimador por máxima verosimilitud para <span class="math inline">\(\boldsymbol \beta\)</span></a></li>
<li class="chapter" data-level="6.5.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ajuste-e-interpretación-de-parámetros-del-modelo-poisson"><i class="fa fa-check"></i><b>6.5.3</b> ajuste e interpretación de parámetros del modelo Poisson</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>6.6</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>6.6.1</b> Método de razón de verosimilitud</a></li>
<li class="chapter" data-level="6.6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-wald"><i class="fa fa-check"></i><b>6.6.2</b> Método de Wald</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>6.7</b> intervalos de confianza</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalo-de-confianza-para-la-media"><i class="fa fa-check"></i><b>6.7.1</b> Intervalo de confianza para la media</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#devianza"><i class="fa fa-check"></i><b>6.8</b> Devianza</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#el-estadístico-chi-cuadrado-de-pearson"><i class="fa fa-check"></i><b>6.8.1</b> El estadístico chi-cuadrado de Pearson</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#bondad-de-ajuste"><i class="fa fa-check"></i><b>6.9</b> Bondad de ajuste</a></li>
<li class="chapter" data-level="6.10" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#selección-de-variables-1"><i class="fa fa-check"></i><b>6.10</b> Selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-logístico.html"><a href="modelo-logístico.html"><i class="fa fa-check"></i><b>7</b> Modelo logístico</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#casos-de-estudio-1"><i class="fa fa-check"></i><b>7.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#mortalidad-de-escarabajos-1"><i class="fa fa-check"></i><b>7.1.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="7.1.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#bajo-peso-al-nacer"><i class="fa fa-check"></i><b>7.1.2</b> Bajo peso al nacer</a></li>
<li class="chapter" data-level="7.1.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología"><i class="fa fa-check"></i><b>7.1.3</b> Estudio de teratología</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados-o-datos-no-agrupados"><i class="fa fa-check"></i><b>7.2</b> Datos agrupados o datos no agrupados</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados"><i class="fa fa-check"></i><b>7.2.1</b> Datos agrupados</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-no-agrupados"><i class="fa fa-check"></i><b>7.2.2</b> Datos no agrupados</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#funciones-de-enlace"><i class="fa fa-check"></i><b>7.3</b> Funciones de enlace</a></li>
<li class="chapter" data-level="7.4" data-path="modelo-logístico.html"><a href="modelo-logístico.html#curva-característica-operativa-del-receptorroc"><i class="fa fa-check"></i><b>7.4</b> Curva característica operativa del receptor(ROC)</a></li>
<li class="chapter" data-level="7.5" data-path="modelo-logístico.html"><a href="modelo-logístico.html#sobredispersión"><i class="fa fa-check"></i><b>7.5</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#evaluación-de-sobredispersión"><i class="fa fa-check"></i><b>7.5.1</b> Evaluación de sobredispersión</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modelo-logístico.html"><a href="modelo-logístico.html#distribución-beta-binomial"><i class="fa fa-check"></i><b>7.6</b> Distribución beta-binomial</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#modelo-beta-binomial"><i class="fa fa-check"></i><b>7.6.1</b> Modelo beta-binomial</a></li>
<li class="chapter" data-level="7.6.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología-1"><i class="fa fa-check"></i><b>7.6.2</b> Estudio de teratología</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html"><i class="fa fa-check"></i><b>8</b> Modelo para conteos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#casos-de-estudio-2"><i class="fa fa-check"></i><b>8.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#ataques-de-epilepsia-1"><i class="fa fa-check"></i><b>8.1.1</b> Ataques de epilepsia</a></li>
<li class="chapter" data-level="8.1.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido"><i class="fa fa-check"></i><b>8.1.2</b> Muertes por enfermedades cardiovasculares en doctores del Reino Unido</a></li>
<li class="chapter" data-level="8.1.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites"><i class="fa fa-check"></i><b>8.1.3</b> Número de cangrejos satélites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-poisson"><i class="fa fa-check"></i><b>8.2</b> Modelo Poisson</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-conteo-con-offset"><i class="fa fa-check"></i><b>8.2.1</b> Modelo de conteo con offset</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#sobredispersión-1"><i class="fa fa-check"></i><b>8.3</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>8.3.1</b> Distribución binomial negativa</a></li>
<li class="chapter" data-level="8.3.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-binomial-negativo"><i class="fa fa-check"></i><b>8.3.2</b> Modelo binomial negativo</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#inflación-de-ceros"><i class="fa fa-check"></i><b>8.4</b> Inflación de ceros</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-inflación-de-ceros"><i class="fa fa-check"></i><b>8.4.1</b> Modelo de inflación de ceros</a></li>
<li class="chapter" data-level="8.4.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-hurdle"><i class="fa fa-check"></i><b>8.4.2</b> Modelo Hurdle</a></li>
<li class="chapter" data-level="8.4.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites-1"><i class="fa fa-check"></i><b>8.4.3</b> Número de cangrejos satélites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html"><i class="fa fa-check"></i><b>9</b> Modelo lineal mixto</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#casos-de-estudio-3"><i class="fa fa-check"></i><b>9.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#peso-al-nacer-de-ratas"><i class="fa fa-check"></i><b>9.1.1</b> Peso al nacer de ratas</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#capacidad-respiratoria"><i class="fa fa-check"></i><b>9.1.2</b> Capacidad respiratoria</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#datos-por-cluster-correlacionados"><i class="fa fa-check"></i><b>9.2</b> Datos por cluster (correlacionados)</a></li>
<li class="chapter" data-level="9.3" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#notación"><i class="fa fa-check"></i><b>9.3</b> Notación</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelos-con-intercepto-aleatorios"><i class="fa fa-check"></i><b>9.4</b> Modelos con intercepto aleatorios</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.4.1</b> Modelo con pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-lineal-mixto-1"><i class="fa fa-check"></i><b>9.5</b> Modelo lineal mixto</a></li>
<li class="chapter" data-level="9.6" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-de-los-parámetros-1"><i class="fa fa-check"></i><b>9.6</b> Estimación de los parámetros</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-intercepto-aleatorio"><i class="fa fa-check"></i><b>9.6.1</b> Estimación del modelo con intercepto aleatorio</a></li>
<li class="chapter" data-level="9.6.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.6.2</b> Estimación del modelo con pendiente aleatoria</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de clase: Modelo lineal general II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-polinomiales" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Capítulo 2</span> Modelos polinomiales<a href="modelos-polinomiales.html#modelos-polinomiales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="ejemplos-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Ejemplos<a href="modelos-polinomiales.html#ejemplos-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pasteles" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Pasteles<a href="modelos-polinomiales.html#pasteles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con los datos <code>cakes</code> de la libreria <code>alr4</code> se tienen dos objetivos. Primero, evaluar el efecto de la temperatura y tiempo de horneado sobre la palatabilidad de mazclas de pasteles para hornear. Segundo, encontrar la combinación de estos factores que maximizan la palatabilidad. Como variable respuesta (<code>Y</code>) se tiene el promedio de calificación de la palatabilidad de cuatro pasteles horneados. Mientras que las covariables son: el tiempo de horneado (<code>X1</code>, en minutos) y la temperatura (<code>X2</code>, en grados Fahrenheit)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="modelos-polinomiales.html#cb19-1" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb19-2"><a href="modelos-polinomiales.html#cb19-2" tabindex="-1"></a><span class="fu">data</span>(cakes)</span>
<span id="cb19-3"><a href="modelos-polinomiales.html#cb19-3" tabindex="-1"></a><span class="fu">plot</span>(cakes[,<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CakesFigure"></span>
<img src="MLG2_files/figure-html/CakesFigure-1.png" alt="Datos de pasteles. Diagrama de dispersión." width="576" />
<p class="caption">
Figure 2.1: Datos de pasteles. Diagrama de dispersión.
</p>
</div>
</div>
<div id="datos-de-boston" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Datos de Boston<a href="modelos-polinomiales.html#datos-de-boston" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La base de datos <code>Boston</code> de la libreria <code>MASS</code> contiene información sobre 506 suburbios del area metropolitana de Boston. El objetivo del estudio es evaluar la relación del precio de las viviendas y la concentración de contaminación ambiental. En esta sección evaluaremos la relación entre la concentración anual de óxido de nitrógeno (<span class="math inline">\(y\)</span>, en partes por diez millones) y la distancia a cinco centros de empleo.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="modelos-polinomiales.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb20-2"><a href="modelos-polinomiales.html#cb20-2" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb20-3"><a href="modelos-polinomiales.html#cb20-3" tabindex="-1"></a><span class="fu">plot</span>(nox<span class="sc">~</span>dis,<span class="at">data=</span>Boston,<span class="at">ylab=</span><span class="st">&#39;NOx&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;distancia a centros de empleo&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BostonFigure"></span>
<img src="MLG2_files/figure-html/BostonFigure-1.png" alt="Datos de Boston. Relación entre el óxido de nitrógeno y la distancia a centros de empleo." width="576" />
<p class="caption">
Figure 2.2: Datos de Boston. Relación entre el óxido de nitrógeno y la distancia a centros de empleo.
</p>
</div>
</div>
</div>
<div id="modelos-polinomiales-1" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Modelos polinomiales<a href="modelos-polinomiales.html#modelos-polinomiales-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considere el modelo:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + \varepsilon_i,
\]</span>
donde <span class="math inline">\(\varepsilon_i \sim N(0,\sigma^2)\)</span> y <span class="math inline">\(cov(\varepsilon_i,\varepsilon_j)=0\)</span> para todo <span class="math inline">\(i\neq j\)</span>. Este describe la relación lineal entre <span class="math inline">\(y\)</span> y <span class="math inline">\(x_1\)</span>. Si las relación entre las variables presentan curvaturas, se puede considerar un modelo polinómico de la forma:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{i}^{2} + \ldots + \beta_{r}x_{i}^{r} + \varepsilon_i.
\]</span>
Este modelo se sigue considerando como un modelo lineal, dado que es lineal en los parámetros (es una función lineal de <span class="math inline">\(\boldsymbol \beta\)</span>). En la Figura <a href="modelos-polinomiales.html#fig:Polinomios">2.3</a> se puede observar diferentes curvas para modelos lineales (orden 1), cuadráticos (orden 2) y cúbicos (orden 3). Aquí vemos que este tipo de modelos son muy versatiles. Cualquier función suave se puede ajustar meidante un polinomio de grado suficientemente alto. Por esta razón, los modelos polinomicos son usados en casos donde las relaciones entre las variables son no-lineales y se pueden aproximar por un polinomio.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Polinomios"></span>
<img src="MLG2_files/figure-html/Polinomios-1.png" alt="Polinomio de grado 1 (linea negra), grado 2 (linea roja) y grado 3 (linea verde)." width="576" />
<p class="caption">
Figure 2.3: Polinomio de grado 1 (linea negra), grado 2 (linea roja) y grado 3 (linea verde).
</p>
</div>
<p>En el caso que se tengan dos covariables, un modelo de orden 2 se expresa de la forma:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{1i} + \beta_{2}x_{2i} + \beta_{3}x_{1i}^2 + \beta_{4}x_{2i}^2 + \beta_{5}x_{1i}x_{2i} + \varepsilon_i.
\]</span>
En las Figuras <a href="modelos-polinomiales.html#fig:modPoli1">2.4</a>-<a href="modelos-polinomiales.html#fig:modPoli3">2.6</a> muestran el valor esperado de <span class="math inline">\(Y\)</span> en un modelo lineal (asumiendo <span class="math inline">\(\beta_3=\beta_4=\beta_5=0\)</span>), con interacción (<span class="math inline">\(\beta_3=\beta_4=0\)</span>) y cuadrático.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:modPoli1"></span>
<img src="MLG2_files/figure-html/modPoli1-1.png" alt="Valor esperado de $Y$ en un modelo lineal (izquierda) y gráfico de contorno (derecha)." width="864" />
<p class="caption">
Figure 2.4: Valor esperado de <span class="math inline">\(Y\)</span> en un modelo lineal (izquierda) y gráfico de contorno (derecha).
</p>
</div>
<p>El número de parámetros incrementa rápidamente con el número de covariables. Con <span class="math inline">\(k\)</span> covariables, tenemos: un intercepto, <span class="math inline">\(k\)</span> términos lineales, <span class="math inline">\(k\)</span>
términos cuadráticos, y <span class="math inline">\(k(k - 1)/2\)</span> interacciones. Por esta razón, en muchos casos, no se toman en cuentas las interacción cuando el número de covariables es grande.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:modPoli2"></span>
<img src="MLG2_files/figure-html/modPoli2-1.png" alt="Valor esperado de $Y$ en un modelo cuadrático (izquierda) y gráfico de contorno (derecha)." width="864" />
<p class="caption">
Figure 2.5: Valor esperado de <span class="math inline">\(Y\)</span> en un modelo cuadrático (izquierda) y gráfico de contorno (derecha).
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:modPoli3"></span>
<img src="MLG2_files/figure-html/modPoli3-1.png" alt="Valor esperado de $Y$ en un modelo lineal con interacción (izquierda) y gráfico de contorno (derecha)." width="864" />
<p class="caption">
Figure 2.6: Valor esperado de <span class="math inline">\(Y\)</span> en un modelo lineal con interacción (izquierda) y gráfico de contorno (derecha).
</p>
</div>
<p>Hay aspectos que se deben tener en la práctica cuando se implementa un modelo polinomial:</p>
<ul>
<li><strong>Selección del orden:</strong> La idea es mantener el orden del polinomio bajo. Si embargo, si es muy bajo no logra capturar la curvatura presente en los datos. En caso que el orden sea grande, el modelo es innecesariamente más complejo y puede haber problemas de multicolinealidad.</li>
</ul>
<p>Si los datos exige un modelo de orden alto <span class="math inline">\((k &gt; 3)\)</span>, se pueden hacer transformación sobre las variables, y así, poder ajustar un modelo polinomial de orden bajo (por ejemplo cuadrático).</p>
<p>La selección del orden puede hacerse de dos formas. (1) <strong>Hacia delante</strong>: empezar con un modelo de orden <span class="math inline">\(1\)</span> e incrementar el orden uno a uno hasta que un término mayor ya no sea significativo. <strong>Hacia atrás:</strong> empezar con el modelo más complejo y eliminar los términos mayores uno a uno hasta que todos sean significativos.</p>
<ul>
<li><strong>Extrapolación</strong>: La extrapolación con modelos polinomiales puede ser muy peligrosa. Por ejemplo en la Figura <a href="modelos-polinomiales.html#fig:extrapolacion">2.7</a> podemos ajustar un modelo de orden dos a los datos (linea negra). Si hacemos una predicción fuera del rango de los datos, el valor esperado predicho sigue el comportamiento cuadrático propuesto. Sin embargo, el valor esperado de <span class="math inline">\(Y\)</span> puede seguir un comportamiento diferente (linea roja discontinua). Lo que lleva a tener una predicción sesgada.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:extrapolacion"></span>
<img src="MLG2_files/figure-html/extrapolacion-1.png" alt="Problema de extrapolación." width="576" />
<p class="caption">
Figure 2.7: Problema de extrapolación.
</p>
</div>
<ul>
<li><strong>Multicolinealidad</strong>: Al aumentar el polinomio, la matriz <span class="math inline">\(\boldsymbol X&#39;\boldsymbol X\)</span> se vuelve mal acondicionada. Es decir, las estimaciones pueden ser inestables y los errores estándar se inflan. Este problema se puede solucionar centrando las covariables. Por ejemplo en un modelo de orden 2:
<span class="math display">\[
E(Y | X=x) = \beta_{0} + \beta_{1}(x-\bar{x}) + \beta_{2}(x-\bar{x})^{2}.
\]</span>
Otra solución es usando polinomios ortogonales.</li>
</ul>
<div id="interpretación-de-los-coeficientes" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Interpretación de los coeficientes<a href="modelos-polinomiales.html#interpretación-de-los-coeficientes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Considere un modelo de orden 2. El valor esperado de <span class="math inline">\(Y\)</span> está dado por:
<span class="math display">\[
E(Y| X_{1}=x_1,X_{2}=x_2) = \beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{2} + \beta_{3}x_{1}^{2} + \beta_{4}x_{2}^{2} + \beta_{5}x_{1}x_{2}.
\]</span>
Si <span class="math inline">\(x_{1}\)</span> cambia en <span class="math inline">\(\delta\)</span> unidades <span class="math inline">\((x_{1} + \delta)\)</span>, tenemos que:
<span class="math display">\[
E(Y| X_{1}=x_1+\delta,X_{2}=x_2) =  \beta_{0} + \beta_{1}(x_{1}+\delta) + \beta_{2}x_{2} + \beta_{3}(x_{1} + \delta)^{2} + \beta_{4}x_{2}^{2} + \beta_{5}(x_{1}+\delta)x_{2}.
\]</span>
Ahora calculando la diferencia:
<span class="math display">\[
E(Y| X_{1}=x_1+\delta,X_{2}=x_2) - E(Y| X_{1}=x_1,X_{2}=x_2) = (\beta_{1}\delta + \beta_{3}\delta^{2}) + 2\beta_{3}\delta x_{1} + \beta_{5}\delta x_{2}.
\]</span>
Note que el efecto del cambio <span class="math inline">\(\delta\)</span> en <span class="math inline">\(X_1\)</span> depende de ambas covariables y del valor de <span class="math inline">\(\delta\)</span>. Por esta razón, la interpretación de los coeficientes es complicada.</p>
</div>
<div id="pasteles-1" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Pasteles<a href="modelos-polinomiales.html#pasteles-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para los datos de los pasteles, se propone el siguiente modelo:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{1i} + \beta_{2}x_{2i} + \beta_{3}x_{1i}^2 + \beta_{4}x_{2i}^{2} + \beta_{5}x_{1i}x_{2i} + \varepsilon_{i}.
\]</span>
El ajuste del modelo es:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="modelos-polinomiales.html#cb21-1" tabindex="-1"></a>mod.cakes <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2 <span class="sc">+</span> <span class="fu">I</span>(X1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(X2<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>cakes)</span>
<span id="cb21-2"><a href="modelos-polinomiales.html#cb21-2" tabindex="-1"></a><span class="fu">summary</span>(mod.cakes)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 * X2 + I(X1^2) + I(X2^2), data = cakes)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4912 -0.3080  0.0200  0.2658  0.5454 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -2.204e+03  2.416e+02  -9.125 1.67e-05 ***
## X1           2.592e+01  4.659e+00   5.563 0.000533 ***
## X2           9.918e+00  1.167e+00   8.502 2.81e-05 ***
## I(X1^2)     -1.569e-01  3.945e-02  -3.977 0.004079 ** 
## I(X2^2)     -1.195e-02  1.578e-03  -7.574 6.46e-05 ***
## X1:X2       -4.163e-02  1.072e-02  -3.883 0.004654 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4288 on 8 degrees of freedom
## Multiple R-squared:  0.9487, Adjusted R-squared:  0.9167 
## F-statistic:  29.6 on 5 and 8 DF,  p-value: 5.864e-05</code></pre>
<p>Además, los factores de inflación de varianza son los siguientes:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="modelos-polinomiales.html#cb23-1" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(mod.cakes)</span></code></pre></div>
<pre><code>##       X1       X2  I(X1^2)  I(X2^2)    X1:X2 
## 3778.083 5921.833 1328.089 5309.339 3063.500</code></pre>
<p>Aquí vemos que los VIF presentan valores muy altos, producto de ajustar un modelo cuadrático. Ahora consideremos el modelo con las covariables centradas:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="modelos-polinomiales.html#cb25-1" tabindex="-1"></a>cakes<span class="sc">$</span>X1c <span class="ot">=</span> cakes<span class="sc">$</span>X1 <span class="sc">-</span> <span class="fu">mean</span>(cakes<span class="sc">$</span>X1)</span>
<span id="cb25-2"><a href="modelos-polinomiales.html#cb25-2" tabindex="-1"></a>cakes<span class="sc">$</span>X2c <span class="ot">=</span> cakes<span class="sc">$</span>X2 <span class="sc">-</span> <span class="fu">mean</span>(cakes<span class="sc">$</span>X2)</span>
<span id="cb25-3"><a href="modelos-polinomiales.html#cb25-3" tabindex="-1"></a>modc.cakes <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1c<span class="sc">*</span>X2c <span class="sc">+</span> <span class="fu">I</span>(X1c<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(X2c<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>cakes)</span>
<span id="cb25-4"><a href="modelos-polinomiales.html#cb25-4" tabindex="-1"></a><span class="fu">summary</span>(modc.cakes)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1c * X2c + I(X1c^2) + I(X2c^2), data = cakes)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4912 -0.3080  0.0200  0.2658  0.5454 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.070000   0.175044  46.103 5.41e-11 ***
## X1c          0.367558   0.075796   4.849 0.001273 ** 
## X2c          0.096392   0.015159   6.359 0.000219 ***
## I(X1c^2)    -0.156875   0.039446  -3.977 0.004079 ** 
## I(X2c^2)    -0.011950   0.001578  -7.574 6.46e-05 ***
## X1c:X2c     -0.041625   0.010719  -3.883 0.004654 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4288 on 8 degrees of freedom
## Multiple R-squared:  0.9487, Adjusted R-squared:  0.9167 
## F-statistic:  29.6 on 5 and 8 DF,  p-value: 5.864e-05</code></pre>
<p>Los VIFs del modelo con las covariables centradas son:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="modelos-polinomiales.html#cb27-1" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(modc.cakes)</span></code></pre></div>
<pre><code>##      X1c      X2c I(X1c^2) I(X2c^2)  X1c:X2c 
## 1.000000 1.000000 1.005952 1.005952 1.000000</code></pre>
<p>En este caso, los VIF decrecieron considerablemente con respecto al modelo con las covariables originales.</p>
<p>En la figura <a href="modelos-polinomiales.html#fig:PredCakes">2.8</a> podemos observar el valor esperado estimado de la palatabilidad para diferentes valores de tiempo y temperatura de horneado.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PredCakes"></span>
<img src="MLG2_files/figure-html/PredCakes-1.png" alt="Datos de pasteles. Valor esperado de la palatabilidad para diferentes valores de tiempo y temperatura de horneado. " width="864" />
<p class="caption">
Figure 2.8: Datos de pasteles. Valor esperado de la palatabilidad para diferentes valores de tiempo y temperatura de horneado.
</p>
</div>
<p>En la Figura <a href="modelos-polinomiales.html#fig:PredCakes">2.8</a> (izquierda) vemos que, cuando la temperatura es de 350 grados Fahrenheit, el máximo de palatabilidad que se obtiene en un tiempo entre 36 y 37 minutos. Sin embargo, cuando la temperatura se incrementa a 360, la máxima palatibilidad que se puede lograr es menor. Además, se obtiene en un tiempo también menor. El efecto de la interacción también se puede observar en la Figura <a href="modelos-polinomiales.html#fig:predCakes2">2.9</a> (derecha), pero ahora fijando el tiempo de horneado y variando la temperatura. El gráfico de contornos (Figura <a href="modelos-polinomiales.html#fig:predCakes2">2.9</a>) muestra que la máxima palatabilidad se observa cuando la temperatura está alrededor de 355 y el tiempo de horneado está entre 35 y 36 minutos.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="modelos-polinomiales.html#cb29-1" tabindex="-1"></a>X1 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">32</span>, <span class="dv">38</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb29-2"><a href="modelos-polinomiales.html#cb29-2" tabindex="-1"></a>X2 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">335</span>, <span class="dv">365</span>, <span class="at">length=</span> <span class="dv">50</span>)</span>
<span id="cb29-3"><a href="modelos-polinomiales.html#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="modelos-polinomiales.html#cb29-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span> X1, <span class="at">Y =</span> X2, <span class="at">FUN =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb29-5"><a href="modelos-polinomiales.html#cb29-5" tabindex="-1"></a>    <span class="fu">predict</span>(modc.cakes, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X1c =</span> x<span class="sc">-</span><span class="fu">mean</span>(cakes<span class="sc">$</span>X1), <span class="at">X2c =</span> y<span class="sc">-</span><span class="fu">mean</span>(cakes<span class="sc">$</span>X2)))</span>
<span id="cb29-6"><a href="modelos-polinomiales.html#cb29-6" tabindex="-1"></a>})</span>
<span id="cb29-7"><a href="modelos-polinomiales.html#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="modelos-polinomiales.html#cb29-8" tabindex="-1"></a><span class="fu">contour</span>(X1, X2, y,<span class="at">xlab=</span><span class="st">&#39;tiempo de horneado (minutos)&#39;</span>,</span>
<span id="cb29-9"><a href="modelos-polinomiales.html#cb29-9" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&#39;temperatura de horneado (Fahrenheit)&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:predCakes2"></span>
<img src="MLG2_files/figure-html/predCakes2-1.png" alt="Datos de pasteles. Gráfica de contornos." width="576" />
<p class="caption">
Figure 2.9: Datos de pasteles. Gráfica de contornos.
</p>
</div>
<p>Para determinar en que combinación de tiempo (X1) y temperatura de horneado (X2) se obtiene la máxima palatabilidad, debemos resolver la siguiente ecuación:
<span class="math display">\[
\frac{\partial E(Y)}{\partial \boldsymbol x}  = \frac{\partial}{\partial \boldsymbol x} \left( \beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{2} + \beta_{3}x_{1}^2 + \beta_{4}x_{2}^{2} + \beta_{5}x_{1}x_{2} \right) = \boldsymbol 0,
\]</span>
verificando que se obtiene un máximo. Resolviendo la ecuación anterior, el máximo valor esperado de palatabilidad <span class="math inline">\((8.3)\)</span> se obtiene en un tiempo de horneado de 35.8 minutos y a una temperatura de F. El intervalo del 95% de confianza en este punto es: <span class="math inline">\((7.9, 8.7)\)</span>.</p>
</div>
<div id="datos-de-boston-1" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Datos de Boston<a href="modelos-polinomiales.html#datos-de-boston-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para los datos de contaminación se puede proponer el siguiente modelo:
<span class="math display">\[
\mbox{NOx}_{i}^{-1.5} = \beta_{0} + \beta_{1}\mbox{dis}_{i} + \beta_{2}\mbox{dis}_{i}^{2} + \beta_{3}\mbox{dis}_{i}^{3} + \varepsilon_{i}.
\]</span>
La potencia en la variable respuesta se seleccionó usando el método de Box-Cox. El ajuste del modelo es el siguiente:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="modelos-polinomiales.html#cb30-1" tabindex="-1"></a>Boston<span class="sc">$</span>disc <span class="ot">=</span> Boston<span class="sc">$</span>dis <span class="sc">-</span> <span class="fu">mean</span>(Boston<span class="sc">$</span>dis)</span>
<span id="cb30-2"><a href="modelos-polinomiales.html#cb30-2" tabindex="-1"></a>mod3.Boston <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">I</span>(nox)<span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>)<span class="sc">~</span>disc<span class="sc">+</span><span class="fu">I</span>(disc<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(disc<span class="sc">^</span><span class="dv">3</span>),<span class="at">data=</span>Boston)</span>
<span id="cb30-3"><a href="modelos-polinomiales.html#cb30-3" tabindex="-1"></a><span class="fu">summary</span>(mod3.Boston)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = I(nox)^(-1.5) ~ disc + I(disc^2) + I(disc^3), data = Boston)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.86825 -0.21380  0.00826  0.26905  0.68913 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.7939644  0.0244485 114.279  &lt; 2e-16 ***
## disc         0.3675414  0.0104022  35.333  &lt; 2e-16 ***
## I(disc^2)   -0.0461689  0.0059438  -7.768 4.54e-14 ***
## I(disc^3)    0.0020017  0.0009723   2.059     0.04 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3494 on 502 degrees of freedom
## Multiple R-squared:  0.7826, Adjusted R-squared:  0.7813 
## F-statistic: 602.4 on 3 and 502 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>La Figura <a href="modelos-polinomiales.html#fig:figPredBoston">2.10</a> muestra el ajuste del modelo cúbico. Para hacer comparaciones, se muestra también el ajuste lineal y cuadrático. Se observa que el modelo cúbico presenta un buen ajuste. El modelo explica alrededor del <span class="math inline">\(78.3\)</span>% de la variabilidad de la concentración anual de óxido de nitrógeno. Con el modelo cuadrático, el coeficiente de determinación es de <span class="math inline">\(0.781\)</span>. Sin embargo, se puede observar que este ajuste presenta deficiencias cuando las distancias son muy grandes (mayores a 11).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figPredBoston"></span>
<img src="MLG2_files/figure-html/figPredBoston-1.png" alt="Datos de Boston. Valor esperado de la concentración anual de óxido de nitrógeno (en partes por diez millones) en función de las distancias a cinco centros de empleo (media ponderada). Modelo lineal (negro), cuadrático (rojo) y cúbico (verde)." width="576" />
<p class="caption">
Figure 2.10: Datos de Boston. Valor esperado de la concentración anual de óxido de nitrógeno (en partes por diez millones) en función de las distancias a cinco centros de empleo (media ponderada). Modelo lineal (negro), cuadrático (rojo) y cúbico (verde).
</p>
</div>
</div>
</div>
<div id="regresión-por-segmentos" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Regresión por segmentos<a href="modelos-polinomiales.html#regresión-por-segmentos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El modelo por segmentos se puede expresar como:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + \beta_{2}(x_{i}-t)^{0}_{+} +  \beta_{3}(x_{i}-t)^{1}_{+} + \varepsilon_{i}.
\]</span>
donde:
<span class="math display">\[
(x_{i}-t)_{+}^{r}  = \begin{cases}
0 &amp; \mbox{ si } x_{i} + t \leq 0, \\
(x_{i}-t)^{r} &amp; \mbox{ si } x_{i} + t &gt; 0. \\
\end{cases}
\nonumber
\]</span>
Por lo tanto, si <span class="math inline">\(x_{i} \leq t\)</span>, <span class="math inline">\(E(y_{i}| x_{i}) = \beta_{0} + \beta_{1}x_{i}\)</span>. Mientras que, si <span class="math inline">\(x_{i} &gt; t\)</span>, tenemos que <span class="math inline">\(E(y_{i}| x_{i}) = (\beta_{0} + \beta_{2} - \beta_{1}t) + (\beta_{1} + \beta_{3})x_{i}\)</span>.</p>
<p>Este modelo está representado graficamente en la Figura <a href="modelos-polinomiales.html#fig:RegSegmentos">2.11</a>. Cuando <span class="math inline">\(\beta_2 \neq 0\)</span>, el modelo presenta una discontinuidad en <span class="math inline">\(t\)</span>. Mientras que, cuando se fija <span class="math inline">\(\beta_2 = 0\)</span>, el modelo presenta un cambio de pendiente en el punto <span class="math inline">\(t\)</span>. Además, <span class="math inline">\(\beta_3\)</span> indica el cambio de pendiente.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:RegSegmentos"></span>
<img src="MLG2_files/figure-html/RegSegmentos-1.png" alt="Modelo de regresión por segmentos. Modelo con discontinuidad en $t$ (izquierda). Modelo con cambio de pendiente en $t$ (derecha)." width="864" />
<p class="caption">
Figure 2.11: Modelo de regresión por segmentos. Modelo con discontinuidad en <span class="math inline">\(t\)</span> (izquierda). Modelo con cambio de pendiente en <span class="math inline">\(t\)</span> (derecha).
</p>
</div>
<p>Aquí asumimos que <span class="math inline">\(t\)</span> es conocido. Si este valor se asume como desconocido, debe estimarse a partir de los datos como un parámetro adicional. Sin embargo, se tendría que recurrir a un método de estimación para modelos no-lineales.</p>
<div id="ejemplo" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Ejemplo<a href="modelos-polinomiales.html#ejemplo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="modelos-polinomiales.html#cb32-1" tabindex="-1"></a><span class="fu">library</span>(MPV)</span>
<span id="cb32-2"><a href="modelos-polinomiales.html#cb32-2" tabindex="-1"></a><span class="fu">data</span>(p7<span class="fl">.11</span>)</span>
<span id="cb32-3"><a href="modelos-polinomiales.html#cb32-3" tabindex="-1"></a><span class="fu">plot</span>(p7<span class="fl">.11</span>,<span class="at">ylab=</span><span class="st">&#39;costo de producción por unidad (USD)&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;Unidades por lote&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LotesFigure"></span>
<img src="MLG2_files/figure-html/LotesFigure-1.png" alt="Datos de costos por lote. Diagram de dispersión de el costo de producción promedio por unidad (USD) y el tamaño del lote (unidades)." width="576" />
<p class="caption">
Figure 2.12: Datos de costos por lote. Diagram de dispersión de el costo de producción promedio por unidad (USD) y el tamaño del lote (unidades).
</p>
</div>
<p>Considere la base de datos <code>p7.11</code> de la librería <code>MPV</code>. Aquí se quiere modelar la relación entre el costo de producción promedio por unidad (USD) y el tamaño del lote (unidades). Este relación se puede observar en la Figura <a href="modelos-polinomiales.html#fig:LotesFigure">2.12</a>. Se puede observar que la relación entre las variables es lineal. Sin embargo, se aprecia un posible cambio de pendiente en el punto <span class="math inline">\(x=200\)</span>. Por esta razón se propone el siguiente modelo:
<span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + \beta_{2}(x_{i}-200)_{+}^{1} + \varepsilon_{i}.
\]</span>
Note que no se asume ninguna discontinuidad. El ajuste del modelo es:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="modelos-polinomiales.html#cb33-1" tabindex="-1"></a>p7<span class="fl">.11</span><span class="sc">$</span>x2 <span class="ot">=</span> p7<span class="fl">.11</span><span class="sc">$</span>x <span class="sc">-</span> <span class="dv">200</span></span>
<span id="cb33-2"><a href="modelos-polinomiales.html#cb33-2" tabindex="-1"></a>p7<span class="fl">.11</span><span class="sc">$</span>x2[p7<span class="fl">.11</span><span class="sc">$</span>x <span class="sc">&lt;</span> <span class="dv">200</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb33-3"><a href="modelos-polinomiales.html#cb33-3" tabindex="-1"></a>mod.lotes <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>.,<span class="at">data=</span>p7<span class="fl">.11</span>)</span>
<span id="cb33-4"><a href="modelos-polinomiales.html#cb33-4" tabindex="-1"></a><span class="fu">summary</span>(mod.lotes)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ ., data = p7.11)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.37596 -0.16641 -0.09677  0.20363  0.51734 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 15.116481   0.535383  28.235 2.67e-09 ***
## x           -0.050199   0.003332 -15.065 3.73e-07 ***
## x2           0.038852   0.005946   6.534 0.000181 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3157 on 8 degrees of freedom
## Multiple R-squared:  0.9829, Adjusted R-squared:  0.9787 
## F-statistic: 230.4 on 2 and 8 DF,  p-value: 8.474e-08</code></pre>
<p>A partir del ajuste podemos concluir que, por cada unidad que incrementa el lote, el costo de producción disminuye en <span class="math inline">\(0.05\)</span>USD. Si embargo, si el tamaño del lote es mayor a <span class="math inline">\(200\)</span>, el costo de producción disminuye solamente <span class="math inline">\(0.01\)</span>USD cuando el lote aumenta en un artículo. Gráficamente, el ajuste se puede observar en la Figura <a href="modelos-polinomiales.html#fig:LotesFigure2">2.13</a>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="modelos-polinomiales.html#cb35-1" tabindex="-1"></a>b.lotes <span class="ot">=</span> mod.lotes<span class="sc">$</span>coefficients</span>
<span id="cb35-2"><a href="modelos-polinomiales.html#cb35-2" tabindex="-1"></a><span class="fu">plot</span>(p7<span class="fl">.11</span><span class="sc">$</span>x,p7<span class="fl">.11</span><span class="sc">$</span>y,<span class="at">ylab=</span><span class="st">&#39;costo de producción por unidad (USD)&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;unidades por lote&#39;</span>)</span>
<span id="cb35-3"><a href="modelos-polinomiales.html#cb35-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb35-4"><a href="modelos-polinomiales.html#cb35-4" tabindex="-1"></a><span class="fu">lines</span>(x,b.lotes[<span class="dv">1</span>]<span class="sc">+</span>x<span class="sc">*</span>b.lotes[<span class="dv">2</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb35-5"><a href="modelos-polinomiales.html#cb35-5" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">300</span>)</span>
<span id="cb35-6"><a href="modelos-polinomiales.html#cb35-6" tabindex="-1"></a><span class="fu">lines</span>(x,b.lotes[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">200</span><span class="sc">*</span>b.lotes[<span class="dv">3</span>]<span class="sc">+</span>x<span class="sc">*</span>(b.lotes[<span class="dv">2</span>]<span class="sc">+</span>b.lotes[<span class="dv">3</span>]),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb35-7"><a href="modelos-polinomiales.html#cb35-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">200</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LotesFigure2"></span>
<img src="MLG2_files/figure-html/LotesFigure2-1.png" alt="Datos de costos por lote. Diagram de dispersión de el costo de producción promedio por unidad (USD) y el tamaño del lote (unidades)." width="576" />
<p class="caption">
Figure 2.13: Datos de costos por lote. Diagram de dispersión de el costo de producción promedio por unidad (USD) y el tamaño del lote (unidades).
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variables-indicadoras-o-dummies.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multicolinealidad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AlvaroFlorez/MLG2/edit/master/02-ModelosPolinomiales.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/AlvaroFlorez/MLG2/blob/master/02-ModelosPolinomiales.Rmd",
"text": null
},
"download": ["MLG2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
