<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Modelo lineal generalizado | Notas de clase: Modelo lineal general II</title>
  <meta name="description" content="Capítulo 6 Modelo lineal generalizado | Notas de clase: Modelo lineal general II" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Modelo lineal generalizado | Notas de clase: Modelo lineal general II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Modelo lineal generalizado | Notas de clase: Modelo lineal general II" />
  
  
  

<meta name="author" content="Alvaro J. Flórez" />


<meta name="date" content="2025-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-no-lineales.html"/>
<link rel="next" href="modelo-logístico.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notas de clase MLGII</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html"><i class="fa fa-check"></i><b>1</b> Variables indicadoras (o dummies)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#ejemplos"><i class="fa fa-check"></i><b>1.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.1.1</b> Datos de atletas australianos</a></li>
<li class="chapter" data-level="1.1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-la-onu"><i class="fa fa-check"></i><b>1.1.2</b> Datos de la ONU</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#variables-indicadoras"><i class="fa fa-check"></i><b>1.2</b> Variables indicadoras</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelos-con-covariables-categóricas"><i class="fa fa-check"></i><b>1.2.1</b> Modelos con covariables categóricas</a></li>
<li class="chapter" data-level="1.2.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.2.2</b> Modelo para los datos de atletas australianos</a></li>
<li class="chapter" data-level="1.2.3" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-la-onu"><i class="fa fa-check"></i><b>1.2.3</b> Modelo para los datos de la ONU</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html"><i class="fa fa-check"></i><b>2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplos-1"><i class="fa fa-check"></i><b>2.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles"><i class="fa fa-check"></i><b>2.1.1</b> Pasteles</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston"><i class="fa fa-check"></i><b>2.1.2</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#modelos-polinomiales-1"><i class="fa fa-check"></i><b>2.2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>2.2.1</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles-1"><i class="fa fa-check"></i><b>2.2.2</b> Pasteles</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston-1"><i class="fa fa-check"></i><b>2.2.3</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#regresión-por-segmentos"><i class="fa fa-check"></i><b>2.3</b> Regresión por segmentos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplo"><i class="fa fa-check"></i><b>2.3.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multicolinealidad.html"><a href="multicolinealidad.html"><i class="fa fa-check"></i><b>3</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#ejemplos-2"><i class="fa fa-check"></i><b>3.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#cemento"><i class="fa fa-check"></i><b>3.1.1</b> Cemento</a></li>
<li class="chapter" data-level="3.1.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#grasa-corporal"><i class="fa fa-check"></i><b>3.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#multicolinealidad-1"><i class="fa fa-check"></i><b>3.2</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#causas-de-la-multicolinealidad"><i class="fa fa-check"></i><b>3.2.1</b> Causas de la multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#detección-de-multicolinealidad"><i class="fa fa-check"></i><b>3.3</b> Detección de multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#factores-de-inflación-de-varianza"><i class="fa fa-check"></i><b>3.3.1</b> Factores de inflación de varianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-propios-de-boldsymbol-zboldsymbol-z"><i class="fa fa-check"></i><b>3.3.2</b> Valores propios de <span class="math inline">\(\boldsymbol Z&#39;\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-singulares-de-boldsymbol-z"><i class="fa fa-check"></i><b>3.3.3</b> Valores singulares de <span class="math inline">\(\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#proporciones-de-descomposición-de-varianza"><i class="fa fa-check"></i><b>3.3.4</b> Proporciones de descomposición de varianza</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento"><i class="fa fa-check"></i><b>3.4</b> Datos de cemento</a></li>
<li class="chapter" data-level="3.5" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-grasa-corporal"><i class="fa fa-check"></i><b>3.5</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="3.6" data-path="multicolinealidad.html"><a href="multicolinealidad.html#solución-al-problema-de-multicolinealidad"><i class="fa fa-check"></i><b>3.6</b> Solución al problema de multicolinealidad</a></li>
<li class="chapter" data-level="3.7" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-de-ridge"><i class="fa fa-check"></i><b>3.7</b> Estimador de ridge</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-1"><i class="fa fa-check"></i><b>3.7.1</b> Datos de cemento</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-por-componentes-principales"><i class="fa fa-check"></i><b>3.8</b> Estimador por componentes principales</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-2"><i class="fa fa-check"></i><b>3.8.1</b> Datos de cemento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="selección-de-variables.html"><a href="selección-de-variables.html"><i class="fa fa-check"></i><b>4</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplos-3"><i class="fa fa-check"></i><b>4.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#unidad-quirúrgica"><i class="fa fa-check"></i><b>4.1.1</b> Unidad quirúrgica</a></li>
<li class="chapter" data-level="4.1.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#grasa-corporal-1"><i class="fa fa-check"></i><b>4.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#problema-de-selección-de-variables"><i class="fa fa-check"></i><b>4.2</b> Problema de selección de variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#qué-pasa-si-ignoramos-covariables-importantes"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué pasa si ignoramos covariables importantes?</a></li>
<li class="chapter" data-level="4.2.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#que-pasa-si-incluimos-covariables-irrelevantes"><i class="fa fa-check"></i><b>4.2.2</b> ¿Que pasa si incluimos covariables irrelevantes?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#métodos-para-la-selección-de-variables"><i class="fa fa-check"></i><b>4.3</b> Métodos para la selección de variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>4.3.1</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="4.3.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación-ajustado"><i class="fa fa-check"></i><b>4.3.2</b> Coeficiente de determinación ajustado</a></li>
<li class="chapter" data-level="4.3.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#c_p-de-mallows"><i class="fa fa-check"></i><b>4.3.3</b> C<span class="math inline">\(_p\)</span> de Mallows</a></li>
<li class="chapter" data-level="4.3.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#estadístico-press"><i class="fa fa-check"></i><b>4.3.4</b> Estadístico PRESS</a></li>
<li class="chapter" data-level="4.3.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#criterios-de-información"><i class="fa fa-check"></i><b>4.3.5</b> Criterios de información</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#comparación-de-los-modelos"><i class="fa fa-check"></i><b>4.4</b> Comparación de los modelos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#todos-los-posibles-modelos"><i class="fa fa-check"></i><b>4.4.1</b> Todos los posibles modelos</a></li>
<li class="chapter" data-level="4.4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#algorítmos-de-selección"><i class="fa fa-check"></i><b>4.4.2</b> Algorítmos de selección</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#regresión-de-lasso"><i class="fa fa-check"></i><b>4.5</b> Regresión de LASSO</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#datos-de-grasa-corporal-1"><i class="fa fa-check"></i><b>4.5.1</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="4.5.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#validación-cruzada"><i class="fa fa-check"></i><b>4.5.2</b> Validación cruzada</a></li>
<li class="chapter" data-level="4.5.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplo-grasa-corporal"><i class="fa fa-check"></i><b>4.5.3</b> Ejemplo grasa corporal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html"><i class="fa fa-check"></i><b>5</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#ejemplos-4"><i class="fa fa-check"></i><b>5.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#crecimiento-de-pavos"><i class="fa fa-check"></i><b>5.1.1</b> Crecimiento de pavos</a></li>
<li class="chapter" data-level="5.1.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#puromicina"><i class="fa fa-check"></i><b>5.1.2</b> Puromicina</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-1"><i class="fa fa-check"></i><b>5.2</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-linealizables"><i class="fa fa-check"></i><b>5.2.1</b> Modelos no-lineales linealizables</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#estimación-de-los-parámetros"><i class="fa fa-check"></i><b>5.2.2</b> Estimación de los parámetros</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#inferencia-sobre-los-parámetros"><i class="fa fa-check"></i><b>5.2.3</b> Inferencia sobre los parámetros</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#método-de-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Método de Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#bootstrap-en-regresión"><i class="fa fa-check"></i><b>5.3.1</b> Bootstrap en regresión</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#algunas-consideraciones"><i class="fa fa-check"></i><b>5.3.2</b> Algunas consideraciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html"><i class="fa fa-check"></i><b>6</b> Modelo lineal generalizado</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#casos-de-estudio"><i class="fa fa-check"></i><b>6.2</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#mortalidad-de-escarabajos"><i class="fa fa-check"></i><b>6.2.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="6.2.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ataques-de-epilepsia"><i class="fa fa-check"></i><b>6.2.2</b> ataques de epilepsia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#preambulo"><i class="fa fa-check"></i><b>6.3</b> Preambulo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#familia-exponencial"><i class="fa fa-check"></i><b>6.3.1</b> Familia exponencial</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#relación-media-varianza"><i class="fa fa-check"></i><b>6.3.2</b> Relación media-varianza:</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>6.3.3</b> Estimador de máxima verosimilitud</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#métodos-iterativos-de-maximización"><i class="fa fa-check"></i><b>6.3.4</b> Métodos iterativos de maximización</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado-glm"><i class="fa fa-check"></i><b>6.4</b> Modelo lineal generalizado (GLM)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#componente-aleatorio"><i class="fa fa-check"></i><b>6.4.1</b> Componente aleatorio</a></li>
<li class="chapter" data-level="6.4.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#predictor-lineal"><i class="fa fa-check"></i><b>6.4.2</b> Predictor lineal</a></li>
<li class="chapter" data-level="6.4.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#función-de-enlace"><i class="fa fa-check"></i><b>6.4.3</b> Función de enlace</a></li>
<li class="chapter" data-level="6.4.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ejemplos-de-glm"><i class="fa fa-check"></i><b>6.4.4</b> Ejemplos de GLM</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ajuste-de-un-glm"><i class="fa fa-check"></i><b>6.5</b> Ajuste de un GLM</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#especificación-del-modelo"><i class="fa fa-check"></i><b>6.5.1</b> Especificación del modelo</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-por-máxima-verosimilitud-para-boldsymbol-beta"><i class="fa fa-check"></i><b>6.5.2</b> Estimador por máxima verosimilitud para <span class="math inline">\(\boldsymbol \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>6.6</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>6.6.1</b> Método de razón de verosimilitud</a></li>
<li class="chapter" data-level="6.6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-wald"><i class="fa fa-check"></i><b>6.6.2</b> Método de Wald</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>6.7</b> intervalos de confianza</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalo-de-confianza-para-la-media"><i class="fa fa-check"></i><b>6.7.1</b> Intervalo de confianza para la media</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#devianza"><i class="fa fa-check"></i><b>6.8</b> Devianza</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#el-estadístico-chi-cuadrado-de-pearson"><i class="fa fa-check"></i><b>6.8.1</b> El estadístico chi-cuadrado de Pearson</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#bondad-de-ajuste"><i class="fa fa-check"></i><b>6.9</b> Bondad de ajuste</a></li>
<li class="chapter" data-level="6.10" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#selección-de-variables-1"><i class="fa fa-check"></i><b>6.10</b> Selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-logístico.html"><a href="modelo-logístico.html"><i class="fa fa-check"></i><b>7</b> Modelo logístico</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#casos-de-estudio-1"><i class="fa fa-check"></i><b>7.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#mortalidad-de-escarabajos-1"><i class="fa fa-check"></i><b>7.1.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="7.1.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#bajo-peso-al-nacer"><i class="fa fa-check"></i><b>7.1.2</b> Bajo peso al nacer</a></li>
<li class="chapter" data-level="7.1.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología"><i class="fa fa-check"></i><b>7.1.3</b> Estudio de teratología</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados-o-datos-no-agrupados"><i class="fa fa-check"></i><b>7.2</b> Datos agrupados o datos no agrupados</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados"><i class="fa fa-check"></i><b>7.2.1</b> Datos agrupados</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-no-agrupados"><i class="fa fa-check"></i><b>7.2.2</b> Datos no agrupados</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#funciones-de-enlace"><i class="fa fa-check"></i><b>7.3</b> Funciones de enlace</a></li>
<li class="chapter" data-level="7.4" data-path="modelo-logístico.html"><a href="modelo-logístico.html#curva-característica-operativa-del-receptorroc"><i class="fa fa-check"></i><b>7.4</b> Curva característica operativa del receptor(ROC)</a></li>
<li class="chapter" data-level="7.5" data-path="modelo-logístico.html"><a href="modelo-logístico.html#sobredispersión"><i class="fa fa-check"></i><b>7.5</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#evaluación-de-sobredispersión"><i class="fa fa-check"></i><b>7.5.1</b> Evaluación de sobredispersión</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modelo-logístico.html"><a href="modelo-logístico.html#distribución-beta-binomial"><i class="fa fa-check"></i><b>7.6</b> Distribución beta-binomial</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#modelo-beta-binomial"><i class="fa fa-check"></i><b>7.6.1</b> Modelo beta-binomial</a></li>
<li class="chapter" data-level="7.6.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología-1"><i class="fa fa-check"></i><b>7.6.2</b> Estudio de teratología</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html"><i class="fa fa-check"></i><b>8</b> Modelo para conteos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#casos-de-estudio-2"><i class="fa fa-check"></i><b>8.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#ataques-de-epilepsia-1"><i class="fa fa-check"></i><b>8.1.1</b> Ataques de epilepsia</a></li>
<li class="chapter" data-level="8.1.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido"><i class="fa fa-check"></i><b>8.1.2</b> Muertes por enfermedades cardiovasculares en doctores del Reino Unido</a></li>
<li class="chapter" data-level="8.1.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites"><i class="fa fa-check"></i><b>8.1.3</b> Número de cangrejos satélites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-poisson"><i class="fa fa-check"></i><b>8.2</b> Modelo Poisson</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-conteo-con-offset"><i class="fa fa-check"></i><b>8.2.1</b> Modelo de conteo con offset</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#sobredispersión-1"><i class="fa fa-check"></i><b>8.3</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>8.3.1</b> Distribución binomial negativa</a></li>
<li class="chapter" data-level="8.3.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-binomial-negativo"><i class="fa fa-check"></i><b>8.3.2</b> Modelo binomial negativo</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#inflación-de-ceros"><i class="fa fa-check"></i><b>8.4</b> Inflación de ceros</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-inflación-de-ceros"><i class="fa fa-check"></i><b>8.4.1</b> Modelo de inflación de ceros</a></li>
<li class="chapter" data-level="8.4.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-hurdle"><i class="fa fa-check"></i><b>8.4.2</b> Modelo Hurdle</a></li>
<li class="chapter" data-level="8.4.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites-1"><i class="fa fa-check"></i><b>8.4.3</b> Número de cangrejos satélites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html"><i class="fa fa-check"></i><b>9</b> Modelo lineal mixto</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#casos-de-estudio-3"><i class="fa fa-check"></i><b>9.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#peso-al-nacer-de-ratas"><i class="fa fa-check"></i><b>9.1.1</b> Peso al nacer de ratas</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#capacidad-respiratoria"><i class="fa fa-check"></i><b>9.1.2</b> Capacidad respiratoria</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#datos-por-cluster-correlacionados"><i class="fa fa-check"></i><b>9.2</b> Datos por cluster (correlacionados)</a></li>
<li class="chapter" data-level="9.3" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#notación"><i class="fa fa-check"></i><b>9.3</b> Notación</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelos-con-intercepto-aleatorios"><i class="fa fa-check"></i><b>9.4</b> Modelos con intercepto aleatorios</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.4.1</b> Modelo con pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-lineal-mixto-1"><i class="fa fa-check"></i><b>9.5</b> Modelo lineal mixto</a></li>
<li class="chapter" data-level="9.6" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-de-los-parámetros-1"><i class="fa fa-check"></i><b>9.6</b> Estimación de los parámetros</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-intercepto-aleatorio"><i class="fa fa-check"></i><b>9.6.1</b> Estimación del modelo con intercepto aleatorio</a></li>
<li class="chapter" data-level="9.6.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.6.2</b> Estimación del modelo con pendiente aleatoria</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de clase: Modelo lineal general II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo-lineal-generalizado" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Capítulo 6</span> Modelo lineal generalizado<a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducción-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introducción<a href="modelo-lineal-generalizado.html#introducción-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Asumiendo independencia entre las observaciones <span class="math inline">\(y_1,\ldots,y_n\)</span>, los modelos lineales se expresan como:
<span class="math display">\[
\boldsymbol y=\boldsymbol X\boldsymbol \beta+\boldsymbol \varepsilon, \quad \text{donde}\quad \boldsymbol \varepsilon\sim N(\boldsymbol 0,\sigma^2\boldsymbol I),
\]</span>
donde <span class="math inline">\(\boldsymbol y\)</span> es el vector de variable respuesta, <span class="math inline">\(\boldsymbol X\)</span> es la matriz <span class="math inline">\(n \times p\)</span> de covariables, <span class="math inline">\(\boldsymbol \beta\)</span> el vector de coeficientes, y <span class="math inline">\(\boldsymbol \varepsilon\)</span> el vector de los errores.
De aquí podemos derivar que <span class="math inline">\(\boldsymbol y\sim N(\boldsymbol X\boldsymbol \beta, \sigma^{2}\boldsymbol I)\)</span>. Esto implica, entre otras cosas, que:</p>
<ul>
<li>hay una relación lineal entre el valor esperado de la variable respuesta y el conjunto de covariables,</li>
<li>la varianza de la variable respuesta es constante,</li>
<li>la inferencia asume que la variable respuesta sigue una distribución normal.</li>
</ul>
<p>Sin embargo, hay situaciones en donde estas propiedades no son factibles, incluso luego de hacer transformaciones sobre las variables. Por ejemplo, si la variable de respuesta es dicotómica <span class="math inline">\((y_{i}\in\{0,1\})\)</span> no podríamos representar <span class="math inline">\(E(y|\boldsymbol x)\)</span> como una función lineal. Además, la distribución asociada dificilmente serían normal. Aquí es mas conveniente es proponer una distribución de probabilidad diferente, por ejemplo, una Bernoulli, y ajustar un modelo lineal generalizado (GLM).</p>
</div>
<div id="casos-de-estudio" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Casos de estudio<a href="modelo-lineal-generalizado.html#casos-de-estudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mortalidad-de-escarabajos" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Mortalidad de escarabajos<a href="modelo-lineal-generalizado.html#mortalidad-de-escarabajos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En un estudio de toxicología, se está interesado en la tasa de mortalidad de escarabajos expuestos a disulfuro de carbono gaseoso. La Tabla <a href="modelo-lineal-generalizado.html#tab:TmortEsc">6.1</a> muestra el número de escarabajos muertos después de cinco horas de exposición de este tóxico a diferentes concentraciones del químico. Podemos ver que a medida que aumenta la dosis, la mortalidad de escarabajos va aumentando.</p>
<table>
<caption><span id="tab:TmortEsc">Table 6.1: </span>Número de escarabajos expuestos y muertos a diferentes dosis (escala logarítmica) de disulfuro de carbono gaseoso.</caption>
<thead>
<tr class="header">
<th align="right">log. dosis</th>
<th align="right">expuestos</th>
<th align="right">muertos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.6907</td>
<td align="right">59</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1.7242</td>
<td align="right">60</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">1.7552</td>
<td align="right">62</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="right">1.7842</td>
<td align="right">56</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">1.8113</td>
<td align="right">63</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="right">1.8369</td>
<td align="right">59</td>
<td align="right">53</td>
</tr>
<tr class="odd">
<td align="right">1.8610</td>
<td align="right">62</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td align="right">1.8839</td>
<td align="right">60</td>
<td align="right">60</td>
</tr>
</tbody>
</table>
<p>Lectura de datos en R:</p>
<p>En la Figura <a href="modelo-lineal-generalizado.html#fig:grafMortEsc">6.1</a> podemos observar como es el aumento de la tasa de mortalidad con respecto a la dosis del tóxico. Note que la relación no es lineal, si no que tiene una forma de ‘S’. Esto hace que un modelo de regresión lineal sea inadecuado (además una línea recta permitiría estimaciones por debajo de cero y encima de 1).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grafMortEsc"></span>
<img src="MLG2_files/figure-html/grafMortEsc-1.png" alt="Datos de mortalidad de escarabajos. Relación entre la concentración de disulfuro de carbono gaseoso (en escala logarítmica) y la proporción de muertes (muertos/expuestos) de los escarabajos." width="576" />
<p class="caption">
Figure 6.1: Datos de mortalidad de escarabajos. Relación entre la concentración de disulfuro de carbono gaseoso (en escala logarítmica) y la proporción de muertes (muertos/expuestos) de los escarabajos.
</p>
</div>
<p>Una alternativa es utilizar una transformación que describa la relación de forma adecuada y que garantice que la respuesta se encuentre dentro del espacio del parámetro. Es decir, que la estimación de la proporción de escarabajos muertos esté entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>.</p>
</div>
<div id="ataques-de-epilepsia" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> ataques de epilepsia<a href="modelo-lineal-generalizado.html#ataques-de-epilepsia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los datos <code>data(epilepsy)</code> de la librería <code>HSAUR2</code> corresponden a un ensayo clínico para evaluar el efecto del fármaco Progabida sobre los ataques epilépticos. Al inicio del estudio, los <span class="math inline">\(59\)</span> pacientes epilépticos fueron observados durante 8 semanas, y se registró el número de convulsiones. Luego, fueron aleatorizados al tratamiento con el fármaco Progabide (<span class="math inline">\(31\)</span> pacientes) o al grupo de placebo (<span class="math inline">\(28\)</span> pacientes). A los pacientes de ambos grupos se les observo durante cuatro períodos de dos semanas y se registró el número de convulsiones.</p>
<p>Estos datos son de naturaleza longitudinal (cada paciente cuenta con 4 observaciones tomadas en el tiempo), lo que requiere metodologías que tengan en cuenta la correlación que hay en los datos. En es caso, no consideraremos las observaciones intermedias de cada paciente, sino solamente las mediciones tomadas luego de las cuatro semanas de observación.</p>
<p>Las variables que se tendrán en cuenta son las siguientes:
* <code>age</code>: edad del paciente,</p>
<ul>
<li><p><code>base</code>: número de ataques epilépticos en las 8 semanas antes de iniciar los tratamientos,</p></li>
<li><p><code>treatment</code>: tratamiento (placebo, Progabida),</p></li>
<li><p><code>seizure.rate</code>(variable respuesta): número de ataques epilépticos en las últimas dos semanas al final de estudio (luego cuatro semanas de tratamiento).</p></li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:seizurePlot"></span>
<img src="MLG2_files/figure-html/seizurePlot-1.png" alt="Datos de epilepsia. Relación entre el número de ataques epilépticos con la edad, ataques previos (izquierda) y el tratamiento (derecha)." width="960" />
<p class="caption">
Figure 6.2: Datos de epilepsia. Relación entre el número de ataques epilépticos con la edad, ataques previos (izquierda) y el tratamiento (derecha).
</p>
</div>
<p>La Figura <a href="modelo-lineal-generalizado.html#fig:seizurePlot">6.2</a> muestra la relación del número de ataques epiléticos al final del estudio con las posibles covariables. Aquí vemos que no parece haber relación con la edad, hay una relación positiva fuerte con el número de ataques pre-tratamiento, y que los pacientes del grupo placebo parecen presentar un poco más de convulsiones luego de las 8 semanas de tratamiento.</p>
</div>
</div>
<div id="preambulo" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Preambulo<a href="modelo-lineal-generalizado.html#preambulo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Antes de introducir los GLM, vamos a recordar algunos conceptos sobre distribuciones de probabilidad.</p>
<div id="familia-exponencial" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Familia exponencial<a href="modelo-lineal-generalizado.html#familia-exponencial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La distribución de probabilidad de una variable aleatoria <span class="math inline">\(Y\)</span> pertenece a la <strong>familia exponencial</strong> si la función de densidad (o masa) de <span class="math inline">\(Y\)</span> se puede expresar de la siguiente forma:
<span class="math display">\[
f(y;\theta,\phi)=\exp\{[y\theta-b(\theta)]/a(\phi)+c(y,\phi)\},
\]</span></p>
<p>donde <span class="math inline">\(\theta\)</span> es llamado parámetro natural, y <span class="math inline">\(\phi&gt;0\)</span> es un parámetro de dispersión. Además se tiene que:</p>
<p><span class="math display">\[
E[Y]=b&#39;(\theta) \quad \text{y} \quad V[Y]=b&#39;&#39;(\theta)a(\phi).
\]</span>
Por ejemplo, la distribución Poisson pertenece a la familia exponencial. Para demostrarlo, la función de densidad de la distribución Poisson:</p>
<p><span class="math display">\[
f(y;\mu)=\frac{\lambda^y\exp(-\lambda)}{y!},
\]</span></p>
<p>se puede reescribir como:</p>
<p><span class="math display">\[
f(y;\lambda)=\exp(-\lambda+y\log\lambda-\log y!).
\]</span>
Por lo tanto, la distribución Poisson pertenece a la familia exponencial con <span class="math inline">\(\theta=\log\mu\)</span>, <span class="math inline">\(b(\theta)=\exp(\theta)\)</span>, <span class="math inline">\(a(\phi)=1\)</span> y <span class="math inline">\(c(y,\phi)=-\log y!\)</span>.</p>
<p>La distribución normal también pertenece la familia exponencial. Su función de densidad,</p>
<p><span class="math display">\[
f(y;\mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma}}\exp\left[-\frac{(y-\mu   )^2}{2\sigma^2}\right],
\]</span></p>
<p>se puede reescribir como:</p>
<p><span class="math display">\[
f(y;\mu,\sigma^2)=\exp\left[\frac{y\mu-\frac{1}{2}\mu^2}{\sigma^2}-\frac{1}{2}\log(2\pi\sigma^2)-\frac{y^2}{2\sigma^2}\right],
\]</span></p>
<p>donde <span class="math inline">\(\theta=\mu\)</span>, <span class="math inline">\(b(\theta)=\frac{1}{2}\theta^2\)</span>, <span class="math inline">\(a(\phi)=\sigma^2\)</span> y <span class="math inline">\(c(y,\phi)=-\frac{1}{2}log(2\pi\sigma^2)-\frac{y^2}{2\sigma^2}\)</span>.</p>
<p>Finalmente, también la distribución binomial pertenece a la familia exponencial. Su función densidad,</p>
<p><span class="math display">\[
f(y;\pi)=\left(\begin{array}{c}n\\y\end{array}\right)\pi^y(1-\pi)^{n-y}.
\]</span>
se puede reescribir como:</p>
<p><span class="math display">\[
f(y;\pi)=\exp\left\{y[\log\pi-\log(1-\pi)]+n\log(1-\pi)+\log\left(\begin{array}{c}n\\y\end{array}\right)\right\},
\]</span>
donde <span class="math inline">\(\theta=log\left(\frac{\pi}{1-\pi}\right)\)</span>, <span class="math inline">\(b(\theta)=-n\log\left[1+\exp(\theta)\right]\)</span>, <span class="math inline">\(c(\phi)=1\)</span> y <span class="math inline">\(d(y,\phi)=\log\left(\begin{array}{c}n\\y\end{array}\right)\)</span>.</p>
</div>
<div id="relación-media-varianza" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Relación media-varianza:<a href="modelo-lineal-generalizado.html#relación-media-varianza" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para algunas distribuciones de probabilidad hay una relación directa entre la media y la varianza. Por ejemplo, para la distribución binomial tenemos que:
<span class="math display">\[
E(Y) = \mu = n\pi \mbox{ y } V(Y) =  n\pi(1-\pi),
\]</span>
por lo que <span class="math inline">\(V(Y) = \nu(\mu) = \mu(1-\mu)/n\)</span>.</p>
<p>Para la distribución Poisson, tenemos que <span class="math inline">\(V(Y) = \nu(\mu) = \mu\)</span>. Es decir, la varianza es igual a la media. Mientras que, para la distribución normal, la media y la varianza son parámetros independientes.</p>
</div>
<div id="estimador-de-máxima-verosimilitud" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Estimador de máxima verosimilitud<a href="modelo-lineal-generalizado.html#estimador-de-máxima-verosimilitud" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se asume que <span class="math inline">\(Y \sim f(y,\boldsymbol \theta)\)</span> y estamos interesados en estimar <span class="math inline">\(\boldsymbol \theta\)</span>. Para ello tomamos una muestra independiente <span class="math inline">\((y_{1},y_{2},...,y_{n})\)</span>. Por lo que, la <strong>función de verosimilitud</strong> está definida como:
<span class="math display">\[
L(\boldsymbol \theta)=\prod_{i=1}^nf(y_{i};\boldsymbol \theta),
\]</span></p>
<p>y la función de log-verosimilitud es:
<span class="math display">\[
\ell(\boldsymbol \theta)=\sum_{i=1}^n\log f(y_{i},\boldsymbol \theta).
\]</span></p>
<p>El objetivo del estimador por máxima verosimilitud (MLE) es encontrar el <span class="math inline">\(\widehat{\boldsymbol \theta}\)</span> que maximiza <span class="math inline">\(L(\boldsymbol \theta)\)</span> (o <span class="math inline">\(\ell(\boldsymbol \theta)\)</span>). Para esto, tenemos que calcular las derivadas de <span class="math inline">\(\ell(\boldsymbol \theta)\)</span> con respecto a cada elemento de <span class="math inline">\(\boldsymbol \theta\)</span> y resolver las <strong>ecuaciones score</strong>:</p>
<p><span class="math display">\[
\boldsymbol u(\boldsymbol \theta)=\frac{\partial\ell(\boldsymbol \theta)}{\partial\boldsymbol \theta}=\boldsymbol 0,
\]</span>
para <span class="math inline">\(\boldsymbol \theta\)</span>. Es necesario verificar si la solución corresponde a un máximo de <span class="math inline">\(\ell(\boldsymbol \theta)\)</span>, evaluando si la matriz de segundas derivadas <strong>(matriz hessiana)</strong>:</p>
<p><span class="math display">\[
\boldsymbol H(\boldsymbol \theta)=\frac{\partial^2\ell(\boldsymbol \theta)}{\partial\boldsymbol \theta\partial\boldsymbol \theta^{&#39;}},
\]</span>
evaluada en <span class="math inline">\(\boldsymbol \theta=\widehat{\boldsymbol \theta}\)</span>, es negativa-definida.</p>
<div id="propiedades-asintóticas-de-los-mles" class="section level4 hasAnchor" number="6.3.3.1">
<h4><span class="header-section-number">6.3.3.1</span> Propiedades asintóticas de los MLEs<a href="modelo-lineal-generalizado.html#propiedades-asintóticas-de-los-mles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Las propiedades de los MLEs están basadas en teoría asintótica. Es decir, se cumplen cuando el tamaño de muestra es grande <span class="math inline">\((n\to \infty)\)</span>. <span class="math inline">\(\widehat{\boldsymbol \theta}\)</span> es asintóticamente insesgado. Esto es, <span class="math inline">\(E(\widehat{\boldsymbol \theta})=\boldsymbol \theta\)</span> cuando <span class="math inline">\(n\to \infty\)</span>. La varianza asintótica de <span class="math inline">\(\widehat{\boldsymbol \theta}\)</span> se calcula como la inversa de <strong>la matriz de información</strong>:
<span class="math display">\[
V(\widehat{\boldsymbol \theta})=I(\boldsymbol \theta)^{-1},\quad \text{donde} \quad I(\boldsymbol \theta)=-E[H(\boldsymbol \theta)].
\]</span>
Por lo cual, es MLE es un estimador eficiente.</p>
<p>Además, <span class="math inline">\(\widehat{\boldsymbol \theta}\)</span> es asintoticamente normal. Esto es, <span class="math inline">\(\widehat{\boldsymbol \theta}\sim N[\boldsymbol \theta,I(\boldsymbol \theta)^{-1}]\)</span>. Finalmente, el MLE cumple con la propiedad de invarianza. Si <span class="math inline">\(\widehat{\boldsymbol \theta}\)</span> es el MLE de <span class="math inline">\(\boldsymbol \theta\)</span>, entonces <span class="math inline">\(g(\widehat{\boldsymbol \theta})\)</span> es el MLE de <span class="math inline">\(g(\boldsymbol \theta)\)</span>.</p>
</div>
</div>
<div id="métodos-iterativos-de-maximización" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Métodos iterativos de maximización<a href="modelo-lineal-generalizado.html#métodos-iterativos-de-maximización" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En algunos casos no es posible encontrar los MLEs de forma analítica, por lo que debemos hacerlo de forma iterativa. Los métodos que vamos a utilizar están basados en expansiones de series de Taylor.</p>
<p>Considere una expansión de series de Taylor de orden 1 para la función score, alrededor de <span class="math inline">\(\boldsymbol \theta=\boldsymbol \theta^{(t)}\)</span>:</p>
<p><span class="math display">\[
\boldsymbol u\left(\boldsymbol \theta\right)\approx \boldsymbol u\left(\boldsymbol \theta^{(t)}\right)+\boldsymbol H\left(\boldsymbol \theta^{(t)}\right)\left(\boldsymbol \theta-\boldsymbol \theta^{(t)}\right).
\]</span>
Igualando la expresión anterior a cero tenemos que:</p>
<p><span class="math display">\[
\boldsymbol u\left(\boldsymbol \theta^{(t)}\right)+\boldsymbol H\left(\boldsymbol \theta^{(t)}\right)\left(\boldsymbol \theta-\boldsymbol \theta^{(t)}\right)=\boldsymbol 0,
\]</span>
Ahora, encontramos la solución para <span class="math inline">\(\boldsymbol \theta^{(t+1)}\)</span> de la siguiente forma:
<span class="math display">\[
\boldsymbol \theta^{(t+1)}=\boldsymbol \theta^{t}-\boldsymbol H\left(\boldsymbol \theta^{t}\right)^{-1}\boldsymbol u\left(\boldsymbol \theta^{t}\right).
\]</span>
Podemos encontrar la estimación de <span class="math inline">\(\boldsymbol \theta\)</span> repitiendo los pasos anteriores hasta que se cumpla un criterio de convergencia. Si reemplazamos <span class="math inline">\(\boldsymbol H(\boldsymbol \theta)\)</span> por <span class="math inline">\(\boldsymbol I(\boldsymbol \theta)\)</span>, el algoritmo recibe el nombre de <strong>Fisher’s scoring</strong>.</p>
</div>
</div>
<div id="modelo-lineal-generalizado-glm" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Modelo lineal generalizado (GLM)<a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un GLM está definido por tres componentes:</p>
<ul>
<li><p><strong>Componente aleatorio:</strong> variable respuesta <span class="math inline">\(Y\)</span> y su distribución de probabilidad.</p></li>
<li><p><strong>Predictor lineal:</strong> <span class="math inline">\(\eta=\boldsymbol x^{&#39;}\boldsymbol \beta\)</span>, donde <span class="math inline">\(\boldsymbol \beta\)</span> es un vector de parámetros y <span class="math inline">\(\boldsymbol x\)</span> un vector de covariables.</p></li>
<li><p><strong>Función de enlace:</strong> una función <span class="math inline">\(g\)</span> que conecta la media de la variable respuesta, <span class="math inline">\(E(Y)\)</span>, con el predictor lineal, <span class="math inline">\(\eta\)</span>, <span class="math inline">\(g[E(Y|\boldsymbol x)]=\boldsymbol x&#39;\boldsymbol \beta\)</span>.</p></li>
</ul>
<div id="componente-aleatorio" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Componente aleatorio<a href="modelo-lineal-generalizado.html#componente-aleatorio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se asume que se cuenta con <span class="math inline">\(n\)</span> observaciones independientes <span class="math inline">\((y_{i},...,y_{n})\)</span> de una variable aleatoria <span class="math inline">\(Y\)</span> cuya distribución de probabilidad pertenece a la <strong>familia exponencial.</strong> Restringir un GLM a esta familia permite tener expresiones generales para la función de verosimilitud y funciones score, la distribución asintótica de los estimadores de los parámetros del modelo, y el algoritmo para ajustar el modelo.</p>
<p>Por ejemplo, para los datos de los escarabajos podemos asumir que el número de escarabajos que mueren, para cada dosis del químico, sigue una distribución binomial. Mientras que en el caso del ensayo clínico en epilepsia, se podría asumir que el número de ataques epilépticos, condicionado a las covariables, sigue una distribución Poisson.</p>
</div>
<div id="predictor-lineal" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Predictor lineal<a href="modelo-lineal-generalizado.html#predictor-lineal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para cada observación <span class="math inline">\(i\)</span>, tenemos un conjunto de covariables observadas,</p>
<p><span class="math display">\[
\boldsymbol x_{i}=(1,x_{i1},...,x_{i,p-1})^{&#39;},
\]</span></p>
<p>donde <span class="math inline">\(x_{ij}\)</span> es la <span class="math inline">\(j\)</span>-ésima covariable asociada al individuo <span class="math inline">\(i\)</span>. Entonces, el predictor lineal está definido como:
<span class="math display">\[
\eta_{i}=\beta_{0}+\sum_{j=1}^{p-1}\beta_{j}x_{ij}=\boldsymbol x_{i}^{&#39;}\boldsymbol \beta.
\]</span></p>
</div>
<div id="función-de-enlace" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Función de enlace<a href="modelo-lineal-generalizado.html#función-de-enlace" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En algunas distribuciones,<span class="math inline">\(E(Y|\boldsymbol x)\)</span> está acotada en un intervalo. Por ejemplo, en la distribución binomial, <span class="math inline">\(0\leq \pi_{i}\leq 1\)</span>, o en la Poisson, <span class="math inline">\(\lambda_{i}&gt;0\)</span>. Esto hace que no siempre sea razonable asumir una relación lineal entre <span class="math inline">\(E(Y | \boldsymbol x)\)</span> y <span class="math inline">\(\boldsymbol x\)</span>. Por lo que la función de enlace conecta <span class="math inline">\(E(Y|\boldsymbol x)\)</span> con el predictor lineal <span class="math inline">\(\eta\)</span> a través de una función <span class="math inline">\(g()\)</span>:</p>
<p><span class="math display">\[
E(Y|\boldsymbol x)=g^{-1}(\eta)=g^{-1}(\boldsymbol x^{&#39;}\boldsymbol \beta),
\]</span>
donde, la función <span class="math inline">\(g(\cdot)\)</span> es monótona y diferenciable. Generalmente, <span class="math inline">\(g(\cdot)\)</span> está determinada por la distribución que se asume para <span class="math inline">\(Y\)</span>.</p>
</div>
<div id="ejemplos-de-glm" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Ejemplos de GLM<a href="modelo-lineal-generalizado.html#ejemplos-de-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="modelo-logístico-para-la-mortalidad-de-escarabajos" class="section level4 hasAnchor" number="6.4.4.1">
<h4><span class="header-section-number">6.4.4.1</span> modelo logístico para la mortalidad de escarabajos<a href="modelo-lineal-generalizado.html#modelo-logístico-para-la-mortalidad-de-escarabajos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Sea:
<span class="math display">\[
y_{ij} = \begin{cases}
1 &amp; \mbox{ si el escarabajo }j \mbox{ expuesto a la dosis }i\mbox{ muere,} \\
0 &amp; \mbox{ si lo contrario.}
\end{cases}
\]</span>
Por lo que, para <span class="math inline">\(i\)</span>-ésima dosis, el número de escarabajos que muere es igual a <span class="math inline">\(y^*_i=\sum_{j=1}^{n_i} y_{ij}\)</span>. Además, asumiendo independencia, podemos decir que:
<span class="math display">\[
y^*_i \sim \mbox{binomial} (n_{i},\pi_{i}), i=1,\ldots,n_i,
\]</span>
donde <span class="math inline">\(0 &lt; \pi_i &lt; 1\)</span> depende de la dosis. Definiendo <span class="math inline">\(y_{i}=y^*_i/n_{i}\)</span> (la proporción de escarabajos muertos para la dosis <span class="math inline">\(i\)</span>), tenemos que:
<span class="math display">\[
E(y_{i}| \mbox{dosis}_{i}) = \pi_{i} \mbox{ y }V(y_{i}|  \mbox{dosis}_{i}) = \pi_{i}(1-\pi_{i})/n_{i}.
\]</span></p>
<p>Dado que <span class="math inline">\(0 \leq \pi_i \leq 1\)</span>, se podría proponer que:
<span class="math display">\[
\pi_{i} = g^{-1}(\mbox{dosis},\boldsymbol \beta) =  \frac{\exp(\beta_0 + \log \ \mbox{dosis}_i\beta_1)}{1+\exp(\beta_0 + \log \ \mbox{dosis}_i\beta_1)} =\frac{\exp(\eta_i)}{1+\exp(\eta_i)}.
\]</span>
Por lo que <span class="math inline">\(g(\pi_{i}) = \log \left( \frac{\pi_{i}}{1-\pi_{i}}\right) = \eta_i\)</span>. Esta función recibe el nombre de función logit y su forma la podemos ver gráficamente en la Figura <a href="modelo-lineal-generalizado.html#fig:logfun">6.3</a>. Como vemos, está función está acotada entre <span class="math inline">\(0\)</span> y <span class="math inline">\(1\)</span>, garantizando que las probabilidades estimadas siempre estén en este rango, y tiene forma de ‘S’.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:logfun"></span>
<img src="MLG2_files/figure-html/logfun-1.png" alt="Función logística" width="576" />
<p class="caption">
Figure 6.3: Función logística
</p>
</div>
</div>
<div id="modelo-poisson-para-el-número-de-ataque-epilépticos" class="section level4 hasAnchor" number="6.4.4.2">
<h4><span class="header-section-number">6.4.4.2</span> modelo Poisson para el número de ataque epilépticos<a href="modelo-lineal-generalizado.html#modelo-poisson-para-el-número-de-ataque-epilépticos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Definiendo <span class="math inline">\(y_i\)</span> como el número de ataques epilépticos (<span class="math inline">\(\times\)</span> dos semanas) del paciente <span class="math inline">\(i\)</span> luego de 8 semanas de tratamiento, podemos suponer que:
<span class="math display">\[
y_{i}\sim \mbox{Poisson}(\lambda_{i}), \quad i=1,...,n,\quad \text{donde} \quad \lambda_{i}=g(\eta_i),
\]</span>
donde <span class="math inline">\(\eta_i = \beta_{0}+\beta_{1}\text{treat}_{i}+\beta_{2}\text{base}_{i}+\beta_{3}\text{base}_{i}\text{treat}_{i}.\)</span> Entonces, <span class="math inline">\(E(y_{i}|\boldsymbol x_{i})=V(y_{i}|\boldsymbol x_{i})=\lambda_{i}\)</span>. Dado que <span class="math inline">\(\lambda_ i &gt; 0\)</span>, se puede asumir que:
<span class="math display">\[
\lambda_{i}=g^{-1}(\eta_i)=\exp(\eta_i).
\]</span></p>
<p>Por lo que, <span class="math inline">\(g(\lambda_{i})=\log\lambda_{i}\)</span>. Este modelo puede ser una opción para estimar el número medio de ataques epiléticos de los pacientes del ensayo clínico en epilepsia.</p>
</div>
<div id="otros-ejemplos" class="section level4 hasAnchor" number="6.4.4.3">
<h4><span class="header-section-number">6.4.4.3</span> Otros ejemplos<a href="modelo-lineal-generalizado.html#otros-ejemplos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Un modelo lineal es un caso particular del GLM. Aquí asumimos que <span class="math inline">\(y_i \sim N(\mu_i, \sigma^2)\)</span>, con <span class="math inline">\(\mu_i = \boldsymbol x_i&#39;\boldsymbol \beta\)</span>. Es decir, la función de enlace es la identidad.</p>
<p>Otros ejemplos de distribuciones que se pueden utilizar son:</p>
<ul>
<li><strong>Modelo binomial-negativo</strong> para conteo con sobredispersión.</li>
<li><strong>Modelo beta-binomial</strong> para ensayos Bernoulli correlacionados (sobredispersión).</li>
<li><strong>Modelo multinomial</strong> para variables nominales (ordinales) con más de dos categorías.</li>
<li><strong>Modelo beta</strong> para proporciones.</li>
<li><strong>Modelo gamma</strong> para variables continuas asimétricas y con varianza creciente.</li>
<li><strong>Modelo Weibull</strong> para tiempos de falla.</li>
</ul>
</div>
</div>
</div>
<div id="ajuste-de-un-glm" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Ajuste de un GLM<a href="modelo-lineal-generalizado.html#ajuste-de-un-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Al igual que en los modelos lineales, los pasos para ajustar un GLM incluyen:</p>
<ul>
<li><p><strong>Especificación del modelo</strong>.Definición del componente aleatorio, predictor lineal y función de enlace.</p></li>
<li><p><strong>Estimación de los parámetros</strong>. Para los GLM, la estimación se hace por máxima verosimilitud.</p></li>
<li><p><strong>Evaluación del modelo</strong>. Verificar si el modelo estimado se ajusta bien a los datos.</p></li>
<li><p><strong>Inferencia</strong>. cálculo de intervalos de confianza, pruebas de hipótesis e interpretación de los resultados según los objetivos del estudio.</p></li>
</ul>
<div id="especificación-del-modelo" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Especificación del modelo<a href="modelo-lineal-generalizado.html#especificación-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El GLM asume que:</p>
<p><span class="math display">\[
f(y_{i};\theta_{i},\phi)=exp\left\{\frac{y_{i}\theta_{i}-b(\theta_{i})}{a(\phi)} +c(y_{i},\phi)\right\},
\]</span>
donde <span class="math inline">\(\phi&gt;0\)</span>. Además, <span class="math inline">\(E(y_{i})=b&#39;(\theta_{i})\)</span> y <span class="math inline">\(V(y_{i})=b&#39;&#39;(\theta_{i})a(\phi).\)</span></p>
<p>El <strong>predictor lineal</strong> <span class="math inline">\(\eta_{i}=\boldsymbol x&#39;_{i}\boldsymbol \beta\)</span> se relaciona con <span class="math inline">\(\mu_{i}\)</span> a través la <strong>función de enlace,</strong> <span class="math inline">\(\eta_{i}=g(\mu_{i})\)</span>.</p>
<p>La función de enlace <span class="math inline">\(g(\cdot)\)</span> que transforma <span class="math inline">\(\mu_{i}\)</span> en el parámetro natural <span class="math inline">\(\theta_{i}\)</span> es llamada <strong>función de enlace canónica.</strong> Por ejemplo para la distribución normal, <span class="math inline">\(\eta_{i}=\mu_{i}\)</span> (identidad), por lo tanto <span class="math inline">\(\mu_{i}=\eta_{i}\)</span>. Para la distribución Poisson, <span class="math inline">\(\eta_{i}=\log\mu_{i}\)</span>, por lo tanto <span class="math inline">\(\mu_{i}=\exp(\eta_{i})\)</span>. Para la distribución binomial, <span class="math inline">\(\eta_{i}=\log\left(\frac{\pi_{i}}{1-\pi_{i}}\right)\)</span>, por lo tanto <span class="math inline">\(\pi_{i}=\frac{\exp(\eta_{i})}{1+\exp(\eta_{i})}\)</span>.</p>
</div>
<div id="estimador-por-máxima-verosimilitud-para-boldsymbol-beta" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Estimador por máxima verosimilitud para <span class="math inline">\(\boldsymbol \beta\)</span><a href="modelo-lineal-generalizado.html#estimador-por-máxima-verosimilitud-para-boldsymbol-beta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>dado que asumimos que la distribución de probabilidad asociada a la variable resputa pertenece a la familia exponencial, la función de log-verosimilitud está definida como:
<span class="math display">\[
\ell(\boldsymbol \beta)=\sum_{i=1}^{n}\ell_{i}(\boldsymbol \beta)=\sum_{i=1}^{n}\log f(y_{i};\theta_{i},\phi)=\sum_{i=1}^{n}\left[\frac{y_{i}\theta_{i}-b(\theta_{i})}{a(\phi)}+c(y_{i},\phi)\right].
\]</span></p>
<p>Las funciones score están definidas como:</p>
<p><span class="math display">\[
u(\beta_{j})=\sum_{i=1}^{n}\frac{(y_{i}-\mu_{i})x_{ij}}{V(y_{i})}\frac{\partial\mu_{i}}{\partial\eta_{i}}=0, \quad \text{para} \quad j=0,...,p-1,
\]</span>
donde <span class="math inline">\(\eta_{i}=\boldsymbol x_{i}&#39;\boldsymbol \beta=g(\mu_{i})\)</span>. Dado que las funciones score son no-lineales, es necesario estimar <span class="math inline">\(\boldsymbol \beta\)</span> iterativamente usando el algoritmo de Newton-Raphson.</p>
<p>En forma matricial, tenemos que la función score es:
<span class="math display">\[
\boldsymbol u(\boldsymbol \beta)=\boldsymbol X&#39;\boldsymbol D\boldsymbol V^{-1}(\boldsymbol y-\boldsymbol \mu),
\]</span>
la función hessiana es:
<span class="math display">\[
\boldsymbol H(\boldsymbol \beta)=\boldsymbol I(\boldsymbol \beta)=\boldsymbol X&#39;\boldsymbol W\boldsymbol X,
\]</span>
donde <span class="math inline">\(\boldsymbol V\)</span> es una matriz diagonal con valores <span class="math inline">\(v_{ii}=V(y_{i})\)</span> en la diagonal, <span class="math inline">\(\boldsymbol D\)</span> es una matriz diagonal con valores <span class="math inline">\(d_{ii}=\frac{\partial\mu_{i}}{\partial\eta_{i}}\)</span>,y <span class="math inline">\(\boldsymbol W\)</span> es una matriz diagonal con <span class="math inline">\(w_{ii}=\frac{(\partial\mu_{i}/\partial\eta_{i})^2}{V(y_{i})}\)</span>.</p>
<p>A través del algoritmo de Newton-Raphson (o Fisher’s scoring) podemos encontrar la estimación de <span class="math inline">\(\boldsymbol \beta\)</span> de forma iterativa:
<span class="math display">\[
\boldsymbol \beta^{(t+1)}=\boldsymbol \beta^{(t)}+[\boldsymbol I(\boldsymbol \beta^{(t)})]^{-1}\boldsymbol u(\boldsymbol \beta^{(t)}).
\]</span>
Equivalentemente, podemos utilizar el <strong>método de mínimos cuadrados iterativamente reponderados:</strong></p>
<p><span class="math display">\[
\boldsymbol \beta^{(t+1)}=(\boldsymbol X&#39;\boldsymbol W^{(t)}\boldsymbol X)^{-1}\boldsymbol X&#39;\boldsymbol W^{(t)}\boldsymbol z^{(t)},
\]</span>
donde, los elementos de <span class="math inline">\(\boldsymbol z^{(t)}\)</span> son:</p>
<p><span class="math display">\[
z_{i}^{(t)}=\boldsymbol x_{i}&#39;\boldsymbol \beta^{(t)}+(y_{i}-\mu_{i}^{(t)})\frac{\partial\eta_{i}^{(t)}}{\partial \mu_{i}^{(t)}}.
\]</span></p>
<p>La distribución asintótica del MLE de <span class="math inline">\(\boldsymbol \beta\)</span> es:</p>
<p><span class="math display">\[
\widehat{\boldsymbol \beta}\sim N\left[\boldsymbol \beta,(\boldsymbol X&#39;\boldsymbol W\boldsymbol X)^{-1}\right].
\]</span>
#### ajuste e interpretación de parámetros del modelo logístico</p>
<p>Para los datos de mortalidad de escarabajos, tenemos el siguiente modelo:</p>
<p><span class="math display">\[
y_i^* \sim \mbox{binomial}(n_i,\pi_i), \mbox{ donde } \pi_{i}=\frac{\exp(\beta_0+\beta_1\log\ \text{dosis}_i)}{1+\exp(\beta_0+\beta_0\log\ \text{dosis}_i)}.
\]</span>
La estimación de los parámetros del GLM por MLE se puede hacer utilizando la función <code>glm()</code>. En esta función debemos determinar la distribución de probabilidad asociada a los datos y la función de enlace con el argumento <code>family</code>. Para el modelo logístico, usamos <code>family=binomial</code> (por defecto la función de enlace es logit):</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="modelo-lineal-generalizado.html#cb124-1" tabindex="-1"></a>modBin <span class="ot">=</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(dead,n<span class="sc">-</span>dead)<span class="sc">~</span>logdose,<span class="at">family=</span>binomial)</span>
<span id="cb124-2"><a href="modelo-lineal-generalizado.html#cb124-2" tabindex="-1"></a><span class="fu">summary</span>(modBin)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(dead, n - dead) ~ logdose, family = binomial)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -60.717      5.181  -11.72   &lt;2e-16 ***
## logdose       34.270      2.912   11.77   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 284.202  on 7  degrees of freedom
## Residual deviance:  11.232  on 6  degrees of freedom
## AIC: 41.43
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Aquí vemos que el efecto del logarítmo de la dosis es positivo y significativo. Es decir que, un incremento en la dosis significa un aumento en la probabidad de que el escarabajo muera. La relación la podemos ver de forma gráfica en la figura <a href="modelo-lineal-generalizado.html#fig:escarabajosEstFig">6.4</a>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="modelo-lineal-generalizado.html#cb126-1" tabindex="-1"></a>pred.x <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">logdose =</span> <span class="fu">seq</span>(<span class="fu">min</span>(logdose),<span class="fu">max</span>(logdose),<span class="at">length.out =</span> <span class="dv">50</span>))</span>
<span id="cb126-2"><a href="modelo-lineal-generalizado.html#cb126-2" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(modBin,pred.x,<span class="at">type=</span><span class="st">&#39;response&#39;</span>)</span>
<span id="cb126-3"><a href="modelo-lineal-generalizado.html#cb126-3" tabindex="-1"></a></span>
<span id="cb126-4"><a href="modelo-lineal-generalizado.html#cb126-4" tabindex="-1"></a><span class="fu">plot</span>(logdose,dead<span class="sc">/</span>n,<span class="at">xlab=</span><span class="st">&#39;log dosis de disulfuro de carbono gaseoso&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;proporción de escarabajos muertos&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb126-5"><a href="modelo-lineal-generalizado.html#cb126-5" tabindex="-1"></a><span class="fu">lines</span>(pred.x<span class="sc">$</span>logdose,pred,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:escarabajosEstFig"></span>
<img src="MLG2_files/figure-html/escarabajosEstFig-1.png" alt="Datos de mortalidad de escarabajos. Estimación de la probabilidad de que el escarabajo muera en función del logarítmo de la dosis de disulfuro de carbono gaseoso." width="576" />
<p class="caption">
Figure 6.4: Datos de mortalidad de escarabajos. Estimación de la probabilidad de que el escarabajo muera en función del logarítmo de la dosis de disulfuro de carbono gaseoso.
</p>
</div>
<p>La interpretación de los coeficientes del modelo logístico se hacen a través de los <strong>odds ratio</strong>. Primero, un <strong>odd</strong> está definido como:</p>
<p><span class="math display">\[
\mbox{odd}=\frac{P(Y=1)}{P(Y=0)}.
\]</span>
Es decir, es una razón entre la probabilidad de éxito sobre la probabilidad de fracaso. Por ejemplo, si el odd es igual a dos, estaríamos diciendo que la probabilidad de éxito es el doble de la probabilidad de fracaso. Para el caso del modelo logístico simple, tenemos que:</p>
<p><span class="math display">\[
\text{odd}(x)=\frac{P(Y=1|x)}{P(Y=0|x)}= \frac{\frac{\exp(\beta_0+x\beta_1)}{1+\exp(\beta_0+x\beta_1)}}{1-\frac{\exp(\beta_0+x\beta_1)}{1+\exp(\beta_0+x\beta_1)}} = \exp(\beta_0+x\beta_1).
\]</span></p>
<p>Ahora, los <strong>odds ratio</strong> están definido como <span class="math inline">\(\text{OR}=\frac{\text{odd}(x=a+1)}{\text{odd}(x=a)}\)</span>. Para el caso del modelo logístico simple temos que el OR es:</p>
<p><span class="math display">\[
\mbox{OR}(x)=\frac{\text{odd}(x=a+1)}{\text{odd}(x=a)}=\frac{\exp\left[\beta_{0}+(a+1)\beta_{1}\right]}{\exp(\beta_0+a\beta_1)}=\exp(\beta_1).
\]</span></p>
<p>Por lo tanto, por cada cambio unitario en <span class="math inline">\(x\)</span>, los odds de morir incrementan por un factor de <span class="math inline">\(exp(\beta_1)\)</span>. Por un cambio en <span class="math inline">\(x\)</span> de <span class="math inline">\(a\)</span> a <span class="math inline">\(a+\delta\)</span>, tenemos que <span class="math inline">\(OR=\exp(\delta\beta_1)\)</span>.</p>
<p>Para los datos de los escarabajos un cambio unitario en el log dosis es muy grande, por lo que podríamos interpetra <span class="math inline">\(\beta_1\)</span> usando un aumento en la log dosis mas pequeño, por ejemplo de <span class="math inline">\(\delta=0.02\)</span>:</p>
<p><span class="math display">\[
\exp ( 0.02\times  34.270) = 1.984.
5.
\]</span>
Es decir, si el log de la concentración de aumenta en <span class="math inline">\(0.02\)</span>, entonces la probabilidad de que el escarabajo muera aumenta casi el doble.</p>
<div id="ajuste-e-interpretación-de-parámetros-del-modelo-poisson" class="section level4 hasAnchor" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> ajuste e interpretación de parámetros del modelo Poisson<a href="modelo-lineal-generalizado.html#ajuste-e-interpretación-de-parámetros-del-modelo-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para el ensayo clínico en epilepsia, el modelo propuesto es:
<span class="math display">\[
y_i \sim \mbox{Poisson}(\lambda_i), \mbox{ donde } \lambda_i=\exp(\beta_0+\beta_1\text{treat}_i+\beta_2\text{base}_i+\beta_2\text{base}_i\text{treat}_i).
\]</span>
Para el ajuste del modelo usamos la función <code>glm()</code> con el argumento <code>family=poisson</code>:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="modelo-lineal-generalizado.html#cb127-1" tabindex="-1"></a>modPois<span class="ot">=</span><span class="fu">glm</span>(seizure.rate<span class="sc">~</span>treatment<span class="sc">+</span>base<span class="sc">+</span>base<span class="sc">:</span>treatment,<span class="at">family=</span>poisson,</span>
<span id="cb127-2"><a href="modelo-lineal-generalizado.html#cb127-2" tabindex="-1"></a>            <span class="at">data =</span>epilepsy4)</span>
<span id="cb127-3"><a href="modelo-lineal-generalizado.html#cb127-3" tabindex="-1"></a><span class="fu">summary</span>(modPois)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = seizure.rate ~ treatment + base + base:treatment, 
##     family = poisson, data = epilepsy4)
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              1.2453159  0.1176157  10.588   &lt;2e-16 ***
## treatmentProgabide      -0.3635857  0.1624995  -2.237   0.0253 *  
## base                     0.0209356  0.0019144  10.936   &lt;2e-16 ***
## treatmentProgabide:base  0.0008523  0.0022778   0.374   0.7083    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 476.25  on 58  degrees of freedom
## Residual deviance: 149.54  on 55  degrees of freedom
## AIC: 345.3
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Los resultados del ajuste muestran que el número de ataques pre-tratamiento tiene un efecto positivo sobre la media del número de ataques epilépticos. Es decir, esta aumenta entre más ataques previos tenga el paciente. Mientras que, el tratamiento parece tener un efecto negativo. Es decir, el prograbide reduce la media del número de ataques epilépticos con respecto al placebo. Finalmente, el efecto interacción es muy pequeño sugiriendo que el efecto del tratamiento no se ve afectado por la frecuencia de los ataques epilépticos que tiene el paciente. La estimación de la media se puede observa de forma gráfica en la Figura <a href="modelo-lineal-generalizado.html#fig:ajusteSeizureFig">6.5</a>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="modelo-lineal-generalizado.html#cb129-1" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">base=</span><span class="fu">seq</span>(<span class="fu">min</span>(epilepsy4<span class="sc">$</span>base),<span class="fu">max</span>(epilepsy4<span class="sc">$</span>base),<span class="at">length.out=</span><span class="dv">100</span>),</span>
<span id="cb129-2"><a href="modelo-lineal-generalizado.html#cb129-2" tabindex="-1"></a>               <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">levels</span>(epilepsy4<span class="sc">$</span>treatment)))</span>
<span id="cb129-3"><a href="modelo-lineal-generalizado.html#cb129-3" tabindex="-1"></a>predpois <span class="ot">=</span> <span class="fu">predict</span>(modPois,y,<span class="at">type=</span><span class="st">&#39;response&#39;</span>)</span>
<span id="cb129-4"><a href="modelo-lineal-generalizado.html#cb129-4" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">min</span>(epilepsy4<span class="sc">$</span>base),<span class="fu">max</span>(epilepsy4<span class="sc">$</span>base),<span class="at">length.out=</span><span class="dv">50</span>)</span>
<span id="cb129-5"><a href="modelo-lineal-generalizado.html#cb129-5" tabindex="-1"></a></span>
<span id="cb129-6"><a href="modelo-lineal-generalizado.html#cb129-6" tabindex="-1"></a><span class="fu">plot</span>(seizure.rate<span class="sc">~</span>base, <span class="at">col=</span>treatment, <span class="at">pch=</span><span class="dv">16</span>,<span class="at">data=</span>epilepsy4,</span>
<span id="cb129-7"><a href="modelo-lineal-generalizado.html#cb129-7" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;ataques pre-tratamiento (x 4 semanas)&quot;</span>,</span>
<span id="cb129-8"><a href="modelo-lineal-generalizado.html#cb129-8" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;ataques post-tratamiento (x 2 semanas)&quot;</span>)</span>
<span id="cb129-9"><a href="modelo-lineal-generalizado.html#cb129-9" tabindex="-1"></a><span class="fu">lines</span>(x,predpois[<span class="fu">order</span>(y<span class="sc">$</span>treatment, y<span class="sc">$</span>base)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]], <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb129-10"><a href="modelo-lineal-generalizado.html#cb129-10" tabindex="-1"></a><span class="fu">lines</span>(x,predpois[<span class="fu">order</span>(y<span class="sc">$</span>treatment, y<span class="sc">$</span>base)[<span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>]],<span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ajusteSeizureFig"></span>
<img src="MLG2_files/figure-html/ajusteSeizureFig-1.png" alt="Datos de epilepsia. Estimación de la media de ataques epilépticos (por dos semanas) luego de cuatro semanas de tratamiento. La línea negra representa la media de ataques para el grupo placebo, mientras que, la linea roja la media de ataques para el tratamiento con Progabide." width="576" />
<p class="caption">
Figure 6.5: Datos de epilepsia. Estimación de la media de ataques epilépticos (por dos semanas) luego de cuatro semanas de tratamiento. La línea negra representa la media de ataques para el grupo placebo, mientras que, la linea roja la media de ataques para el tratamiento con Progabide.
</p>
</div>
<p>En el modelo Poisson simple, tenemos que <span class="math inline">\(E(Y|x)=\exp(\beta_0+x\beta_1)\)</span>. Si aumentamos a <span class="math inline">\(x\)</span> en <span class="math inline">\(\delta\)</span> unidades, tenemos que <span class="math inline">\(E(Y|x+\delta)=\exp(\beta_0+(x+\delta)\beta_1)\)</span>. Ahora si calculamos el logaritmo de la razón de los valores esperados obtenemos que:</p>
<p><span class="math display">\[
\log\left[\frac{E(Y|x=a+\delta)}{E(Y|x=a)}\right]=\delta\beta_1.
\]</span></p>
<p>Por lo tanto, <span class="math inline">\(\exp(\delta\beta_1)=\frac{E(Y|x=a+\delta)}{E(Y|x=a)}\)</span>. Es decir que, <span class="math inline">\(\exp(\delta\beta_1)\)</span> es una tasa de crecimiento del valor esperado de <span class="math inline">\(Y\)</span> por un aumento en <span class="math inline">\(x\)</span> de <span class="math inline">\(\delta\)</span> unidades.</p>
<p>Por ejemplo, si el número de ataques epilépticos pre-tratamiento aumenta <span class="math inline">\(20\)</span> casos, entonces el valor esperado de ataques epilépticos post-tramiento aumenta un 52% <span class="math inline">\((\exp(20 \times0.021)=1.522)\)</span>. Además, el tramiento con Progabida reduce en un poco más del 40% el número de episodios de epilepsia <span class="math inline">\((\exp(-0.3635857) = 0.695)\)</span>. Finalmente, el efecto de los casos pre-tramiento es el mismo para los pacientes en el grupo tratamiento y el control (<span class="math inline">\(\exp(0.0009) \approx 1\)</span>).</p>
</div>
</div>
</div>
<div id="pruebas-de-hipótesis" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Pruebas de hipótesis<a href="modelo-lineal-generalizado.html#pruebas-de-hipótesis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Al igual que en los modelos lineales, uno puede estar interesado en realizar pruebas hipótesis sobre los coeficientes del modelo. Por ejemplo, en el estudio sobre epilépsia estamos interesados en evaluar si hay un efecto significativo del tratamiento sobre los ataques epilépticos. Esto es:
<span class="math display">\[
\qquad H_0:\beta_1=\beta_3=0.
\]</span>
Si rechazamos <span class="math inline">\(H_0\)</span> podemos concluir que el tratamiento con Progabida tiene un efecto sobre el número de ataques epilépticos. Particularmente, si <span class="math inline">\(\beta_1 &lt; 0\)</span>, este fármaco reduce los episodios.</p>
<p>Suponga que tenemos un modelo con el siguiente predictor lineal:
<span class="math display">\[
\eta = \boldsymbol x_{1}&#39;\boldsymbol \beta_1+\boldsymbol x_{2}&#39;\boldsymbol \beta_2,
\]</span>
donde <span class="math inline">\(\boldsymbol x_{1 }= (1,x_{11},\ldots,x_{1,q-1})&#39;\)</span> y <span class="math inline">\(\boldsymbol x_{2}= (1,x_{21},\ldots,x_{2,p-q})&#39;\)</span> son vectores de covariables; <span class="math inline">\(\boldsymbol \beta_1\)</span> y <span class="math inline">\(\boldsymbol \beta_2\)</span> son vectores de coeficientes de dimensiones <span class="math inline">\(q\)</span> y <span class="math inline">\(p-q\)</span>, respetivamente. Ahora, planteamos el siguiente sistema de hipótesis:
<span class="math display">\[
\qquad H_0:\boldsymbol \beta_2=\boldsymbol 0\qquad H_1:\boldsymbol \beta_2 \ne \boldsymbol 0.
\]</span>
Para estimadores basados en verosimilitud, podemos utilizar tres métodos diferentes: la prueba de razón de verosimilitud, la prueba del score o la prueba de Wald.</p>
<div id="método-de-razón-de-verosimilitud" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Método de razón de verosimilitud<a href="modelo-lineal-generalizado.html#método-de-razón-de-verosimilitud" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La idea de este método es comparar la verosimilitud bajo dos condiciones: (<span class="math inline">\(L_0\)</span>) la máxima alcanzada bajo <span class="math inline">\(H_0\)</span> (es decir, asumiendo que <span class="math inline">\(\boldsymbol \beta_2=\boldsymbol 0\)</span>) y (<span class="math inline">\(L_1\)</span>) la evaluada en la estimación maximo verosimil, es decir <span class="math inline">\(L(\widehat{\boldsymbol \beta})\)</span>. El estadístico de prueba usado es:
<span class="math display">\[
LR = 2\log \left( \frac{L(\widehat{\boldsymbol \beta})}{L(\widehat{\boldsymbol \beta}_0)} \right) = 2 (\ell_1 - \ell_0).
\]</span>
Asumiendo que <span class="math inline">\(H_0\)</span> es cierta, asintóticamente tenemos que <span class="math inline">\(LR \sim \chi^{2}_{p-q}\)</span>. Por lo que, rechazamos <span class="math inline">\(H_0\)</span> con un nivel de significancia de <span class="math inline">\(\alpha\)</span>, si <span class="math inline">\(LR &gt; \chi^{2}_{1-\alpha,p-q}\)</span>.</p>
</div>
<div id="método-de-wald" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Método de Wald<a href="modelo-lineal-generalizado.html#método-de-wald" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Asintóticamente, tenemos que <span class="math inline">\(\widehat{\boldsymbol \beta}\sim N[\boldsymbol \beta,\boldsymbol I(\boldsymbol \beta)^{-1}]\)</span>. por lo tanto se tiene que:
<span class="math display">\[
(\hat{\boldsymbol \beta}-\boldsymbol \beta)&#39;\boldsymbol I(\boldsymbol \beta)(\hat{\boldsymbol \beta}-\boldsymbol \beta)\sim\chi^2_{p}.
\]</span>
Entonces, para probar <span class="math inline">\(H_0: \boldsymbol \beta_2 = \boldsymbol \beta_2^{0}\)</span>, se puede utilizar el siguiente estadístico de prueba:
<span class="math display">\[
W = \left(\widehat{\boldsymbol \beta}_2-\boldsymbol \beta_2^{0}\right)&#39;\left[V\left(\widehat{\boldsymbol \beta}_2\right)\right]^{-1}\left(\widehat{\boldsymbol \beta}_2-\boldsymbol \beta_2^0\right).
\]</span>
Si <span class="math inline">\(H_0\)</span> es cierta, entonces <span class="math inline">\(W \sim \chi^2_{p-q}\)</span>. Por lo que, rechazamos <span class="math inline">\(H_0\)</span> con un nivel de significancia de <span class="math inline">\(\alpha\)</span>, si <span class="math inline">\(W &gt; \chi^{2}_{1-\alpha,p-q}\)</span>.</p>
<div id="ejemplo-ataques-epilépticos" class="section level4 hasAnchor" number="6.6.2.1">
<h4><span class="header-section-number">6.6.2.1</span> Ejemplo ataques epilépticos<a href="modelo-lineal-generalizado.html#ejemplo-ataques-epilépticos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En este caso, podríamos plantear el siguiente sistema de hipótesis:
<span class="math display">\[
\qquad H_0:\beta_1=\beta_3=0 \qquad H_1: \beta_1=0 \mbox{ o } \beta_3=0.
\]</span>
Es decir, <span class="math inline">\(H_0\)</span> indica que no hay ningún efecto del tratamiento para la epilépsia (no es estadísticamente diferente al placebo). La prueba de razón de verosimilitud se puede implementar de las siguiente forma:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="modelo-lineal-generalizado.html#cb130-1" tabindex="-1"></a>modPois0<span class="ot">=</span><span class="fu">glm</span>(seizure.rate<span class="sc">~</span>base,<span class="at">family=</span>poisson,</span>
<span id="cb130-2"><a href="modelo-lineal-generalizado.html#cb130-2" tabindex="-1"></a>            <span class="at">data =</span>epilepsy4)</span>
<span id="cb130-3"><a href="modelo-lineal-generalizado.html#cb130-3" tabindex="-1"></a><span class="fu">anova</span>(modPois0,modPois,<span class="at">test=</span><span class="st">&#39;LRT&#39;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: seizure.rate ~ base
## Model 2: seizure.rate ~ treatment + base + base:treatment
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)   
## 1        57     159.94                        
## 2        55     149.54  2   10.405 0.005502 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Este resultado, complementado con los anteriores, sugiere que hay un efecto del tratamiento. Es decir, el Progabida tiene un efecto significativo para reducir los ataques epilépticos.</p>
<p>La prueba de Wald la podemos implementar de la siguiente forma:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="modelo-lineal-generalizado.html#cb132-1" tabindex="-1"></a><span class="fu">library</span>(aod)</span>
<span id="cb132-2"><a href="modelo-lineal-generalizado.html#cb132-2" tabindex="-1"></a>VarMat <span class="ot">=</span> <span class="fu">vcov</span>(modPois)</span>
<span id="cb132-3"><a href="modelo-lineal-generalizado.html#cb132-3" tabindex="-1"></a>Coef <span class="ot">=</span> <span class="fu">coefficients</span>(modPois)</span>
<span id="cb132-4"><a href="modelo-lineal-generalizado.html#cb132-4" tabindex="-1"></a><span class="fu">wald.test</span>(VarMat,Coef,<span class="at">Terms=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## Wald test:
## ----------
## 
## Chi-squared test:
## X2 = 10.3, df = 2, P(&gt; X2) = 0.0057</code></pre>
<p>Estos resultados son similares a los observados con la prueba de razón de verosimilitud y llegamos a la misma conclusión.</p>
</div>
</div>
</div>
<div id="intervalos-de-confianza" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> intervalos de confianza<a href="modelo-lineal-generalizado.html#intervalos-de-confianza" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A partir de los estadísticos de prueba anteriores se pueden encontrar intervalos de confianza para <span class="math inline">\(\boldsymbol \beta\)</span>. Por ejemplo usando el estadístico de Wald:</p>
<p><span class="math display">\[
\widehat{\beta}_j\pm z_{\alpha/2}\sqrt{V(\widehat{\beta}_j)}.
\]</span></p>
<p>Otra alternativa es a partir de los perfiles de log-verosimilitud, el intervalo del <span class="math inline">\((1-\alpha)\)</span>% de confianza para <span class="math inline">\(\beta_j\)</span> está definido a partir de los valores de <span class="math inline">\(\beta^0_j\)</span> que satisfacen:</p>
<p><span class="math display">\[
-2[\ell(\widehat{\boldsymbol \beta})-\ell(\widehat{\boldsymbol \beta}^{0})]&lt;\chi^2_{1-\alpha,1},
\]</span></p>
<p>donde <span class="math inline">\(\ell(\widehat{\boldsymbol \beta}^{0})\)</span> es la log-verosimilitud donde <span class="math inline">\(\beta_j\)</span> está restringido a los valores de <span class="math inline">\(\beta_j^0\)</span>.</p>
<div id="intervalo-de-confianza-para-la-media" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Intervalo de confianza para la media<a href="modelo-lineal-generalizado.html#intervalo-de-confianza-para-la-media" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dado que <span class="math inline">\(\widehat{\eta}_0=\boldsymbol x_0&#39;\widehat{\boldsymbol \beta}\)</span> ,por lo tanto (asintóticamente):</p>
<p><span class="math display">\[
\widehat{\eta}_0\sim N[\boldsymbol x_0&#39;\boldsymbol \beta,\boldsymbol x_0&#39;\boldsymbol I(\boldsymbol \beta)^{-1}\boldsymbol x_0].
\]</span></p>
<p>Entonces un intervalo de confianza para <span class="math inline">\(\eta_0\)</span> es:</p>
<p><span class="math display">\[
\widehat{\eta}_0\pm z_{\alpha/2}\sqrt{\boldsymbol x_0&#39;I(\widehat{\boldsymbol \beta})^{-1}\boldsymbol x_0}.
\]</span></p>
<p>Para encontrar el intervalo de confianza para <span class="math inline">\(\mu_i\)</span>, se hace la transformación <span class="math inline">\(g^{-1}\)</span> a los límites de confianza.</p>
<div id="ejemplo-mortalidad-de-escarabajos" class="section level4 hasAnchor" number="6.7.1.1">
<h4><span class="header-section-number">6.7.1.1</span> Ejemplo mortalidad de escarabajos<a href="modelo-lineal-generalizado.html#ejemplo-mortalidad-de-escarabajos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La estimación de la probabilidad de que el escarabajo muera se puede observar en la Figura <a href="modelo-lineal-generalizado.html#fig:grafICesc">6.6</a>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="modelo-lineal-generalizado.html#cb134-1" tabindex="-1"></a>pred.link <span class="ot">=</span> <span class="fu">predict</span>(modBin,<span class="at">newdata =</span> pred.x,<span class="at">type=</span><span class="st">&#39;link&#39;</span>,<span class="at">se.fit =</span> T)</span>
<span id="cb134-2"><a href="modelo-lineal-generalizado.html#cb134-2" tabindex="-1"></a>lim.sup <span class="ot">=</span> faraway<span class="sc">::</span><span class="fu">ilogit</span>(pred.link<span class="sc">$</span>fit <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>pred.link<span class="sc">$</span>se.fit)</span>
<span id="cb134-3"><a href="modelo-lineal-generalizado.html#cb134-3" tabindex="-1"></a>lim.inf <span class="ot">=</span> faraway<span class="sc">::</span><span class="fu">ilogit</span>(pred.link<span class="sc">$</span>fit <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>pred.link<span class="sc">$</span>se.fit)</span>
<span id="cb134-4"><a href="modelo-lineal-generalizado.html#cb134-4" tabindex="-1"></a></span>
<span id="cb134-5"><a href="modelo-lineal-generalizado.html#cb134-5" tabindex="-1"></a><span class="fu">plot</span>(logdose,dead<span class="sc">/</span>n,<span class="at">xlab=</span><span class="st">&#39;log dosis&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;proporción de escarabajos muertos&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb134-6"><a href="modelo-lineal-generalizado.html#cb134-6" tabindex="-1"></a><span class="fu">lines</span>(pred.x<span class="sc">$</span>logdose,pred)</span>
<span id="cb134-7"><a href="modelo-lineal-generalizado.html#cb134-7" tabindex="-1"></a></span>
<span id="cb134-8"><a href="modelo-lineal-generalizado.html#cb134-8" tabindex="-1"></a><span class="fu">lines</span>(pred.x<span class="sc">$</span>logdose,lim.sup, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb134-9"><a href="modelo-lineal-generalizado.html#cb134-9" tabindex="-1"></a><span class="fu">lines</span>(pred.x<span class="sc">$</span>logdose,lim.inf, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grafICesc"></span>
<img src="MLG2_files/figure-html/grafICesc-1.png" alt="Datos de mortalidad de escarabajos. Intervalo del 95% de confianza para la probabilidad de que el escarabajo muera." width="576" />
<p class="caption">
Figure 6.6: Datos de mortalidad de escarabajos. Intervalo del 95% de confianza para la probabilidad de que el escarabajo muera.
</p>
</div>
</div>
<div id="ataques-epilépticos" class="section level4 hasAnchor" number="6.7.1.2">
<h4><span class="header-section-number">6.7.1.2</span> Ataques epilépticos<a href="modelo-lineal-generalizado.html#ataques-epilépticos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Los intervalos del 95% de confianza para los parámetros del modelo son:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="modelo-lineal-generalizado.html#cb135-1" tabindex="-1"></a><span class="fu">confint</span>(modPois)</span></code></pre></div>
<pre><code>##                                2.5 %       97.5 %
## (Intercept)              1.009325667  1.470661654
## treatmentProgabide      -0.682237759 -0.044653101
## base                     0.017137251  0.024649428
## treatmentProgabide:base -0.003594654  0.005341111</code></pre>
<p>Aquí vemos que el efecto del tratamiento está entre <span class="math inline">\(-0.7\)</span> y <span class="math inline">\(-0.04\)</span>. Es decir, que la reducción del número de ataques epilépticos está a una tasa entre el 0.51 y 0.95. Mientras que, como ya se mencionó antes, el efecto interacción no tiene un aporte significativo.</p>
<p>La media del número de ataques epiléptico por dos semanas se puede observar en la Figura <a href="modelo-lineal-generalizado.html#fig:grafICepilep">6.7</a>. Se puede observar que las estimaciones de la media para el grupo tratamiento es inferior que para el grupo control.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="modelo-lineal-generalizado.html#cb137-1" tabindex="-1"></a>predx1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">base=</span><span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">151</span>,<span class="at">length.out =</span> <span class="dv">100</span>),<span class="at">treatment=</span><span class="st">&#39;placebo&#39;</span>)</span>
<span id="cb137-2"><a href="modelo-lineal-generalizado.html#cb137-2" tabindex="-1"></a>predx2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">base=</span><span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">151</span>,<span class="at">length.out =</span> <span class="dv">100</span>),<span class="at">treatment=</span><span class="st">&#39;Progabide&#39;</span>)</span>
<span id="cb137-3"><a href="modelo-lineal-generalizado.html#cb137-3" tabindex="-1"></a>predy1 <span class="ot">=</span> <span class="fu">predict</span>(modPois,<span class="at">newdata =</span> predx1,<span class="at">type=</span><span class="st">&#39;response&#39;</span>)</span>
<span id="cb137-4"><a href="modelo-lineal-generalizado.html#cb137-4" tabindex="-1"></a>predy2 <span class="ot">=</span> <span class="fu">predict</span>(modPois,<span class="at">newdata =</span> predx2,<span class="at">type=</span><span class="st">&#39;response&#39;</span>)</span>
<span id="cb137-5"><a href="modelo-lineal-generalizado.html#cb137-5" tabindex="-1"></a>predy1Link <span class="ot">=</span> <span class="fu">predict</span>(modPois,<span class="at">newdata =</span> predx1,<span class="at">type=</span><span class="st">&#39;link&#39;</span>,<span class="at">se.fit =</span> T)</span>
<span id="cb137-6"><a href="modelo-lineal-generalizado.html#cb137-6" tabindex="-1"></a>predy2Link <span class="ot">=</span> <span class="fu">predict</span>(modPois,<span class="at">newdata =</span> predx2,<span class="at">type=</span><span class="st">&#39;link&#39;</span>,<span class="at">se.fit =</span> T)</span>
<span id="cb137-7"><a href="modelo-lineal-generalizado.html#cb137-7" tabindex="-1"></a>lwr1 <span class="ot">=</span> <span class="fu">exp</span>(predy1Link<span class="sc">$</span>fit <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>predy1Link<span class="sc">$</span>se.fit)</span>
<span id="cb137-8"><a href="modelo-lineal-generalizado.html#cb137-8" tabindex="-1"></a>upr1 <span class="ot">=</span> <span class="fu">exp</span>(predy1Link<span class="sc">$</span>fit <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>predy1Link<span class="sc">$</span>se.fit)</span>
<span id="cb137-9"><a href="modelo-lineal-generalizado.html#cb137-9" tabindex="-1"></a>lwr2 <span class="ot">=</span> <span class="fu">exp</span>(predy2Link<span class="sc">$</span>fit <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>predy2Link<span class="sc">$</span>se.fit)</span>
<span id="cb137-10"><a href="modelo-lineal-generalizado.html#cb137-10" tabindex="-1"></a>upr2 <span class="ot">=</span> <span class="fu">exp</span>(predy2Link<span class="sc">$</span>fit <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>predy2Link<span class="sc">$</span>se.fit)</span>
<span id="cb137-11"><a href="modelo-lineal-generalizado.html#cb137-11" tabindex="-1"></a><span class="fu">plot</span>(epilepsy4<span class="sc">$</span>base,epilepsy4<span class="sc">$</span>seizure.rate,</span>
<span id="cb137-12"><a href="modelo-lineal-generalizado.html#cb137-12" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&#39;# ataques epilépticos (4ta semana)&#39;</span>,</span>
<span id="cb137-13"><a href="modelo-lineal-generalizado.html#cb137-13" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&#39;# ataques epilépticos (pre tratamiento)&#39;</span>,</span>
<span id="cb137-14"><a href="modelo-lineal-generalizado.html#cb137-14" tabindex="-1"></a><span class="at">col=</span><span class="fu">as.double</span>(epilepsy4<span class="sc">$</span>treatment))</span>
<span id="cb137-15"><a href="modelo-lineal-generalizado.html#cb137-15" tabindex="-1"></a><span class="fu">lines</span>(predx1<span class="sc">$</span>base,predy1,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb137-16"><a href="modelo-lineal-generalizado.html#cb137-16" tabindex="-1"></a><span class="fu">lines</span>(predx1<span class="sc">$</span>base,predy2,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb137-17"><a href="modelo-lineal-generalizado.html#cb137-17" tabindex="-1"></a><span class="fu">lines</span>(predx1<span class="sc">$</span>base,lwr1,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb137-18"><a href="modelo-lineal-generalizado.html#cb137-18" tabindex="-1"></a><span class="fu">lines</span>(predx1<span class="sc">$</span>base,upr1,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb137-19"><a href="modelo-lineal-generalizado.html#cb137-19" tabindex="-1"></a><span class="fu">lines</span>(predx2<span class="sc">$</span>base,lwr2,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb137-20"><a href="modelo-lineal-generalizado.html#cb137-20" tabindex="-1"></a><span class="fu">lines</span>(predx2<span class="sc">$</span>base,upr2,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:grafICepilep"></span>
<img src="MLG2_files/figure-html/grafICepilep-1.png" alt="Datos de epilépsia. Estimación de la media de ataques epilépticos por dos semanas en el grupo placebo (línea negra) y el grupo tratamiento (línea roja)." width="576" />
<p class="caption">
Figure 6.7: Datos de epilépsia. Estimación de la media de ataques epilépticos por dos semanas en el grupo placebo (línea negra) y el grupo tratamiento (línea roja).
</p>
</div>
</div>
</div>
</div>
<div id="devianza" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Devianza<a href="modelo-lineal-generalizado.html#devianza" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considere un GLM con observaciones <span class="math inline">\(\boldsymbol y_i=(y_1,...,y_n)\)</span>. Sea <span class="math inline">\(ℓ(\widehat{\boldsymbol \mu})\)</span> la log-verosimilitud (expresada en función de <span class="math inline">\(\boldsymbol \mu\)</span>) evaluada en el MLE. La máxima verosimilitud que se puede alcanzar corresponde a <span class="math inline">\(ℓ(\boldsymbol y)\)</span> (un modelo con ajuste perfecto <span class="math inline">\(y_i=\mu_i\)</span>). A este último se le conoce como el <strong>modelo saturado.</strong> La Devianza compara el modelo propuesto contra el modelo saturado de la siguiente manera:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
D &amp;=- 2 \log \left[ \frac{L(\widehat{\boldsymbol \mu})}{L(\boldsymbol y)} \right] = -2[\ell(\hat{\boldsymbol \mu})-\ell(\boldsymbol y)] \\
&amp;=  2\sum_{i=1}^n[y_i\widetilde{\theta}_i-b(\widetilde{\theta}_i)]/a(\phi) - \sum_{i=1}^n[y_i\widehat{\theta_i}-b(\widehat{\theta_i})]/a(\phi),
\end{split}
\end{equation}\]</span>
donde <span class="math inline">\(\widetilde{\theta}_i\)</span> corresponde a la estimación de <span class="math inline">\(\theta_i\)</span> en el modelo saturado <span class="math inline">\((\widetilde{\mu}_i=y_i)\)</span>. Dado que, <span class="math inline">\(\ell(\boldsymbol y) \geq \ell(\hat{\boldsymbol \mu})\)</span>, entonces <span class="math inline">\(D \geq 0\)</span>. Por lo que, si el ajuste propuesto es pobre, se espera que <span class="math inline">\(D\)</span> sea grande.</p>
<p><strong>Modelo binomial:</strong>
Para el modelo binomial, la devianza está determinada por:
<span class="math display">\[
D=2\sum_{i=1}^n\left[y_i\log \left(\frac{y_i}{\widehat{\mu}_i}\right)+(n_i-y_i)\log\left(\frac{n_i-y_i}{n_i-\widehat{\mu}_i}\right)\right],
\]</span></p>
<p>donde <span class="math inline">\(\widehat{\mu}_i=n_i\widehat{\pi}_i.\)</span></p>
<p><strong>Modelo Poisson:</strong>
Para el modelo Poisson, la devianza está definida como:
<span class="math display">\[
D=2\sum_{i=1}^ny_i\log\left(\frac{y_i}{\widehat{\mu}_i}\right), \quad \text{donde} \quad \widehat{\mu}_i=\widehat{\lambda}_i.
\]</span></p>
<p><strong>Modelo normal:</strong>
Mientras que, para el modelo lineal es:
<span class="math display">\[
D=2\sum_{i=1}^n\left(y_i-\widehat{\mu}_i\right)^2.
\]</span></p>
<div id="el-estadístico-chi-cuadrado-de-pearson" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> El estadístico chi-cuadrado de Pearson<a href="modelo-lineal-generalizado.html#el-estadístico-chi-cuadrado-de-pearson" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Otro indicador de calidad del modelo es el estadístico chi-cuadrado de Pearson, definido como:</p>
<p><span class="math display">\[
X^2=\sum_{i=1}^n\frac{\left(y_i-\widehat{\mu}_i\right)^2}{v(\widehat{\mu}_i)}.
\]</span>
Para el modelo binomial, tenemos que:
<span class="math display">\[
X^2=\sum_{i=1}^n\frac{(y_i-n_i\hat{\pi}_i)^2}{n_i\hat{\pi}_i(1-\hat{\pi})}.
\]</span></p>
<p>Para el modelo Poisson es:
<span class="math display">\[
X^2=\sum_{i=1}^n\frac{(y_i-\widehat{\mu}_i)^2}{\widehat{\mu}_i}.
\]</span></p>
</div>
</div>
<div id="bondad-de-ajuste" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Bondad de ajuste<a href="modelo-lineal-generalizado.html#bondad-de-ajuste" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tanto <span class="math inline">\(D\)</span> como <span class="math inline">\(X^2\)</span> se pueden utilizar para evaluar la bondad del ajuste. Por lo que se podría plantear las siguientes hipótesis: <span class="math inline">\(H_0\)</span> indica que el modelo ajusta bien a los datos, y <span class="math inline">\(H_1\)</span> lo contrario. Por ejemplo, en el caso de un modelo logístico:</p>
<p><span class="math display">\[
H_0:\mbox{logit}(\pi_i)=\x_i\boldsymbol \beta.
\]</span></p>
<p>Si <span class="math inline">\(H_0\)</span> es cierta, entonces <span class="math inline">\(D\)</span> y <span class="math inline">\(X_2\)</span> siguen una distribución <span class="math inline">\(\chi_2\)</span> con <span class="math inline">\((n - p)\)</span> grados de libertadad. Sin embargo, está aproximación es buena solo si se cuenta con datos agrupados.</p>
<p><strong>Mortalidad de escarabajos</strong>
Para el modelo de mortalidad de escarabajos, los valores de la devianza y el <span class="math inline">\(\chi^2\)</span> de Pearson son:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="modelo-lineal-generalizado.html#cb138-1" tabindex="-1"></a><span class="co"># devianza</span></span>
<span id="cb138-2"><a href="modelo-lineal-generalizado.html#cb138-2" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">deviance</span>(modBin)</span>
<span id="cb138-3"><a href="modelo-lineal-generalizado.html#cb138-3" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(D,<span class="dv">6</span>) <span class="co"># valor p</span></span></code></pre></div>
<pre><code>## [1] 0.08145881</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="modelo-lineal-generalizado.html#cb140-1" tabindex="-1"></a><span class="co"># chi-cuadrado de Pearson</span></span>
<span id="cb140-2"><a href="modelo-lineal-generalizado.html#cb140-2" tabindex="-1"></a>X2 <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modBin,<span class="at">type=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb140-3"><a href="modelo-lineal-generalizado.html#cb140-3" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(X2,<span class="dv">6</span>) <span class="co"># valor p</span></span></code></pre></div>
<pre><code>## [1] 0.1235272</code></pre>
<p>Los datos de epilepsia no están agrupados, por lo tanto esta prueba de bondad de ajuste no se puede utilizar.</p>
</div>
<div id="selección-de-variables-1" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Selección de variables<a href="modelo-lineal-generalizado.html#selección-de-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La selección de variables se puede realizar de la misma forma que en los LMs basándose en indicadores como el AIC y BIC (o alguna modificación de ellos). El primero está definido como:
<span class="math display">\[
\text{AIC}=-2\ell_M+2p,
\]</span>
donde <span class="math inline">\(\ell_M\)</span> es la verosimilitud alcanzada con el modelo propuesto y <span class="math inline">\(p\)</span> el número de parámetros. El segundo indicador como:
<span class="math display">\[
\text{BIC}=-2\ell_M+p\log(n).
\]</span>
En ambos casos, entre mas pequeños sean estos indicadores mejor es el modelo.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-no-lineales.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo-logístico.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/AlvaroFlorez/MLG2/edit/master/06-ModeloGeneralizado.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/AlvaroFlorez/MLG2/blob/master/06-ModeloGeneralizado.Rmd",
    "text": null
  },
  "download": ["MLG2.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
