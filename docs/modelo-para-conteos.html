<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Modelo para conteos | Notas de clase: Modelo lineal general II</title>
  <meta name="description" content="Capítulo 8 Modelo para conteos | Notas de clase: Modelo lineal general II" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Modelo para conteos | Notas de clase: Modelo lineal general II" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Modelo para conteos | Notas de clase: Modelo lineal general II" />
  
  
  

<meta name="author" content="Alvaro J. Flórez" />


<meta name="date" content="2025-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-logístico.html"/>
<link rel="next" href="modelo-lineal-mixto.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notas de clase MLGII</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html"><i class="fa fa-check"></i><b>1</b> Variables indicadoras (o dummies)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#ejemplos"><i class="fa fa-check"></i><b>1.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.1.1</b> Datos de atletas australianos</a></li>
<li class="chapter" data-level="1.1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#datos-de-la-onu"><i class="fa fa-check"></i><b>1.1.2</b> Datos de la ONU</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#variables-indicadoras"><i class="fa fa-check"></i><b>1.2</b> Variables indicadoras</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelos-con-covariables-categóricas"><i class="fa fa-check"></i><b>1.2.1</b> Modelos con covariables categóricas</a></li>
<li class="chapter" data-level="1.2.2" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-atletas-australianos"><i class="fa fa-check"></i><b>1.2.2</b> Modelo para los datos de atletas australianos</a></li>
<li class="chapter" data-level="1.2.3" data-path="variables-indicadoras-o-dummies.html"><a href="variables-indicadoras-o-dummies.html#modelo-para-los-datos-de-la-onu"><i class="fa fa-check"></i><b>1.2.3</b> Modelo para los datos de la ONU</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html"><i class="fa fa-check"></i><b>2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplos-1"><i class="fa fa-check"></i><b>2.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles"><i class="fa fa-check"></i><b>2.1.1</b> Pasteles</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston"><i class="fa fa-check"></i><b>2.1.2</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#modelos-polinomiales-1"><i class="fa fa-check"></i><b>2.2</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>2.2.1</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#pasteles-1"><i class="fa fa-check"></i><b>2.2.2</b> Pasteles</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#datos-de-boston-1"><i class="fa fa-check"></i><b>2.2.3</b> Datos de Boston</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#regresión-por-segmentos"><i class="fa fa-check"></i><b>2.3</b> Regresión por segmentos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="modelos-polinomiales.html"><a href="modelos-polinomiales.html#ejemplo"><i class="fa fa-check"></i><b>2.3.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multicolinealidad.html"><a href="multicolinealidad.html"><i class="fa fa-check"></i><b>3</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#ejemplos-2"><i class="fa fa-check"></i><b>3.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#cemento"><i class="fa fa-check"></i><b>3.1.1</b> Cemento</a></li>
<li class="chapter" data-level="3.1.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#grasa-corporal"><i class="fa fa-check"></i><b>3.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#multicolinealidad-1"><i class="fa fa-check"></i><b>3.2</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#causas-de-la-multicolinealidad"><i class="fa fa-check"></i><b>3.2.1</b> Causas de la multicolinealidad</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#detección-de-multicolinealidad"><i class="fa fa-check"></i><b>3.3</b> Detección de multicolinealidad</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#factores-de-inflación-de-varianza"><i class="fa fa-check"></i><b>3.3.1</b> Factores de inflación de varianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-propios-de-boldsymbol-zboldsymbol-z"><i class="fa fa-check"></i><b>3.3.2</b> Valores propios de <span class="math inline">\(\boldsymbol Z&#39;\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.3" data-path="multicolinealidad.html"><a href="multicolinealidad.html#valores-singulares-de-boldsymbol-z"><i class="fa fa-check"></i><b>3.3.3</b> Valores singulares de <span class="math inline">\(\boldsymbol Z\)</span></a></li>
<li class="chapter" data-level="3.3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#proporciones-de-descomposición-de-varianza"><i class="fa fa-check"></i><b>3.3.4</b> Proporciones de descomposición de varianza</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento"><i class="fa fa-check"></i><b>3.4</b> Datos de cemento</a></li>
<li class="chapter" data-level="3.5" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-grasa-corporal"><i class="fa fa-check"></i><b>3.5</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="3.6" data-path="multicolinealidad.html"><a href="multicolinealidad.html#solución-al-problema-de-multicolinealidad"><i class="fa fa-check"></i><b>3.6</b> Solución al problema de multicolinealidad</a></li>
<li class="chapter" data-level="3.7" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-de-ridge"><i class="fa fa-check"></i><b>3.7</b> Estimador de ridge</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-1"><i class="fa fa-check"></i><b>3.7.1</b> Datos de cemento</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="multicolinealidad.html"><a href="multicolinealidad.html#estimador-por-componentes-principales"><i class="fa fa-check"></i><b>3.8</b> Estimador por componentes principales</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="multicolinealidad.html"><a href="multicolinealidad.html#datos-de-cemento-2"><i class="fa fa-check"></i><b>3.8.1</b> Datos de cemento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="selección-de-variables.html"><a href="selección-de-variables.html"><i class="fa fa-check"></i><b>4</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplos-3"><i class="fa fa-check"></i><b>4.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#unidad-quirúrgica"><i class="fa fa-check"></i><b>4.1.1</b> Unidad quirúrgica</a></li>
<li class="chapter" data-level="4.1.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#grasa-corporal-1"><i class="fa fa-check"></i><b>4.1.2</b> Grasa corporal</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#problema-de-selección-de-variables"><i class="fa fa-check"></i><b>4.2</b> Problema de selección de variables</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#qué-pasa-si-ignoramos-covariables-importantes"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué pasa si ignoramos covariables importantes?</a></li>
<li class="chapter" data-level="4.2.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#que-pasa-si-incluimos-covariables-irrelevantes"><i class="fa fa-check"></i><b>4.2.2</b> ¿Que pasa si incluimos covariables irrelevantes?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#métodos-para-la-selección-de-variables"><i class="fa fa-check"></i><b>4.3</b> Métodos para la selección de variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>4.3.1</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="4.3.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#coeficiente-de-determinación-ajustado"><i class="fa fa-check"></i><b>4.3.2</b> Coeficiente de determinación ajustado</a></li>
<li class="chapter" data-level="4.3.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#c_p-de-mallows"><i class="fa fa-check"></i><b>4.3.3</b> C<span class="math inline">\(_p\)</span> de Mallows</a></li>
<li class="chapter" data-level="4.3.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#estadístico-press"><i class="fa fa-check"></i><b>4.3.4</b> Estadístico PRESS</a></li>
<li class="chapter" data-level="4.3.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#criterios-de-información"><i class="fa fa-check"></i><b>4.3.5</b> Criterios de información</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="selección-de-variables.html"><a href="selección-de-variables.html#comparación-de-los-modelos"><i class="fa fa-check"></i><b>4.4</b> Comparación de los modelos</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#todos-los-posibles-modelos"><i class="fa fa-check"></i><b>4.4.1</b> Todos los posibles modelos</a></li>
<li class="chapter" data-level="4.4.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#algorítmos-de-selección"><i class="fa fa-check"></i><b>4.4.2</b> Algorítmos de selección</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="selección-de-variables.html"><a href="selección-de-variables.html#regresión-de-lasso"><i class="fa fa-check"></i><b>4.5</b> Regresión de LASSO</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="selección-de-variables.html"><a href="selección-de-variables.html#datos-de-grasa-corporal-1"><i class="fa fa-check"></i><b>4.5.1</b> Datos de grasa corporal</a></li>
<li class="chapter" data-level="4.5.2" data-path="selección-de-variables.html"><a href="selección-de-variables.html#validación-cruzada"><i class="fa fa-check"></i><b>4.5.2</b> Validación cruzada</a></li>
<li class="chapter" data-level="4.5.3" data-path="selección-de-variables.html"><a href="selección-de-variables.html#ejemplo-grasa-corporal"><i class="fa fa-check"></i><b>4.5.3</b> Ejemplo grasa corporal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html"><i class="fa fa-check"></i><b>5</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#ejemplos-4"><i class="fa fa-check"></i><b>5.1</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#crecimiento-de-pavos"><i class="fa fa-check"></i><b>5.1.1</b> Crecimiento de pavos</a></li>
<li class="chapter" data-level="5.1.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#puromicina"><i class="fa fa-check"></i><b>5.1.2</b> Puromicina</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-1"><i class="fa fa-check"></i><b>5.2</b> Modelos no lineales</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-no-lineales-linealizables"><i class="fa fa-check"></i><b>5.2.1</b> Modelos no-lineales linealizables</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#estimación-de-los-parámetros"><i class="fa fa-check"></i><b>5.2.2</b> Estimación de los parámetros</a></li>
<li class="chapter" data-level="5.2.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#inferencia-sobre-los-parámetros"><i class="fa fa-check"></i><b>5.2.3</b> Inferencia sobre los parámetros</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#método-de-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Método de Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#bootstrap-en-regresión"><i class="fa fa-check"></i><b>5.3.1</b> Bootstrap en regresión</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#algunas-consideraciones"><i class="fa fa-check"></i><b>5.3.2</b> Algunas consideraciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html"><i class="fa fa-check"></i><b>6</b> Modelo lineal generalizado</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#casos-de-estudio"><i class="fa fa-check"></i><b>6.2</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#mortalidad-de-escarabajos"><i class="fa fa-check"></i><b>6.2.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="6.2.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ataques-de-epilepsia"><i class="fa fa-check"></i><b>6.2.2</b> ataques de epilepsia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#preambulo"><i class="fa fa-check"></i><b>6.3</b> Preambulo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#familia-exponencial"><i class="fa fa-check"></i><b>6.3.1</b> Familia exponencial</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#relación-media-varianza"><i class="fa fa-check"></i><b>6.3.2</b> Relación media-varianza:</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-de-máxima-verosimilitud"><i class="fa fa-check"></i><b>6.3.3</b> Estimador de máxima verosimilitud</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#métodos-iterativos-de-maximización"><i class="fa fa-check"></i><b>6.3.4</b> Métodos iterativos de maximización</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#modelo-lineal-generalizado-glm"><i class="fa fa-check"></i><b>6.4</b> Modelo lineal generalizado (GLM)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#componente-aleatorio"><i class="fa fa-check"></i><b>6.4.1</b> Componente aleatorio</a></li>
<li class="chapter" data-level="6.4.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#predictor-lineal"><i class="fa fa-check"></i><b>6.4.2</b> Predictor lineal</a></li>
<li class="chapter" data-level="6.4.3" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#función-de-enlace"><i class="fa fa-check"></i><b>6.4.3</b> Función de enlace</a></li>
<li class="chapter" data-level="6.4.4" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ejemplos-de-glm"><i class="fa fa-check"></i><b>6.4.4</b> Ejemplos de GLM</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#ajuste-de-un-glm"><i class="fa fa-check"></i><b>6.5</b> Ajuste de un GLM</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#especificación-del-modelo"><i class="fa fa-check"></i><b>6.5.1</b> Especificación del modelo</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#estimador-por-máxima-verosimilitud-para-boldsymbol-beta"><i class="fa fa-check"></i><b>6.5.2</b> Estimador por máxima verosimilitud para <span class="math inline">\(\boldsymbol \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#pruebas-de-hipótesis"><i class="fa fa-check"></i><b>6.6</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-razón-de-verosimilitud"><i class="fa fa-check"></i><b>6.6.1</b> Método de razón de verosimilitud</a></li>
<li class="chapter" data-level="6.6.2" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#método-de-wald"><i class="fa fa-check"></i><b>6.6.2</b> Método de Wald</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>6.7</b> intervalos de confianza</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#intervalo-de-confianza-para-la-media"><i class="fa fa-check"></i><b>6.7.1</b> Intervalo de confianza para la media</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#devianza"><i class="fa fa-check"></i><b>6.8</b> Devianza</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#el-estadístico-chi-cuadrado-de-pearson"><i class="fa fa-check"></i><b>6.8.1</b> El estadístico chi-cuadrado de Pearson</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#bondad-de-ajuste"><i class="fa fa-check"></i><b>6.9</b> Bondad de ajuste</a></li>
<li class="chapter" data-level="6.10" data-path="modelo-lineal-generalizado.html"><a href="modelo-lineal-generalizado.html#selección-de-variables-1"><i class="fa fa-check"></i><b>6.10</b> Selección de variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-logístico.html"><a href="modelo-logístico.html"><i class="fa fa-check"></i><b>7</b> Modelo logístico</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#casos-de-estudio-1"><i class="fa fa-check"></i><b>7.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#mortalidad-de-escarabajos-1"><i class="fa fa-check"></i><b>7.1.1</b> Mortalidad de escarabajos</a></li>
<li class="chapter" data-level="7.1.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#bajo-peso-al-nacer"><i class="fa fa-check"></i><b>7.1.2</b> Bajo peso al nacer</a></li>
<li class="chapter" data-level="7.1.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología"><i class="fa fa-check"></i><b>7.1.3</b> Estudio de teratología</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados-o-datos-no-agrupados"><i class="fa fa-check"></i><b>7.2</b> Datos agrupados o datos no agrupados</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-agrupados"><i class="fa fa-check"></i><b>7.2.1</b> Datos agrupados</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#datos-no-agrupados"><i class="fa fa-check"></i><b>7.2.2</b> Datos no agrupados</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modelo-logístico.html"><a href="modelo-logístico.html#funciones-de-enlace"><i class="fa fa-check"></i><b>7.3</b> Funciones de enlace</a></li>
<li class="chapter" data-level="7.4" data-path="modelo-logístico.html"><a href="modelo-logístico.html#curva-característica-operativa-del-receptorroc"><i class="fa fa-check"></i><b>7.4</b> Curva característica operativa del receptor(ROC)</a></li>
<li class="chapter" data-level="7.5" data-path="modelo-logístico.html"><a href="modelo-logístico.html#sobredispersión"><i class="fa fa-check"></i><b>7.5</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#evaluación-de-sobredispersión"><i class="fa fa-check"></i><b>7.5.1</b> Evaluación de sobredispersión</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modelo-logístico.html"><a href="modelo-logístico.html#distribución-beta-binomial"><i class="fa fa-check"></i><b>7.6</b> Distribución beta-binomial</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modelo-logístico.html"><a href="modelo-logístico.html#modelo-beta-binomial"><i class="fa fa-check"></i><b>7.6.1</b> Modelo beta-binomial</a></li>
<li class="chapter" data-level="7.6.2" data-path="modelo-logístico.html"><a href="modelo-logístico.html#estudio-de-teratología-1"><i class="fa fa-check"></i><b>7.6.2</b> Estudio de teratología</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html"><i class="fa fa-check"></i><b>8</b> Modelo para conteos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#casos-de-estudio-2"><i class="fa fa-check"></i><b>8.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#ataques-de-epilepsia-1"><i class="fa fa-check"></i><b>8.1.1</b> Ataques de epilepsia</a></li>
<li class="chapter" data-level="8.1.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido"><i class="fa fa-check"></i><b>8.1.2</b> Muertes por enfermedades cardiovasculares en doctores del Reino Unido</a></li>
<li class="chapter" data-level="8.1.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites"><i class="fa fa-check"></i><b>8.1.3</b> Número de cangrejos satélites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-poisson"><i class="fa fa-check"></i><b>8.2</b> Modelo Poisson</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-conteo-con-offset"><i class="fa fa-check"></i><b>8.2.1</b> Modelo de conteo con offset</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#sobredispersión-1"><i class="fa fa-check"></i><b>8.3</b> Sobredispersión</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>8.3.1</b> Distribución binomial negativa</a></li>
<li class="chapter" data-level="8.3.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-binomial-negativo"><i class="fa fa-check"></i><b>8.3.2</b> Modelo binomial negativo</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#inflación-de-ceros"><i class="fa fa-check"></i><b>8.4</b> Inflación de ceros</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-de-inflación-de-ceros"><i class="fa fa-check"></i><b>8.4.1</b> Modelo de inflación de ceros</a></li>
<li class="chapter" data-level="8.4.2" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#modelo-hurdle"><i class="fa fa-check"></i><b>8.4.2</b> Modelo Hurdle</a></li>
<li class="chapter" data-level="8.4.3" data-path="modelo-para-conteos.html"><a href="modelo-para-conteos.html#número-de-cangrejos-satélites-1"><i class="fa fa-check"></i><b>8.4.3</b> Número de cangrejos satélites</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html"><i class="fa fa-check"></i><b>9</b> Modelo lineal mixto</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#casos-de-estudio-3"><i class="fa fa-check"></i><b>9.1</b> Casos de estudio</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#peso-al-nacer-de-ratas"><i class="fa fa-check"></i><b>9.1.1</b> Peso al nacer de ratas</a></li>
<li class="chapter" data-level="9.1.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#capacidad-respiratoria"><i class="fa fa-check"></i><b>9.1.2</b> Capacidad respiratoria</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#datos-por-cluster-correlacionados"><i class="fa fa-check"></i><b>9.2</b> Datos por cluster (correlacionados)</a></li>
<li class="chapter" data-level="9.3" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#notación"><i class="fa fa-check"></i><b>9.3</b> Notación</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelos-con-intercepto-aleatorios"><i class="fa fa-check"></i><b>9.4</b> Modelos con intercepto aleatorios</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.4.1</b> Modelo con pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#modelo-lineal-mixto-1"><i class="fa fa-check"></i><b>9.5</b> Modelo lineal mixto</a></li>
<li class="chapter" data-level="9.6" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-de-los-parámetros-1"><i class="fa fa-check"></i><b>9.6</b> Estimación de los parámetros</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-intercepto-aleatorio"><i class="fa fa-check"></i><b>9.6.1</b> Estimación del modelo con intercepto aleatorio</a></li>
<li class="chapter" data-level="9.6.2" data-path="modelo-lineal-mixto.html"><a href="modelo-lineal-mixto.html#estimación-del-modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>9.6.2</b> Estimación del modelo con pendiente aleatoria</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de clase: Modelo lineal general II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo-para-conteos" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Capítulo 8</span> Modelo para conteos<a href="modelo-para-conteos.html#modelo-para-conteos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="casos-de-estudio-2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Casos de estudio<a href="modelo-para-conteos.html#casos-de-estudio-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ataques-de-epilepsia-1" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Ataques de epilepsia<a href="modelo-para-conteos.html#ataques-de-epilepsia-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a considerar de nuevo los datos del ensayo clínico sobre epilepsia (<code>data(epilepsy)</code> de la librería <code>HSAUR2</code>).</p>
</div>
<div id="muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Muertes por enfermedades cardiovasculares en doctores del Reino Unido<a href="modelo-para-conteos.html#muertes-por-enfermedades-cardiovasculares-en-doctores-del-reino-unido" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los datos <code>bs1</code> de la librería <code>ACSW</code> muestran el número de doctores muertos por enfermedades coronarias entre médicos varones <span class="math inline">\(10\)</span> años después de seguimiento por grupos de edad y condición de tabaquismo. De igual forma, la base de datos contiene el número de total de años-personas de observación en el momento de análisis. En la Figura <a href="modelo-para-conteos.html#fig:doctorUK1">8.1</a> podemos observar la tasa de mortalidad, por 100,000 personas, crece por grupo de edad, y es generalmente, mayor para los fumadores.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="modelo-para-conteos.html#cb176-1" tabindex="-1"></a><span class="fu">library</span>(ACSWR)</span>
<span id="cb176-2"><a href="modelo-para-conteos.html#cb176-2" tabindex="-1"></a><span class="fu">data</span>(bs1)</span>
<span id="cb176-3"><a href="modelo-para-conteos.html#cb176-3" tabindex="-1"></a><span class="fu">plot</span>(bs1<span class="sc">$</span>Age_Cat, <span class="dv">100000</span><span class="sc">*</span>(bs1<span class="sc">$</span>Deaths<span class="sc">/</span>bs1<span class="sc">$</span>Person_Years),<span class="at">col=</span>bs1<span class="sc">$</span>Smoke_Ind<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb176-4"><a href="modelo-para-conteos.html#cb176-4" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&#39;grupo de edad&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;muertes por 100,000 personas-año&#39;</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb176-5"><a href="modelo-para-conteos.html#cb176-5" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,bs1<span class="sc">$</span>Age_Group[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:doctorUK1"></span>
<img src="MLG2_files/figure-html/doctorUK1-1.png" alt="Datos de muertes cardiovasculares. Tasa de muertes por enfermedades cardiovasculares en doctores del Reino Unido por grupo de edad. Los puntos rojos corresponden a fumadores y los negros a no fumadores." width="576" />
<p class="caption">
Figure 8.1: Datos de muertes cardiovasculares. Tasa de muertes por enfermedades cardiovasculares en doctores del Reino Unido por grupo de edad. Los puntos rojos corresponden a fumadores y los negros a no fumadores.
</p>
</div>
<p>A partir de estos datos surgen las siguientes preguntas: ¿La tasa de mortalidad es mayor para los fumadores que para los no fumadores? y ¿El efecto diferencial está relacionado con la edad?</p>
</div>
<div id="número-de-cangrejos-satélites" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Número de cangrejos satélites<a href="modelo-para-conteos.html#número-de-cangrejos-satélites" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los datos <code>crabs</code> de la librería <code>asbio</code> son de un estudio sobre <span class="math inline">\(173\)</span> hembras de cangrejos herradura en una isla en el Golfo de México. Durante el periodo de desove, el macho se adhiere a las hembras cuando estas van a la playa a excavar un agujero en la arena para poner racimos de huevos. Esto con el fin de que puedan fecundar los huevos (fecundación externa). Dada la competencia, las hembras suelen llegar a la playa con varios machos adheridos a ella. A este grupo de cangrejos se les llama satélites. Aquí, nuestra variable de respuesta es el número de satélites que tiene cada hembra. Mientras que las posibles covariables son:</p>
<ul>
<li><p><code>color</code>: color (1, medio-claro; 2, medio; 3, medio-oscuro; 4,oscuro).</p></li>
<li><p><code>spine</code>: condición de la espina dorsal (1, ambos bien; 2, uno gastado o roto; 3, ambos gastados o rotos).</p></li>
<li><p><code>width</code>: ancho del caparazón (cm).</p></li>
<li><p><code>weight</code>: peso (kg)</p></li>
</ul>
En la Figura <a href="modelo-para-conteos.html#fig:crabsData">8.2</a> podemos observar que hay una alta presencia de hembras que llegan a la playa sin ningún satélite. Además, vemos que hay una relación positiva entre el número de satélites y el tamaño de la hembra.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:crabsData"></span>
<img src="MLG2_files/figure-html/crabsData-1.png" alt="Datos de cangrejos satélites. Histograma del número de satélites por hembra (izquierda) y diagrama de dispersión del número de satélites en función del peso de la hembra (derecha)" width="576" />
<p class="caption">
Figure 8.2: Datos de cangrejos satélites. Histograma del número de satélites por hembra (izquierda) y diagrama de dispersión del número de satélites en función del peso de la hembra (derecha)
</p>
</div>
</div>
</div>
<div id="modelo-poisson" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Modelo Poisson<a href="modelo-para-conteos.html#modelo-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La distribución Poisson es comúnmente usada para modelar el número de eventos aleatorios que ocurren en un intervalo de tiempo o espacio determinado. Esta distribución también se aplica como una aproximación de la binomial cuando <span class="math inline">\(n\)</span> es grande y <span class="math inline">\(\pi\)</span> es pequeño. En este caso, la binomial<span class="math inline">\((n_i, \pi_i)\)</span> converge hacia una Poisson<span class="math inline">\((\mu=n\pi)\)</span>.</p>
<p>El modelo Poisson se expresa como:
<span class="math display">\[
y_i\sim \mbox{Poisson}(\lambda_i), \quad i=1,...,n, \text{ donde }  \log \lambda_i=\boldsymbol x&#39;_i\boldsymbol \beta,
\]</span>
donde <span class="math inline">\(\boldsymbol x_i\)</span> es el vector de covariables asociada al individuo <span class="math inline">\(i\)</span>. Este modelo asume que:
<span class="math display">\[
E(y_i|\boldsymbol x_i)=V(y_i|\boldsymbol x_i)=\lambda_i.
\]</span>
Es decir, la media es igual a la varianza.</p>
<div id="modelo-de-conteo-con-offset" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Modelo de conteo con offset<a href="modelo-para-conteos.html#modelo-de-conteo-con-offset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En algunos casos los conteos <span class="math inline">\(y_i\)</span> son proporcionales a un índice <span class="math inline">\(t_i\)</span> (intervalo de tiempo, área de espacio, tamaño de población). Cuando <span class="math inline">\(t_i\)</span> no es fijo, se debe incluir un término llamado <strong>offset</strong>. En este caso, es preferible modelar la tasa <span class="math inline">\(y_i/t_i\)</span> con valor esperado igual a <span class="math inline">\(\lambda_i/t_i\)</span>.</p>
<p>Por lo tanto, el predictor lineal queda de la forma:</p>
<p><span class="math display">\[
\log\left(\frac{\lambda_i}{t_i}\right)=\boldsymbol x&#39;_i\boldsymbol \beta,
\]</span>
donde el término <span class="math inline">\(\log t_i\)</span> es llamado <strong>offset</strong>. Por lo que <span class="math inline">\(\log\lambda_i=\boldsymbol x_i&#39;\boldsymbol \beta+\log t_i\)</span>. Entonces, el valor esperado de <span class="math inline">\(y_i\)</span> es:</p>
<p><span class="math display">\[
\lambda_i=t_i \exp(\boldsymbol x_i&#39;\boldsymbol \beta).
\]</span>
#### Muertes por enfermedades cardiovasculares en doctores del Reino Unido</p>
<p>Dado que los tamaños de la población por grupo de edad son diferentes (hay menos personas en los grupos de edad mayores), debemos considerar esto en el modelo por medio del offset. En este caso el modelo propuesto para el número de doctores muertos por enfermedades cardiovasculares en la <span class="math inline">\(i\)</span>-ésima categoría <span class="math inline">\((y_i)\)</span> puede ser:
<span class="math display">\[
y_i \sim \mbox{Poisson}(\lambda_i),
\]</span>
donde:
<span class="math display">\[
\log \lambda_i = \beta_0 + \mbox{smoke}_i\beta_1 + \mbox{ageCat1}_i\beta_2 + \mbox{ageCat2}_i\beta_3 + \mbox{ageCat3}_i\beta_4 + \mbox{ageCat4}_i\beta_5 + \log(t_i),
\]</span>
smoke<span class="math inline">\(_i=1\)</span> si la <span class="math inline">\(i\)</span>-ésima categoría corresponde a fumadores; smoke<span class="math inline">\(_i=0\)</span> si lo contrario; <span class="math inline">\(t_i\)</span> es el número de doctores en riesgo asociados al grupo <span class="math inline">\(i\)</span>, ageCat<span class="math inline">\(j\)</span> corresponde a las variables indicadores asociadas al grupo de edad, con <span class="math inline">\([35,44]\)</span> como referencia.</p>
<p>El ajuste del modelo es</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="modelo-para-conteos.html#cb177-1" tabindex="-1"></a>poisson.doctor <span class="ot">=</span> <span class="fu">glm</span>(Deaths <span class="sc">~</span> Smoke_Ind <span class="sc">+</span> Age_Group <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Person_Years)), </span>
<span id="cb177-2"><a href="modelo-para-conteos.html#cb177-2" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> bs1)</span>
<span id="cb177-3"><a href="modelo-para-conteos.html#cb177-3" tabindex="-1"></a><span class="fu">summary</span>(poisson.doctor)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Deaths ~ Smoke_Ind + Age_Group + offset(log(Person_Years)), 
##     family = poisson(link = &quot;log&quot;), data = bs1)
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -7.9193     0.1918 -41.298  &lt; 2e-16 ***
## Smoke_Ind        0.3545     0.1074   3.302  0.00096 ***
## Age_Group45-54   1.4840     0.1951   7.606 2.82e-14 ***
## Age_Group55-64   2.6275     0.1837  14.301  &lt; 2e-16 ***
## Age_Group65-74   3.3505     0.1848  18.131  &lt; 2e-16 ***
## Age_Group75-84   3.7001     0.1922  19.249  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 935.067  on 9  degrees of freedom
## Residual deviance:  12.132  on 4  degrees of freedom
## AIC: 79.2
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Estos datos sugieren que, luego de tener en cuenta el efecto de la edad, los fumadores tienen una tasa de mortalidad <span class="math inline">\(\exp(\widehat{\beta}_1)=1.42\)</span> mayor que los no fumadores.</p>
<p>Para simplificar el modelo, y evaluar efectos de interacción, uno podría tomar la categoría de edad de forma numérica de la siguiente forma: *<strong>age</strong><span class="math inline">\(=1,2,\ldots,5\)</span> para las categorías <span class="math inline">\(35-44,45-54,\ldots,75-84\)</span>. Así podemos proponer un modelo de la forma:
<span class="math display">\[
\log \lambda_i = \beta_0 + \mbox{smoke}_i\beta_1 + \mbox{age}_i\beta_2 + \mbox{age}^2_i\beta_3 + \mbox{smoke}_i\mbox{age}_i\beta_4  + \log(t_i),
\]</span>
El efecto de la interacción se incluye para evaluar si la diferencia en la tasa de muertes entre fumadores y no fumadores cambia con el aumento de la edad. El ajuste del modelo es:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="modelo-para-conteos.html#cb179-1" tabindex="-1"></a>bs1<span class="sc">$</span>Age <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb179-2"><a href="modelo-para-conteos.html#cb179-2" tabindex="-1"></a>poisson.doctor2 <span class="ot">=</span> <span class="fu">glm</span>(Deaths <span class="sc">~</span> Smoke_Ind<span class="sc">+</span>Age<span class="sc">+</span><span class="fu">I</span>(Age<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>Smoke_Ind<span class="sc">*</span>Age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(Person_Years)), </span>
<span id="cb179-3"><a href="modelo-para-conteos.html#cb179-3" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> bs1)</span>
<span id="cb179-4"><a href="modelo-para-conteos.html#cb179-4" tabindex="-1"></a><span class="fu">summary</span>(poisson.doctor2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Deaths ~ Smoke_Ind + Age + I(Age^2) + Smoke_Ind * 
##     Age + offset(log(Person_Years)), family = poisson(link = &quot;log&quot;), 
##     data = bs1)
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -10.79176    0.45008 -23.978  &lt; 2e-16 ***
## Smoke_Ind       1.44097    0.37220   3.872 0.000108 ***
## Age             2.37648    0.20795  11.428  &lt; 2e-16 ***
## I(Age^2)       -0.19768    0.02737  -7.223 5.08e-13 ***
## Smoke_Ind:Age  -0.30755    0.09704  -3.169 0.001528 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 935.0673  on 9  degrees of freedom
## Residual deviance:   1.6354  on 5  degrees of freedom
## AIC: 66.703
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Estos resultados también muestran que, en promedio, los fumadores tienen una tasa de mortalidad <span class="math inline">\(4\)</span> veces más alta que los no fumadores. Sin embargo, esta diferencia se atenúa a medida que la edad aumenta (efecto interacción negativo). Esto lo podemos ver forma gráfica en la Figura <a href="modelo-para-conteos.html#fig:doctorUKgraf">8.3</a>.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="modelo-para-conteos.html#cb181-1" tabindex="-1"></a><span class="fu">plot</span>(bs1<span class="sc">$</span>Age, <span class="dv">100000</span><span class="sc">*</span>(bs1<span class="sc">$</span>Deaths<span class="sc">/</span>bs1<span class="sc">$</span>Person_Years),<span class="at">col=</span>bs1<span class="sc">$</span>Smoke_Ind<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb181-2"><a href="modelo-para-conteos.html#cb181-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&#39;grupo de edad&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;muertes por 100,000 personas-año&#39;</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb181-3"><a href="modelo-para-conteos.html#cb181-3" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,bs1<span class="sc">$</span>Age_Group[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb181-4"><a href="modelo-para-conteos.html#cb181-4" tabindex="-1"></a></span>
<span id="cb181-5"><a href="modelo-para-conteos.html#cb181-5" tabindex="-1"></a>pred.tasa <span class="ot">=</span> <span class="dv">100000</span><span class="sc">*</span>poisson.doctor2<span class="sc">$</span>fitted.values<span class="sc">/</span>bs1<span class="sc">$</span>Person_Years</span>
<span id="cb181-6"><a href="modelo-para-conteos.html#cb181-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,pred.tasa[bs1<span class="sc">$</span>Smoke_Ind<span class="sc">==</span><span class="dv">0</span>],<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb181-7"><a href="modelo-para-conteos.html#cb181-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,pred.tasa[bs1<span class="sc">$</span>Smoke_Ind<span class="sc">==</span><span class="dv">1</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:doctorUKgraf"></span>
<img src="MLG2_files/figure-html/doctorUKgraf-1.png" alt="Datos de muertes cardiovasculares. Estimación de la tasa de muertes de doctores del Reino Unido por grupo de edad para fumadores(línea roja) y no fumadores (línea negra)." width="672" />
<p class="caption">
Figure 8.3: Datos de muertes cardiovasculares. Estimación de la tasa de muertes de doctores del Reino Unido por grupo de edad para fumadores(línea roja) y no fumadores (línea negra).
</p>
</div>
</div>
</div>
<div id="sobredispersión-1" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Sobredispersión<a href="modelo-para-conteos.html#sobredispersión-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El modelo Poisson asume que <span class="math inline">\(V(y) = E(y)\)</span>. Sin embargo, es común encontrar datos en que la varianza crece más rápido que la media, provocando sobredispersión. En este caso, el estimador por máxima verosimilitud del modelo Poisson sigue proporcionando estimaciones consistentes para la media (estimaciones insesgadas). Sin embargo, los errores estándar estarán mal calculados (generalmente más pequeños).</p>
<p>Para modelar datos de tipo conteo en presencia de sobredispersión se puede asumir una distribución binomial negativa. Esta incluye un parámetro adicional que cuantifica la sobredispersión.</p>
<div id="distribución-binomial-negativa" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Distribución binomial negativa<a href="modelo-para-conteos.html#distribución-binomial-negativa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La distribución binomial negativa parte de una mezcla de una distribución Poisson con una gamma. Esto es:
<span class="math display">\[
y | \lambda \sim \mbox{Poisson}(\lambda), \mbox{ donde } \lambda\sim \mbox{gamma}(k,\mu).
\]</span>
La función de densidad de <span class="math inline">\(\lambda\)</span> es:</p>
<p><span class="math display">\[
f(\lambda;k,\mu)=\frac{(k/\mu)^k}{\Gamma(k)}\exp\left(-\frac{k\lambda}{\mu}\right)\lambda^{k-1}.
\]</span></p>
<p>Entonces tenemos:
<span class="math display">\[
E(\lambda)=\mu \mbox{ y } V(\lambda)=\mu^2/k.
\]</span>
La distribución binomial negativa (también llamada Poisson-gamma) se obtiene al marginalizar <span class="math inline">\(y\)</span>. Esto es:
<span class="math display">\[
f(y;\mu,k)=\int f(y|\lambda)f(\lambda)d\lambda.
\]</span></p>
<p>La función de densidad de la binomial negativa queda definida como:</p>
<p><span class="math display">\[
f(y;\mu,k)=\frac{\Gamma(y+k)}{\Gamma(k)\Gamma(y+1)}\left( \frac{\mu}{\mu+k}\right)^y \left( \frac{k}{\mu+k} \right)^k
\]</span>
para <span class="math inline">\(y=0,1,...\)</span> Si definimos <span class="math inline">\(\gamma=1/k\)</span>, tenemos que:</p>
<p><span class="math display">\[
E(y)=\mu \mbox{ y }  V(y)=\mu(1+\gamma\mu),
\]</span>
para <span class="math inline">\(\gamma&gt;0\)</span> (llamado parámetro de sobredispersión). La distribución de probabilidad de la distribución binomial negativa se puede observar en la Figura <a href="modelo-para-conteos.html#fig:disNegBin">8.4</a>. Aquí vemos que a medida que aumenta <span class="math inline">\(\gamma\)</span>, la probabilidad de valores extremos es más alta.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:disNegBin"></span>
<img src="MLG2_files/figure-html/disNegBin-1.png" alt="Función de probabilidad de Poisson(3) (negro), binomial negativa (3,0.5) (rojo), binomial negativa (3,1.5) (verde)." width="576" />
<p class="caption">
Figure 8.4: Función de probabilidad de Poisson(3) (negro), binomial negativa (3,0.5) (rojo), binomial negativa (3,1.5) (verde).
</p>
</div>
<p>Dado que <span class="math inline">\(\gamma&gt;0\)</span>, el modelo binomial negativo no puede modelar datos con subdispersión.</p>
</div>
<div id="modelo-binomial-negativo" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Modelo binomial negativo<a href="modelo-para-conteos.html#modelo-binomial-negativo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo binomial negativo se expresa de la siguiente forma:
<span class="math display">\[
y_i|\lambda_i\sim \mbox{binomial negativa}(\mu_i,\gamma),
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\mu_i=\exp(\boldsymbol x&#39;_i\boldsymbol \beta).
\]</span>
Por lo cuál:
<span class="math display">\[
E(y_i)=\mu_i\mbox{ y } V(y_i)=\mu_i(1+\gamma\mu_i).
\]</span>
La estimación de los parámetros <span class="math inline">\((\boldsymbol \beta,\gamma)\)</span> se hace por máxima verosimilitud.</p>
<div id="ataques-epilépticos-1" class="section level4 hasAnchor" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Ataques epilépticos<a href="modelo-para-conteos.html#ataques-epilépticos-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Para los datos de los ataques epilépticos se propone el siguiente modelo:
<span class="math display">\[
y_i \sim \mbox{Poisson}(\lambda_i), \mbox{ donde } \log \lambda_i = \beta_0 + \mbox{treatment}_i\beta_1 + \mbox{base}_i\beta_2,
\]</span>
donde <span class="math inline">\(y_i\)</span> es el número de ataques epiléptivos en dos semanas luego de cuatro semanas de tratamiento; treatment<span class="math inline">\(_i=1\)</span> si el <span class="math inline">\(i\)</span>-ésimo paciente recibió el tratamiento progabida y treatment<span class="math inline">\(_i=0\)</span> si lo contrario. Los resultados del ajuste son:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="modelo-para-conteos.html#cb182-1" tabindex="-1"></a>epilepsy4<span class="ot">=</span> HSAUR2<span class="sc">::</span>epilepsy[HSAUR2<span class="sc">::</span>epilepsy<span class="sc">$</span>period<span class="sc">==</span><span class="dv">4</span>,]</span>
<span id="cb182-2"><a href="modelo-para-conteos.html#cb182-2" tabindex="-1"></a></span>
<span id="cb182-3"><a href="modelo-para-conteos.html#cb182-3" tabindex="-1"></a>modPois <span class="ot">=</span> <span class="fu">glm</span>(seizure.rate<span class="sc">~</span>treatment<span class="sc">+</span>base,<span class="at">data=</span>epilepsy4,<span class="at">family=</span>poisson)</span>
<span id="cb182-4"><a href="modelo-para-conteos.html#cb182-4" tabindex="-1"></a><span class="fu">summary</span>(modPois)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = seizure.rate ~ treatment + base, family = poisson, 
##     data = epilepsy4)
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         1.214772   0.085543  14.201  &lt; 2e-16 ***
## treatmentProgabide -0.315159   0.098469  -3.201  0.00137 ** 
## base                0.021536   0.001039  20.733  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 476.25  on 58  degrees of freedom
## Residual deviance: 149.68  on 56  degrees of freedom
## AIC: 343.44
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Los resultados del ajuste del modelo Poisson muestran que el tratamiento es altamente significativo. Por lo que, se puede concluir que la progabida reduce el número de ataques epilépticos. Sin embargo, estos datos presenta sobredispersión. Esto se puede verificar por medio de la razón del estadístico <span class="math inline">\(\chi^2\)</span> de Pearson y los grados de libertad:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="modelo-para-conteos.html#cb184-1" tabindex="-1"></a>X2.poisson <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modPois,<span class="at">type=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb184-2"><a href="modelo-para-conteos.html#cb184-2" tabindex="-1"></a>X2.poisson<span class="sc">/</span>modPois<span class="sc">$</span>df.residual</span></code></pre></div>
<pre><code>## [1] 2.525656</code></pre>
<p>Por esta razón se puede estimar el modelo binomial negativo:
<span class="math display">\[
y_i \sim \mbox{binomial negativa}(\mu_i,\gamma), \mbox{ donde } \log \mu_i = \beta_0 + \mbox{treat}_i\beta_1 + \mbox{base}_i\beta_2.
\]</span>
El ajuste en R se puede hacer utilizando la función <code>glm.nb</code> de la librería <code>MASS</code>:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="modelo-para-conteos.html#cb186-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb186-2"><a href="modelo-para-conteos.html#cb186-2" tabindex="-1"></a>modbinNeg <span class="ot">=</span> <span class="fu">glm.nb</span>(seizure.rate<span class="sc">~</span>treatment<span class="sc">+</span>base,<span class="at">data=</span>epilepsy4)</span>
<span id="cb186-3"><a href="modelo-para-conteos.html#cb186-3" tabindex="-1"></a><span class="fu">summary</span>(modbinNeg)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = seizure.rate ~ treatment + base, data = epilepsy4, 
##     init.theta = 4.483069947, link = log)
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         1.080878   0.153419   7.045 1.85e-12 ***
## treatmentProgabide -0.327892   0.168163  -1.950   0.0512 .  
## base                0.025017   0.002688   9.308  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(4.4831) family taken to be 1)
## 
##     Null deviance: 174.166  on 58  degrees of freedom
## Residual deviance:  70.124  on 56  degrees of freedom
## AIC: 313.32
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  4.48 
##           Std. Err.:  1.55 
## 
##  2 x log-likelihood:  -305.324</code></pre>
<p>Las estimaciones del modelo binomial negativo son similares a las del ajuste del modelo Poisson. Sin embargo, vemos que los errores estándar son más grandes. Además, el valor-<span class="math inline">\(p\)</span> del efecto asociado al tratamiento es mayor. Si consideramos <span class="math inline">\(\alpha=0.05\)</span>, el efecto del tratamiento no es significativo.</p>
<p>Podemos evaluar si se presentan problemas de sobredispersión con el ajuste del modelo binomial negativo:</p>
<pre><code>## [1] 1.036141</code></pre>
<p>Este resultado sugiere que la varianza está bien estimada. Comparando criterios de información, el modelo binomial negativo presenta un mejor ajuste que el modelo Poisson:</p>
<pre><code>## [1] 321.6337</code></pre>
<pre><code>## [1] 349.6773</code></pre>
</div>
</div>
</div>
<div id="inflación-de-ceros" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Inflación de ceros<a href="modelo-para-conteos.html#inflación-de-ceros" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En ocaciones, los datos muestran mayor frecuencia de ceros de los que la distribución Poisson y binomial negativa permiten. Por ejemplo, en datos de cangrejos herradura, hay muchas hembras que llegan a la playa sin ningún satélite. La Figura <a href="modelo-para-conteos.html#fig:crabsData">8.2</a> muestra que una distribución bimodal para el número de satélites.</p>
<p><strong>Distribución con inflación de ceros</strong>
Este tipo de datos se pueden modelar con una mezcla de distribuciones donde <span class="math inline">\(Y=0\)</span> cuando <span class="math inline">\(Z=1\)</span>, y <span class="math inline">\(Y\)</span> sigue una distribución particular cuando <span class="math inline">\(Z=0\)</span> (la cual permite la posibilidad de ceros). Por ejemplo, la distribución Poisson con inflación de ceros (ZIP) se puede representar como:
<span class="math display">\[
y\sim\begin{cases} 0 \qquad &amp; \text{con probabilidad}\quad \phi, \\ \mbox{Poisson}(\lambda) \quad &amp; \text{con probabilidad}\quad 1-\phi.
\end{cases}
\]</span>
La probabilidad de que <span class="math inline">\(y\)</span> sea igual a cero es:
<span class="math display">\[
P(y=0) = \phi + (1-\phi) \exp \left(-\lambda\right).
\]</span>
Mientras que para <span class="math inline">\(y&gt;0\)</span> se tiene:
<span class="math display">\[
P(y=j) =(1-\phi) \exp \frac{\left(-\lambda\right)\lambda^j}{j!}, j=1,2,\ldots.
\]</span>
El valor esperado y la varianza de <span class="math inline">\(y\)</span> son:
<span class="math display">\[
E(y) = E(E(y|z)) = (1-\phi)\lambda, \mbox{ y } V(y)= (1-\phi)\lambda \left( 1+ \phi\lambda\right).
\]</span>
Note que la distribución ZIP permite sobredispersión.</p>
<p>De igual forma, se puede tener un modelo binomial negativo con inflación de ceros (ZINB):
<span class="math display">\[
y\sim \begin{cases} 0 \qquad &amp; \text{con probabilidad } \phi, \\ \mbox{binomial negativa}(\mu,\gamma) \quad &amp; \text{con probabilidad } 1-\phi.
\end{cases}
\]</span>
En este modelo, la probabilidad de que <span class="math inline">\(y\)</span> sea igual a cero es:
<span class="math display">\[
P(y=0) = \phi + (1-\phi) \left( 1 + \gamma \mu \right)^{-1/\gamma}.
\]</span>
Mientras que el valor esperado y varianza son:
<span class="math display">\[
E(y)= (1-\phi)\mu \mbox{ y } V(y) = (1-\phi) \mu \left[1+\mu(\gamma+\phi)\right].
\]</span></p>
<p>Otra alternativa para modelar exceso de ceros es a través del mdelo Hurdle. Este asume que hay un proceso Bernoulli que determina si el conteo es igual a cero o es positivo. Si ocurre lo segundo, una distribución truncada determina la probabilidad del conteo. La distribución se puede expresar como:
<span class="math display" id="eq:Hdis">\[\begin{equation}
P(y = j)=\begin{cases} \pi &amp; j=0, \\
(1-\pi)\frac{f(y|\theta)}{1-f(0|\theta)} &amp; j &gt;0.
\end{cases}
\tag{8.1}
\end{equation}\]</span></p>
<p>A diferencia del modelo ZI, aquí la probabilidad de <span class="math inline">\(y=0\)</span> solo está determinado por <span class="math inline">\(\pi\)</span> (no por una mezcla de distribuciones).</p>
<p>Por ejemplo, el modelo Hurdle Poisson (HP) se define como:
<span class="math display">\[
P(y = j)=\begin{cases} \pi \qquad &amp; j=0, \\ (1-\pi)\frac{\lambda^{j}\exp(-\lambda)}{j! [1-\exp(-\lambda)]} &amp; j &gt;0.
\end{cases}
\]</span>
El valor esperado y varianza de <span class="math inline">\(y\)</span> son:
<span class="math display" id="eq:Hvar">\[\begin{equation}
E(y)= (1-\pi) E(y | y &gt; 0) \mbox{ y } V(y) = (1-\pi) V(y | y &gt; 0) + \pi(1-\pi)E(y | y&gt;0)^2,
\tag{8.2}
\end{equation}\]</span>
donde:
<span class="math display">\[
E(y | y &gt; 0) = \frac{\lambda}{1- \exp(-\lambda)} \mbox{ y } V(y|y&gt;0) = \frac{\mu}{1-\exp(-\lambda)} + \exp(-\lambda)E(y | y &gt;0)^2.
\]</span>
También, se tiene la distribución Hurdle binomial negativa (HNB), definiendo <span class="math inline">\(f(y)\)</span> como la distribución binomial negativa en <a href="modelo-para-conteos.html#eq:Hdis">(8.1)</a>.</p>
<div id="modelo-de-inflación-de-ceros" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Modelo de inflación de ceros<a href="modelo-para-conteos.html#modelo-de-inflación-de-ceros" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo Poisson con ceros inflados (ZIP) se expresa de la siguiente forma:
<span class="math display">\[
y_i \sim \begin{cases} 0 \qquad &amp; \text{con probabilidad } \phi_i, \\ \mbox{Poisson}(\lambda_i) \quad &amp; \text{con probabilidad } 1-\phi_i.
\end{cases}
\]</span></p>
<p>Los parámetros <span class="math inline">\(\phi_i\)</span> y <span class="math inline">\(\lambda_i\)</span> pueden ser modelados a través de covariables:</p>
<p><span class="math display">\[
\mbox{logit } \phi_i=\boldsymbol x&#39;_{1i}\boldsymbol \beta_1 \quad\text{y}\quad \log\lambda_i=\boldsymbol x&#39;_{2i}\boldsymbol \beta_2.
\]</span></p>
<p>En presencia de una sobredispersión mayor, el modelo de ceros inflados puede combinarse con una distribución binomial negativa. Esto es:
<span class="math display">\[
y_i\sim \begin{cases}  0 &amp; \text{con probabilidad } \phi_i, \\  \text{binomial negativa}(\mu_i,\gamma)&amp; \text{con probabilidad } 1-\phi_i. \end{cases}
\]</span>
De igual forma <span class="math inline">\(\mu_i\)</span> y <span class="math inline">\(\phi_i\)</span> se pueden modelar por medio de covariables.</p>
</div>
<div id="modelo-hurdle" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Modelo Hurdle<a href="modelo-para-conteos.html#modelo-hurdle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo Hurdle lo podemos expresar de la forma:
<span class="math display">\[
P(Y_i=j)=\begin{cases} \pi_i &amp;  j=0,\\ (1-\pi_i)\frac{f(j;\theta_i)}{1-f(0;\theta_i)} &amp; j=1,2,\ldots, \end{cases}
\]</span>
donde la función <span class="math inline">\(f(\cdot;\theta_i)\)</span> puede ser una Poisson o binomial negativa. Al igual que el modelo ZI, <span class="math inline">\(\pi_i\)</span> se puede modelar usando un modelo logístico y un modelo log-lineal para <span class="math inline">\(\lambda_i\)</span> (Poisson) o <span class="math inline">\(\mu_i\)</span> (binomial negativo).</p>
</div>
<div id="número-de-cangrejos-satélites-1" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> Número de cangrejos satélites<a href="modelo-para-conteos.html#número-de-cangrejos-satélites-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para los datos de los cangrejos satélites podemos estimar un modelo con inflación de ceros con:
<span class="math display">\[
\mbox{logit } \phi_i=\beta_{10} + \mbox{weight}_i\beta_{11} \quad\text{y}\quad \log\lambda_i=\beta_{20} + \mbox{weight}_i\beta_{21}.
\]</span>
En R, se puede utilizar la funcion <code>zeroinfl</code> de la librería <code>pscl</code></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="modelo-para-conteos.html#cb191-1" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb191-2"><a href="modelo-para-conteos.html#cb191-2" tabindex="-1"></a><span class="co"># modelo ZIP</span></span>
<span id="cb191-3"><a href="modelo-para-conteos.html#cb191-3" tabindex="-1"></a>ZIP.sat <span class="ot">=</span> <span class="fu">zeroinfl</span>(satell<span class="sc">~</span>weight <span class="sc">|</span> weight,<span class="at">data=</span>crabs,<span class="at">dist=</span><span class="st">&#39;poisson&#39;</span>)</span>
<span id="cb191-4"><a href="modelo-para-conteos.html#cb191-4" tabindex="-1"></a><span class="co"># modelo ZINB</span></span>
<span id="cb191-5"><a href="modelo-para-conteos.html#cb191-5" tabindex="-1"></a>ZINB.sat <span class="ot">=</span> <span class="fu">zeroinfl</span>(satell<span class="sc">~</span>weight <span class="sc">|</span> weight,<span class="at">data=</span>crabs,<span class="at">dist=</span><span class="st">&#39;negbin&#39;</span>)</span></code></pre></div>
<p>Mientras que los modelos Hurdle se pueden estimar con la función <code>hurdle</code>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="modelo-para-conteos.html#cb192-1" tabindex="-1"></a><span class="co"># modelo HP</span></span>
<span id="cb192-2"><a href="modelo-para-conteos.html#cb192-2" tabindex="-1"></a>HP.sat <span class="ot">=</span> <span class="fu">hurdle</span>(satell<span class="sc">~</span>weight <span class="sc">|</span> weight,<span class="at">data=</span>crabs,<span class="at">dist=</span><span class="st">&#39;poisson&#39;</span>)</span>
<span id="cb192-3"><a href="modelo-para-conteos.html#cb192-3" tabindex="-1"></a><span class="co"># modelo HNB</span></span>
<span id="cb192-4"><a href="modelo-para-conteos.html#cb192-4" tabindex="-1"></a>HNB.sat <span class="ot">=</span> <span class="fu">hurdle</span>(satell<span class="sc">~</span>weight <span class="sc">|</span> weight,<span class="at">data=</span>crabs,<span class="at">dist=</span><span class="st">&#39;negbin&#39;</span>)</span></code></pre></div>
<p>Los ajustes los podemos comparar con criterios de información:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="modelo-para-conteos.html#cb193-1" tabindex="-1"></a><span class="fu">BIC</span>(ZIP.sat)</span></code></pre></div>
<pre><code>## [1] 747.8175</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="modelo-para-conteos.html#cb195-1" tabindex="-1"></a><span class="fu">BIC</span>(ZINB.sat)</span></code></pre></div>
<pre><code>## [1] 731.2937</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="modelo-para-conteos.html#cb197-1" tabindex="-1"></a><span class="fu">BIC</span>(HP.sat)</span></code></pre></div>
<pre><code>## [1] 747.7903</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="modelo-para-conteos.html#cb199-1" tabindex="-1"></a><span class="fu">BIC</span>(HNB.sat)</span></code></pre></div>
<pre><code>## [1] 731.0369</code></pre>
<p>Aquí vemos que los modelos ZINB y HNB proporcionan mejores ajustes. Las estimaciones del modelo ZINB son:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="modelo-para-conteos.html#cb201-1" tabindex="-1"></a><span class="fu">summary</span>(ZINB.sat)</span></code></pre></div>
<pre><code>## 
## Call:
## zeroinfl(formula = satell ~ weight | weight, data = crabs, dist = &quot;negbin&quot;)
## 
## Pearson residuals:
##     Min      1Q  Median      3Q     Max 
## -1.3647 -0.7899 -0.3112  0.5086  3.8908 
## 
## Count model coefficients (negbin with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.8979     0.3053   2.941  0.00327 ** 
## weight        0.2171     0.1119   1.941  0.05229 .  
## Log(theta)    1.6013     0.3553   4.507 6.57e-06 ***
## 
## Zero-inflation model coefficients (binomial with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   3.7565     0.9841   3.817 0.000135 ***
## weight       -1.9131     0.4322  -4.426 9.59e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Theta = 4.9595 
## Number of iterations in BFGS optimization: 19 
## Log-likelihood: -352.8 on 5 Df</code></pre>
<p>Los resultados muestran que la probabilidad de que no hayan satélites disminuye cuando la hembra tiene mayor peso. De igual forma, la media incrementa con el peso.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-logístico.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo-lineal-mixto.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/AlvaroFlorez/MLG2/edit/master/08-regresionconteos.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/AlvaroFlorez/MLG2/blob/master/08-regresionconteos.Rmd",
    "text": null
  },
  "download": ["MLG2.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
